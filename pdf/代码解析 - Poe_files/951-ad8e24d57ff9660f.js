(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[951],{41677:function(e,n,t){"use strict";var a,o,l=t(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(null,arguments)}n.Z=function(e){return l.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),a||(a=l.createElement("path",{d:"m21.205 7.556-5.291-5.265A.995.995 0 0 0 15.209 2h-6.5a1 1 0 0 0-1 1v2.235h2V4h4.503v4.265a1 1 0 0 0 1 1H19.5v5.5h-1.209v2H20.5a1 1 0 0 0 1-1v-7.5a.998.998 0 0 0-.295-.709Zm-4.993-2.147 1.865 1.856h-1.865V5.409Z"})),o||(o=l.createElement("path",{d:"m15.996 12.791-5.291-5.265a1 1 0 0 0-.705-.29H3.5a1 1 0 0 0-1 1V21a1 1 0 0 0 1 1h11.791a1 1 0 0 0 1-1v-7.5a1 1 0 0 0-.295-.709Zm-4.993-2.147 1.865 1.856h-1.865v-1.856ZM4.5 20V9.235h4.503V13.5a1 1 0 0 0 1 1h4.288V20H4.5Z"})))}},38993:function(e,n,t){"use strict";var a,o=t(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(null,arguments)}n.Z=function(e){return o.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),a||(a=o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 5a1 1 0 1 1 0-2H20a1 1 0 0 1 1 1v5.5a1 1 0 1 1-2 0V6.414l-4.293 4.293a1 1 0 0 1-1.414-1.414L17.586 5H14.5Zm-3.793 8.293a1 1 0 0 1 0 1.414L6.414 19H9.5a1 1 0 1 1 0 2H4a1 1 0 0 1-1-1v-5.5a1 1 0 1 1 2 0v3.086l4.293-4.293a1 1 0 0 1 1.414 0Z"})))}},36789:function(e,n,t){"use strict";var a,o=t(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)({}).hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(null,arguments)}n.Z=function(e){return o.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),a||(a=o.createElement("path",{d:"M19.537 11.156a1 1 0 0 1 0 1.688l-11 7A1 1 0 0 1 7 19V5a1 1 0 0 1 1.537-.844l11 7Z"})))}},66562:function(e,n,t){"use strict";t.r(n);let a={argumentDefinitions:[],kind:"Fragment",name:"BotLink_bot",selections:[{kind:"ScalarField",name:"handle"}],type:"Bot"};a.hash="574ee5a4c6d9ba8ef15b0678164be116",n.default=a},8904:function(e,n,t){"use strict";var a,o,l,i,s,c,d,r;t.r(n);let u=(a=[{defaultValue:null,kind:"LocalArgument",name:"optimisticChatId"}],o=[{kind:"Variable",name:"optimisticChatId",variableName:"optimisticChatId"}],i={kind:"ScalarField",name:"chatId"},s={kind:"ScalarField",name:"handle"},c=[l={kind:"ScalarField",name:"id"}],{fragment:{argumentDefinitions:a,kind:"Fragment",name:"CodeblockOverflowButtonOptimisticChatQuery",selections:[{kind:"ClientExtension",selections:[{args:o,concreteType:"Chat",kind:"LinkedField",name:"optimisticChat",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"sendMessage_chat",selections:[l,i,{concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[l,s]},{kind:"InlineDataFragmentSpread",name:"sendMessage_onSuccessUpdater_chat",selections:c,argumentDefinitions:[]},{kind:"InlineDataFragmentSpread",name:"sendMessage_onMessageSendChatUpdate_chat",selections:[l,{kind:"InlineDataFragmentSpread",name:"getChatContentType_chat",selections:[{concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[d={kind:"ScalarField",name:"hasMarkdownRendering"}]}],argumentDefinitions:[]}],argumentDefinitions:[]},{kind:"ClientExtension",selections:[r={kind:"ScalarField",name:"isOptimistic"}]}],argumentDefinitions:[]},{concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"sendMessage_bot",selections:c,argumentDefinitions:[]}]}]}]}],type:"QueryRoot"},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"CodeblockOverflowButtonOptimisticChatQuery",selections:[{kind:"ClientExtension",selections:[{args:o,concreteType:"Chat",kind:"LinkedField",name:"optimisticChat",plural:!1,selections:[l,i,r,{concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[l,s,d]}]}]}]},params:{cacheID:"6eb7bafe448ea2131adf2e2a0b8b871d",id:null,metadata:{},name:"CodeblockOverflowButtonOptimisticChatQuery",operationKind:"query",text:null}});u.hash="b617c971bd64760cf3b635d867f55668",n.default=u},4173:function(e,n,t){"use strict";var a,o,l,i,s,c,d,r,u,m,g;t.r(n);let h=(a=[{defaultValue:null,kind:"LocalArgument",name:"chatId"},{defaultValue:null,kind:"LocalArgument",name:"isOptimistic"}],o=[{kind:"Variable",name:"chatId",variableName:"chatId"}],i={kind:"ScalarField",name:"chatId"},s={kind:"ScalarField",name:"handle"},c=[l={kind:"ScalarField",name:"id"}],{fragment:{argumentDefinitions:a,kind:"Fragment",name:"CodeblockOverflowButtonQuery",selections:[{condition:"isOptimistic",kind:"Condition",passingValue:!1,selections:[{args:o,concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"sendMessage_chat",selections:[l,i,{concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[l,s]},{kind:"InlineDataFragmentSpread",name:"sendMessage_onSuccessUpdater_chat",selections:c,argumentDefinitions:[]},{kind:"InlineDataFragmentSpread",name:"sendMessage_onMessageSendChatUpdate_chat",selections:[l,{kind:"InlineDataFragmentSpread",name:"getChatContentType_chat",selections:[{concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[d={kind:"ScalarField",name:"hasMarkdownRendering"}]}],argumentDefinitions:[]}],argumentDefinitions:[]},r={kind:"ClientExtension",selections:[{kind:"ScalarField",name:"isOptimistic"}]}],argumentDefinitions:[]},{concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"sendMessage_bot",selections:c,argumentDefinitions:[]}]}]}]},{concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"sendMessage_viewer",selections:[u={alias:"shouldUseFinishUploadEndpoint",args:[{kind:"Literal",name:"gateName",value:"poe_file_upload_use_finish_upload_endpoint"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_file_upload_use_finish_upload_endpoint")'},m={alias:"shouldUsePresignedUrl",args:[{kind:"Literal",name:"gateName",value:"poe_file_upload_use_presigned_url"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_file_upload_use_presigned_url")'},g={alias:"useMessageSendingIcon",args:[{kind:"Literal",name:"gateName",value:"poe_use_message_sending_icon"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_use_message_sending_icon")'}],argumentDefinitions:[]}]}],type:"QueryRoot"},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"CodeblockOverflowButtonQuery",selections:[{condition:"isOptimistic",kind:"Condition",passingValue:!1,selections:[{args:o,concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[l,i,{concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[l,s,d]},r]}]},{concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[u,m,g,l]}]},params:{id:"9255c86ad0529b0d9359b00085f696d168aa4d14f6faa246d65ff6a9e0e2cb81",metadata:{},name:"CodeblockOverflowButtonQuery",operationKind:"query",text:null}});h.hash="f3a5b9e99b103306a65a49851ac2e820",n.default=h},85989:function(e,n,t){"use strict";t.r(n);let a={argumentDefinitions:[],kind:"Fragment",name:"MarkdownCodeBlock_PreBlock_chat",selections:[{kind:"ScalarField",name:"chatId"},{concreteType:"Bot",kind:"LinkedField",name:"chatSettingsFieldBotToEdit",plural:!1,selections:[{kind:"ScalarField",name:"botId"},{concreteType:"PoeUser",kind:"LinkedField",name:"creator",plural:!1,selections:[{kind:"ScalarField",name:"viewerIsUser"}]}]}],type:"Chat"};a.hash="da7f5115815fc85bd5d5438a9508359b",n.default=a},12165:function(e,n,t){"use strict";var a,o,l,i,s;t.r(n);let c={fragment:{argumentDefinitions:a=[{defaultValue:null,kind:"LocalArgument",name:"chatId"},{defaultValue:null,kind:"LocalArgument",name:"scriptContent"}],kind:"Fragment",name:"MarkdownCodeBlock_TestCodeblockMutation",selections:[{args:o=[{kind:"Variable",name:"chatId",variableName:"chatId"},{kind:"Variable",name:"scriptContent",variableName:"scriptContent"}],concreteType:"ContinueChatToTestCodeblock",kind:"LinkedField",name:"continueChatToTestCodeblock",plural:!1,selections:[l={kind:"ScalarField",name:"status"},{concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[i={kind:"ScalarField",name:"chatCode"},s={kind:"ScalarField",name:"chatId"}]}]}],type:"MutationRoot"},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"MarkdownCodeBlock_TestCodeblockMutation",selections:[{args:o,concreteType:"ContinueChatToTestCodeblock",kind:"LinkedField",name:"continueChatToTestCodeblock",plural:!1,selections:[l,{concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[i,s,{kind:"ScalarField",name:"id"}]}]}]},params:{id:"eb8df04bd82e205f5b3123e6a36888c8991c326c9240127c7a27273aa0733a74",metadata:{},name:"MarkdownCodeBlock_TestCodeblockMutation",operationKind:"mutation",text:null}};c.hash="e2e9e070b2ff67c43ad176509706dc4c",n.default=c},88113:function(e,n,t){"use strict";t.r(n);let a={argumentDefinitions:[],kind:"Fragment",name:"MarkdownCodeBlock_chat",selections:[{kind:"FragmentSpread",name:"useShouldShowPublishModal_chat"},{kind:"FragmentSpread",name:"MarkdownCodeBlock_PreBlock_chat"}],type:"Chat"};a.hash="a93c3c3a34b06562d1db9a7f2e48985d",n.default=a},29203:function(e,n,t){"use strict";var a;t.r(n);let o={argumentDefinitions:[],kind:"Fragment",name:"useShouldShowPublishModal_chat",selections:[{kind:"ScalarField",name:"chatId"},{concreteType:"Bot",kind:"LinkedField",name:"chatSettingsFieldBotToEdit",plural:!1,selections:[a={kind:"ScalarField",name:"botId"},{concreteType:"PoeUser",kind:"LinkedField",name:"creator",plural:!1,selections:[{kind:"ScalarField",name:"viewerIsUser"}]}]},{concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[a]}],type:"Chat"};o.hash="aa753a140365efeed64ac4313a2520d4",n.default=o},24752:function(e,n,t){"use strict";var a=t(85893),o=t(22578),l=t(71935),i=t(23595),s=t(38357),c=t(64516);n.Z=e=>{let{bot:n,linkToApiPage:d,onClick:r,children:u,className:m,...g}=e,h=(0,o.useFragment)(t(66562),n),p=(0,c.F)(),k=d?"/".concat(h.handle,"/api"):"/".concat(h.handle);return(0,a.jsx)(l.QQ,{className:m,href:(0,i.au)(p)?(0,s.GH)({path:k,fallbackToBrowser:!0}):k,prefetch:!1,onClick:r,...g,children:u})}},11664:function(e,n,t){"use strict";let a;t.d(n,{Z:function(){return message_MarkdownCodeBlock},t:function(){return getLanguageFromClassName}});var o,l,i=t(85893),s=t(98077),c=t(67172),d=t(5152),r=t.n(d),u=t(11163),m=t(67294),g=t(22120),h=t(22578),p=t(15382),k=t(73624),f=t(58281),_=t(78410),b=t(34478),C=t(8583),v=t(41677),x=t(38993),w=t(36789),B=t(12251);function safeEncodeURIComponent(e){try{return encodeURIComponent(e)}catch(n){return e}}var lib_getPublishAsNewUrlForCodeblock=(e,n)=>"/create_bot?type=script&script_bot_creation_type=manual&script_codeblock_message_id=".concat(safeEncodeURIComponent(e.toString()),"&script_codeblock_idx=").concat(safeEncodeURIComponent(n.toString())),y=t(9729),F=t(23595),j=t(64516),S=t(49231),M=t.n(S),N=t(30038),L=t(96384);(o=l||(l={})).success="success",o.no_access="no_access",o.success_bot_created="success_bot_created",o.success_bot_updated="success_bot_updated";var I=l,T=t(65604),O=t(34389),Z=t(41143),D=t.n(Z);t(44311);var P=t(31657),R=t(30965),E=t(96324),A=t(83169),H=t(85832),z=t(45193),V=t(28871),U=t(5247);let G=t(4173),Q=t(8904);var message_CodeblockOverflowButton=e=>{let{dropdownMenuOpen:n,setDropdownMenuOpen:t,onCopyCode:a,code:o,className:l,iconSize:s="md",actionLogData:c}=e,{t:d}=(0,g.$G)(),r=(0,m.useContext)(P.Z),u=(0,m.useContext)(R.Z),p=(0,m.useContext)(E.n);D()(r,"CodeblockOverflowButton requires chat context"),D()(u,"CodeblockOverflowButton requires message context");let k="string"==typeof r.chatId,{chat:f,viewer:_}=(0,h.useLazyLoadQuery)(G,{chatId:k?0:r.chatId,isOptimistic:k},{fetchPolicy:"store-or-network"}),{optimisticChat:b}=(0,h.useLazyLoadQuery)(Q,{optimisticChatId:k?r.chatId.toString():""},{fetchPolicy:"store-only"}),C=f||b;D()(C,"Requires chat context"),D()(C.defaultBotObject,"Chat must have a default bot");let v=(0,m.useMemo)(()=>({sourceType:U.Z.chat_input}),[]),x=(0,V.$3)({bot:C.defaultBotObject,chat:C,viewer:_,source:v}),w=(0,m.useCallback)(()=>{a(),p()},[a,p]),B=(0,m.useCallback)(()=>{let e="@Code-Editor\n```poepython\n".concat(o.trim(),"\n```");x({prompt:e}),(0,y.Z)("poe/action_log",{action_type:(0,L.E)(N.Z.code_reference_edit_click),...c}),p()},[x,o,p,c]),F=(0,m.useMemo)(()=>(0,i.jsxs)(H.Z,{children:[(0,i.jsx)(A.HN,{children:(0,i.jsx)(A.ZP,{onClick:w,children:d("Copy code")})}),(0,i.jsx)(A.HN,{children:(0,i.jsx)(A.ZP,{onClick:B,children:d("Edit code")})})]}),[w,B,d]);return(0,i.jsx)(z.Z,{menuBody:F,alignment:"right",menuOpen:n,setMenuOpen:t,className:l,size:s,theme:"ghost"})},$=t(22641);let PublishScriptBotModal=()=>t.e(2367).then(t.bind(t,72367));var message_usePublishScriptBotModal=()=>{let[e,n]=(0,m.useState)(!1),[t,a]=(0,m.useState)(null),o=(0,m.useCallback)(e=>{a(e),n(!0)},[]),l=(0,m.useCallback)(()=>{n(!1),a(null)},[]),s=(0,m.useMemo)(()=>t?{...t,close:l}:null,[t,l]),c=t&&s?(0,i.jsx)($.Z,{isOpen:e,onRequestClose:l,body:PublishScriptBotModal,bodyProps:s,useMinHeight:!0}):null;return{modal:c,openModal:o,isOpen:e}},q=t(1528);let collapsedRenderer=e=>{let{rows:n,...t}=e,a=n.slice(-25);return(0,i.jsx)(i.Fragment,{children:a.map((e,n)=>(0,p.ZP)({key:"collapsed-".concat(n),node:e,...t}))})},RunButtonPlaceholder=()=>(0,i.jsx)(_.Z,{className:M().codeActionButton,as:"button",theme:"ghost",size:"sm",iconLeft:(0,i.jsx)(w.Z,{}),isDisabled:!0,showIconOnly:"always"}),K=r()(()=>t.e(7090).then(t.bind(t,47090)),{loadableGenerated:{webpack:()=>[47090]},ssr:!1,loading:()=>(0,i.jsx)(RunButtonPlaceholder,{})}),W=/language-(\w+(?:-\w+)*)/;function getLanguageFromClassName(e){let n="";if(!(n=Array.isArray(e)?e.join(" "):e||"")||"string"!=typeof n)return null;let t=n.match(W);if(!t)return null;let a=t[1];return a?a.toLocaleLowerCase():null}let useLowlight=()=>{let[e,n]=(0,m.useState)(a),o=(0,m.useMemo)(()=>Promise.all([t.e(5957),t.e(125),t.e(7764),t.e(6965),t.e(1708),t.e(6563),t.e(295),t.e(4360),t.e(8967),t.e(3180),t.e(9651)]).then(t.t.bind(t,26912,23)),[]);return(0,m.useEffect)(()=>{e||o.then(e=>{n(a=e)})},[o,e]),e},useDetectLanguage=(e,n)=>{let t=useLowlight(),a=e.substring(0,1e3),o=(0,m.useMemo)(()=>{if(n)return{language:n,showLanguageName:!0};if((0,b.X_)(a))return{language:"svg",showLanguageName:!0};if((0,b.vB)(a))return{language:"html",showLanguageName:!0};if(!t)return;let e=t.highlightAuto(a);return{language:e.language,showLanguageName:e.relevance>=10}},[t,a,n]);return o&&"js"===o.language?{...o,language:"javascript"}:o},useCodeblockCollapse=(e,n)=>{let[t,a]=(0,m.useState)(null),o=(0,m.useCallback)(()=>a(!1),[]),l=(0,m.useRef)(null),i=(0,m.useRef)(null);return(0,m.useEffect)(()=>{if(n&&e&&null===t&&l.current&&i.current){let e=l.current,n=i.current;if(e.scrollHeight>n.clientHeight)a(!0);else{let o=new ResizeObserver(()=>{null===t&&e.scrollHeight>n.clientHeight&&(a(e=>null===e||e),o.unobserve(e),o.disconnect())});return o.observe(e),()=>{o.unobserve(e),o.disconnect()}}}},[e,t,n]),{collapsed:t,expand:o,preElementRef:l,codeSectionRef:i}},PreBlock=e=>{let{languageMatch:n,getCode:a,code:o,actionLogData:l,collapsible:d=!1,collapsed:r,expand:p,preElementRef:k,codeSectionRef:f,executable:b,isPartial:w,codeblockIdx:S,isHorizontalScrollable:T,enableScriptingCodeReference:Z,enableScriptBotCreation:D,supportedExecutableLanguages:P,enableExecutableCodeblock:R,messageId:E,shouldShowPublishModal:A,openPublishModal:H,chat:z,...V}=e,{t:U}=(0,g.$G)(),G=(0,C.ZP)(),Q=(0,j.F)(),$=(0,u.useRouter)(),q=(0,h.useFragment)(t(85989),z),W=(0,m.useCallback)(()=>{navigator.clipboard.writeText(a().trim()),G({content:U("Copied to clipboard"),type:C.pC.success}),(0,y.Z)("poe/action_log",{action_type:(0,L.E)(N.Z.copy_code),...l})},[a,l,G,U]),J=(0,O.C)(),[Y,X]=(0,m.useState)(!1),ee=(0,m.useCallback)(()=>{if((0,y.Z)("poe/action_log",{action_type:(0,L.E)(N.Z.code_reference_publish_click),...l}),E){if(A){var e;H({scriptContent:a(),botId:(null==q?void 0:null===(e=q.chatSettingsFieldBotToEdit)||void 0===e?void 0:e.botId)||0,chatId:(null==q?void 0:q.chatId)||0,onPublishAsNew:()=>{window.location.href=lib_getPublishAsNewUrlForCodeblock(E,S)}})}else window.location.href=lib_getPublishAsNewUrlForCodeblock(E,S)}},[E,S,l,A,H,a,q]),[en,et]=(0,h.useMutation)(t(12165)),ea=(0,m.useCallback)(()=>{en({variables:{chatId:null==q?void 0:q.chatId,scriptContent:o},onCompleted:e=>{if(e.continueChatToTestCodeblock.chat){let n="/chat/".concat(encodeURIComponent(e.continueChatToTestCodeblock.chat.chatCode)),t=e.continueChatToTestCodeblock.status===I.success_bot_created?U("Private bot created. Send a message to test it."):U("Private bot updated. Send a message to test it."),a=(0,C.M5)(new URL(n,window.location.origin),C.BG.testCodeblockSuccess,{[C.J7]:t});(0,F.G6)(Q)?$.push(a):window.open(a,"_blank")}else G({type:C.pC.error,content:U("Something went wrong.")})}})},[Q,o,en,G,U,q,$]),eo=(0,m.useMemo)(()=>{if((null==n?void 0:n.language)!=="poepython")return!1;let e=function(e){let n=e.split("\n").slice(0,10);for(let e of n){let n=e.match(/^\s*#\s*poe\s*:\s*name\s*=\s*(.+)\s*$/);if(n)return"@chat/".concat(n[1].trim()," ")}return""}(o);return""!==e},[null==n?void 0:n.language,o]),[el,ei]=(0,m.useState)(null),es=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(_.Z,{className:M().codeActionButton,as:"button",ref:ei,theme:"ghost",size:"sm",onClick:W,iconLeft:(0,i.jsx)(v.Z,{}),showIconOnly:"always"}),(0,i.jsx)(c.u,{anchorRef:el,label:U("Copy code"),placement:"top"})]});if(!Z||!D)return(0,i.jsxs)("div",{className:M().codeBlock,children:[(0,i.jsxs)("div",{className:M().codeHeader,children:[(0,i.jsx)("div",{className:M().languageName,children:(null==n?void 0:n.showLanguageName)&&n.language}),(0,i.jsxs)("div",{className:(0,B.$)(M().codeActions,J&&M().codeActionsRightMargin),children:[b&&n&&(0,i.jsx)(m.Suspense,{fallback:(0,i.jsx)(RunButtonPlaceholder,{}),children:(0,i.jsx)(K,{className:M().codeActionButton,language:n.language,code:a(),disabled:w,codeblockIdx:S})}),es]})]}),(0,i.jsxs)("div",{ref:f,className:(0,B.$)(M().codeSection,d&&M().collapsible),"data-collapsed":null===r?"unknown":r,onClick:r?p:void 0,children:[r&&(0,i.jsx)("div",{className:M().expandButtonContainer,children:(0,i.jsx)(_.Z,{as:"button",theme:"secondary",size:"sm",onClick:p,iconLeft:(0,i.jsx)(x.Z,{}),className:M().expandButton,children:U("View all")})}),(0,i.jsx)("pre",{...V,ref:k,className:(0,B.$)(M().preTag,T?M().horizontalScrollable:M().horizontalOverflowHidden)})]})]});let ec=checkCanExecute({supportedExecutableLanguages:P,language:"python",enableExecutableCodeblock:R});return(null==n?void 0:n.language)==="poepython"&&ec?(0,i.jsxs)("div",{className:M().codeBlock,children:[(0,i.jsx)("div",{className:M().codeHeaderCodeReferencing,children:(0,i.jsx)("div",{className:M().languageName,children:(null==n?void 0:n.showLanguageName)&&n.language})}),(0,i.jsxs)("div",{ref:f,className:(0,B.$)(M().codeSection,d&&M().collapsible),"data-collapsed":null===r?"unknown":r,onClick:r?p:void 0,children:[r&&(0,i.jsx)("div",{className:M().expandButtonContainer,children:(0,i.jsx)(_.Z,{as:"button",theme:"secondary",size:"sm",onClick:p,iconLeft:(0,i.jsx)(x.Z,{}),className:M().expandButton,children:U("View all")})}),(0,i.jsx)("pre",{...V,ref:k,className:(0,B.$)(M().preTag,T?M().horizontalScrollable:M().horizontalOverflowHidden)})]}),(0,i.jsxs)("div",{className:M().codeFooterPoePython,children:[(0,i.jsx)("div",{className:M().codeFooterLeftSection,children:D&&(0,i.jsxs)(i.Fragment,{children:[eo&&(0,i.jsx)(_.Z,{className:M().codeActionButton,as:"button",theme:"ghost",size:"sm",iconLeft:(0,i.jsx)(s.$M,{}),onClick:ea,isLoading:et,isDisabled:w,children:U("Test bot")}),!eo&&(0,i.jsx)(m.Suspense,{fallback:(0,i.jsx)(RunButtonPlaceholder,{}),children:(0,i.jsx)(K,{className:M().codeActionButton,language:n.language,code:a(),disabled:w,codeblockIdx:S})}),(0,i.jsx)(_.Z,{className:M().codeActionButton,as:"button",theme:"ghost",size:"sm",iconLeft:(0,i.jsx)(s.zc,{}),onClick:ee,isDisabled:w,children:U("Publish")})]})}),(0,i.jsx)("div",{className:M().codeFooterRightSection,children:(0,i.jsx)(message_CodeblockOverflowButton,{actionLogData:l,dropdownMenuOpen:Y,setDropdownMenuOpen:X,onCopyCode:W,code:a(),className:M().codeActionButton,iconSize:"sm"})})]})]}):(0,i.jsxs)("div",{className:M().codeBlock,children:[(0,i.jsx)("div",{className:M().codeHeaderCodeReferencing,children:(0,i.jsx)("div",{className:M().languageName,children:(null==n?void 0:n.showLanguageName)&&n.language})}),(0,i.jsxs)("div",{ref:f,className:(0,B.$)(M().codeSection,d&&M().collapsible),"data-collapsed":null===r?"unknown":r,onClick:r?p:void 0,children:[r&&(0,i.jsx)("div",{className:M().expandButtonContainer,children:(0,i.jsx)(_.Z,{as:"button",theme:"secondary",size:"sm",onClick:p,iconLeft:(0,i.jsx)(x.Z,{}),className:M().expandButton,children:U("View all")})}),(0,i.jsx)("pre",{...V,ref:k,className:(0,B.$)(M().preTag,T?M().horizontalScrollable:M().horizontalOverflowHidden)})]}),(0,i.jsxs)("div",{className:M().codeFooterPoePython,children:[(0,i.jsx)("div",{className:M().codeFooterLeftSection,children:b&&n&&(0,i.jsx)(m.Suspense,{fallback:(0,i.jsx)(RunButtonPlaceholder,{}),children:(0,i.jsx)(K,{className:M().codeActionButton,language:n.language,code:a(),disabled:w,codeblockIdx:S})})}),(0,i.jsx)("div",{className:M().codeFooterRightSection,children:es})]})]})},CodeBlock=e=>(0,i.jsx)("code",{...e,className:M().codeTag}),getSyntaxHighlighterLanguage=e=>"code_edit_tool"===e.language?"json":"html"===e.language?"xml":"svg"===e.language?"xml":"poepython"===e.language?"python":e.language,checkCanExecute=e=>{let{supportedExecutableLanguages:n,language:t,enableExecutableCodeblock:a}=e;return a&&!!t&&!!n&&n.map(e=>e.language).includes(t)};var message_MarkdownCodeBlock=e=>{var n;let{className:a,codeblockHeaderLanguage:o,codeblockHeaderMetadata:l,code:s,enableExecutableCodeblock:c,actionLogData:d,codeblockIsComplete:r,codeblockIdx:u,supportedExecutableLanguages:g,messageIsComplete:p,renderIframe:_,supportedIframeContentTypes:C,codeblockPreviewIsEnabled:v,markdownWasStreaming:x,enableScriptingCodeReference:w,enableScriptBotCreation:B,messageId:y,chat:F}=e,j=(0,m.useRef)(s);j.current=s;let S=(0,m.useCallback)(()=>j.current,[]),N=useDetectLanguage(s,o),L=(0,h.useFragment)(t(88113),F),I=(0,q.ZP)({chat:L}),{modal:O,openModal:Z}=message_usePublishScriptBotModal(),D=(0,m.useRef)(N);D.current=N;let P=(0,b.lX)({codeblockHeaderLanguage:o,metadata:l,code:s,supportedPreviewsContentTypes:C||[]})||null,R=(n=null!=o?o:null,"html"===P?T.Z.html:n||("react"===P?T.Z.tsx:null)),E=v&&!!R&&!!P&&!!_,A=E||"code_edit_tool"===o||"diff"===o||"console"===o||(null==l?void 0:l.includes("type=code_edit_tool"))||(null==l?void 0:l.includes("type=poeToolResult"))||(null==l?void 0:l.includes("tool_use_id="))||(null==N?void 0:N.language)==="poepython"||(null==N?void 0:N.language)==="python",H="code_edit_tool"!==o,{collapsed:z,expand:V,preElementRef:U,codeSectionRef:G}=useCodeblockCollapse(null!=A&&A,r),Q=checkCanExecute({supportedExecutableLanguages:g,language:null==N?void 0:N.language,enableExecutableCodeblock:c}),$=(0,m.useMemo)(()=>({...d,codeblock_index:u}),[d,u]),K=(0,m.useCallback)(e=>(0,i.jsx)(PreBlock,{...e,actionLogData:$,languageMatch:D.current,getCode:S,code:s,collapsible:A,collapsed:z,expand:V,preElementRef:U,codeSectionRef:G,executable:Q,isPartial:!p,codeblockIdx:u,isHorizontalScrollable:!!H,enableScriptingCodeReference:w,supportedExecutableLanguages:g,enableExecutableCodeblock:c,enableScriptBotCreation:B,messageId:y,shouldShowPublishModal:I,openPublishModal:Z,chat:L||null}),[S,s,A,Q,p,u,$,z,V,U,G,H,w,g,c,B,y,I,Z,L]),W=(0,m.useMemo)(()=>{if(N)return getSyntaxHighlighterLanguage(N)},[N]),J=p&&z?collapsedRenderer:void 0;return(0,i.jsxs)("div",{className:M().container,children:[(0,i.jsx)(k.Z,{language:W,style:f.Z,className:a,PreTag:K,CodeTag:H?void 0:CodeBlock,renderer:J,children:s}),r&&E&&_({language:"html"===P?T.Z.html:R,contentType:P,content:s,blockIndex:u,blockType:"codeblock",markdownWasStreaming:x}),O]})}},1528:function(e,n,t){"use strict";t.d(n,{Nm:function(){return i},sg:function(){return l}});var a=t(67294),o=t(22578);let l=6477437,i="Script-Creator";n.ZP=e=>{var n,i;let{chat:s}=e,c=(0,o.useFragment)(t(29203),s),d=!!(null==c?void 0:null===(n=c.chatSettingsFieldBotToEdit)||void 0===n?void 0:n.botId)&&(null==c?void 0:null===(i=c.defaultBotObject)||void 0===i?void 0:i.botId)===l;return(0,a.useMemo)(()=>{var e,n;return!!s&&!!((d||(null==c?void 0:c.chatSettingsFieldBotToEdit))&&(null==c?void 0:null===(n=c.chatSettingsFieldBotToEdit)||void 0===n?void 0:null===(e=n.creator)||void 0===e?void 0:e.viewerIsUser))},[s,d,c])}},35542:function(e,n,t){"use strict";t.d(n,{j:function(){return NuxBlockedAnchor}});var a=t(85893),o=t(67294),l=t(78410),i=t(50241),s=t(11431);let useWrappedOnClick=e=>{let{onClick:n,onClickSideEffect:t}=e,{shouldShowNux:a,openInitialNuxModal:l}=(0,s.Bi)(),{shouldShowSignupWall:c,openSignupWall:d}=(0,i.zl)(),r=(0,o.useCallback)(e=>(t&&t(),c)?d():a?l(t=>t&&(null==n?void 0:n(e))):null==n?void 0:n(e),[n,c,d,a,l,t]);return r},NuxBlockedAnchor=e=>{let{onClick:n,onClickSideEffect:t,...o}=e,l=useWrappedOnClick({onClick:n,onClickSideEffect:t});return(0,a.jsx)("a",{onClick:l,...o})};n.Z=e=>{let{onClick:n,onClickSideEffect:t,...o}=e,i=useWrappedOnClick({onClick:n,onClickSideEffect:t});return(0,a.jsx)(l.Z,{onClick:i,...o})}},34389:function(e,n,t){"use strict";t.d(n,{C:function(){return useIsForcedCompact},_:function(){return o}});var a=t(67294);let o=(0,a.createContext)(!1),useIsForcedCompact=()=>(0,a.useContext)(o)},96324:function(e,n,t){"use strict";t.d(n,{n:function(){return o}});var a=t(67294);let o=(0,a.createContext)(()=>{})},83169:function(e,n,t){"use strict";t.d(n,{HN:function(){return DropdownMenuItemGroup},lY:function(){return o}});var a,o,l=t(85893),i=t(67294),s=t(12251),c=t(59505),d=t.n(c);(a=o||(o={}))[a.default=0]="default",a[a.destructive=1]="destructive",a[a.separator=2]="separator";let DropdownMenuItemGroup=e=>{let{children:n}=e;return i.Children.toArray(n).some(e=>e)?(0,l.jsx)("div",{className:d().group,children:n}):null};n.ZP=e=>{let{children:n,onClick:t,href:a,target:o,className:i,type:c=0,shrink:r=!1,isDisabled:u=!1}=e,m=(0,s.$)(i,d().item,1===c&&d().destructive,2===c&&d().separator,!r&&d().notShrink,u&&d().isDisabled);return a&&!u?(0,l.jsx)("a",{className:m,href:a,target:o,children:n}):(0,l.jsx)("button",{className:m,disabled:u,onClick:t,children:n})}},85832:function(e,n,t){"use strict";var a=t(85893),o=t(22049),l=t.n(o);n.Z=e=>{let{children:n}=e;return(0,a.jsx)("div",{className:l().itemList,children:n})}},77581:function(e,n,t){"use strict";t.d(n,{$:function(){return Tags},V:function(){return Tag}});var a=t(85893),o=t(67294),l=t(12251),i=t(7687),s=t.n(i);let Tag=e=>{let{label:n,className:t,...o}=e,i=(0,l.$)(s().tag,t);return(0,a.jsx)("div",{className:i,...o,children:n})},Tags=e=>{let{className:n,children:t,...i}=e,c=(0,l.$)(s().tags,n);return(0,a.jsx)("ol",{className:c,...i,children:o.Children.map(t,e=>(0,a.jsx)("li",{children:e}))})}},65604:function(e,n){"use strict";var t,a;(a=t||(t={})).html="html",a.javascript="javascript",a.typescript="typescript",a.jsx="jsx",a.tsx="tsx",a.svg="svg",n.Z=t},7687:function(e){e.exports={tag:"tag_tag__SaZZp",tags:"tag_tags__Zn5SU"}},49231:function(e){e.exports={"compact-below":"only screen and (max-width : 683px)",container:"MarkdownCodeBlock_container__nRn2j",codeBlock:"MarkdownCodeBlock_codeBlock__rvLec force-dark",codeHeader:"MarkdownCodeBlock_codeHeader__zWt_V",codeHeaderCodeReferencing:"MarkdownCodeBlock_codeHeaderCodeReferencing__4xrRh",codeFooter:"MarkdownCodeBlock_codeFooter__NMojB",codeFooterCodeReferencing:"MarkdownCodeBlock_codeFooterCodeReferencing__63NjE",codeFooterPoePython:"MarkdownCodeBlock_codeFooterPoePython__8QxYT",codeFooterLeftSection:"MarkdownCodeBlock_codeFooterLeftSection__6yrgP",codeFooterRightSection:"MarkdownCodeBlock_codeFooterRightSection__9Hz_z",preTag:"MarkdownCodeBlock_preTag__QMZEO",horizontalOverflowHidden:"MarkdownCodeBlock_horizontalOverflowHidden__YPHxg",horizontalScrollable:"MarkdownCodeBlock_horizontalScrollable__aGZiW",codeTag:"MarkdownCodeBlock_codeTag__5BV0Z",languageName:"MarkdownCodeBlock_languageName__4_BF8",collapsible:"MarkdownCodeBlock_collapsible__n09uc",expandButtonContainer:"MarkdownCodeBlock_expandButtonContainer__kdI0J",expandButton:"MarkdownCodeBlock_expandButton__dE4iV",codeActions:"MarkdownCodeBlock_codeActions__wvgwQ",codeActionsRightMargin:"MarkdownCodeBlock_codeActionsRightMargin__Ilyv4",codeActionButton:"MarkdownCodeBlock_codeActionButton__xJBAg"}},59505:function(e){e.exports={item:"DropdownMenuItem_item__EIRcp",isDisabled:"DropdownMenuItem_isDisabled__VdNad",group:"DropdownMenuItem_group__UQGhK",destructive:"DropdownMenuItem_destructive__Bi9MD",notShrink:"DropdownMenuItem_notShrink__AFip8",separator:"DropdownMenuItem_separator__Dzdm2"}},22049:function(e){e.exports={itemList:"DropdownMenuItemList_itemList__JiLsy"}}}]);