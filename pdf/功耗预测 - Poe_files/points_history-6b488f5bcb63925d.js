(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7884],{11726:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/points_history",function(){return i(73155)}])},92621:function(e,n,i){"use strict";var o,a,t,s,r;i.r(n);let l=(o=[{defaultValue:null,kind:"LocalArgument",name:"cursor"},{defaultValue:15,kind:"LocalArgument",name:"limit"}],a=[{kind:"Variable",name:"after",variableName:"cursor"},{kind:"Variable",name:"first",variableName:"limit"}],r={kind:"LinkedField",name:"trigger",plural:!1,selections:[s={kind:"ScalarField",name:"__typename"},{kind:"InlineFragment",selections:[{concreteType:"Message",kind:"LinkedField",name:"message",plural:!1,selections:[{kind:"ScalarField",name:"messageCode"},t={kind:"ScalarField",name:"id"}]}],type:"MessageSendJobTrigger"}]},{fragment:{argumentDefinitions:o,kind:"Fragment",name:"PointsHistoryPageColumnViewerPaginationQuery",selections:[{concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:[{kind:"Variable",name:"cursor",variableName:"cursor"},{kind:"Variable",name:"limit",variableName:"limit"}],kind:"FragmentSpread",name:"PointsHistoryPageColumn_viewer"}]}],type:"QueryRoot"},kind:"Request",operation:{argumentDefinitions:o,kind:"Operation",name:"PointsHistoryPageColumnViewerPaginationQuery",selections:[{concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:"poeShowConversions",args:[{kind:"Literal",name:"gateName",value:"poe_show_conversions"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_show_conversions")'},{args:a,concreteType:"PointsHistoryConnection",kind:"LinkedField",name:"pointsHistoryConnection",plural:!1,selections:[{concreteType:"PointsHistoryEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{kind:"LinkedField",name:"node",plural:!1,selections:[t,s,{kind:"ScalarField",name:"pointCost"},{kind:"ScalarField",name:"creationTime"},{concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[{kind:"ScalarField",name:"displayName"},t]},{kind:"InlineFragment",selections:[{concreteType:"PoeJob",kind:"LinkedField",name:"job",plural:!1,selections:[r,{concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[{kind:"ScalarField",name:"title"},{kind:"ScalarField",name:"isDeleted"},t]},t]}],type:"JobPointsHistoryNode"},{kind:"InlineFragment",selections:[{kind:"ScalarField",name:"canvasTitle"},{alias:"canvasJob",concreteType:"PoeJob",kind:"LinkedField",name:"job",plural:!1,selections:[r,t]}],type:"CanvasPointsHistoryNode"}]},{kind:"ScalarField",name:"cursor"},t]},{concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{kind:"ScalarField",name:"endCursor"},{kind:"ScalarField",name:"hasNextPage"}]},t]},{args:a,handle:"connection",key:"PointsHistoryPageColumn_viewer_pointsHistoryConnection",kind:"LinkedHandle",name:"pointsHistoryConnection"},t]}]},params:{id:"cd414ed27f3ca89af65619dd46c85aa837aba6485012fa144c7bde13ca5c5214",metadata:{},name:"PointsHistoryPageColumnViewerPaginationQuery",operationKind:"query",text:null}});l.hash="cb88bb1f7905e6eb3fad3e7bd1c42900",n.default=l},91693:function(e,n,i){"use strict";var o,a;i.r(n);let t=(a={kind:"LinkedField",name:"trigger",plural:!1,selections:[{kind:"InlineFragment",selections:[{concreteType:"Message",kind:"LinkedField",name:"message",plural:!1,selections:[{kind:"ScalarField",name:"messageCode"}]}],type:"MessageSendJobTrigger"}]},{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"cursor"},{defaultValue:15,kind:"LocalArgument",name:"limit"}],kind:"Fragment",metadata:{connection:[{count:"limit",cursor:"cursor",direction:"forward",path:o=["pointsHistoryConnection"]}],refetch:{connection:{forward:{count:"limit",cursor:"cursor"},backward:null,path:o},fragmentPathInResult:["viewer"],operation:i(92621)}},name:"PointsHistoryPageColumn_viewer",selections:[{alias:"poeShowConversions",args:[{kind:"Literal",name:"gateName",value:"poe_show_conversions"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_show_conversions")'},{alias:"pointsHistoryConnection",concreteType:"PointsHistoryConnection",kind:"LinkedField",name:"__PointsHistoryPageColumn_viewer_pointsHistoryConnection_connection",plural:!1,selections:[{concreteType:"PointsHistoryEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"ScalarField",name:"id"},{kind:"ScalarField",name:"__typename"},{kind:"ScalarField",name:"pointCost"},{kind:"ScalarField",name:"creationTime"},{concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[{kind:"ScalarField",name:"displayName"}]},{kind:"InlineFragment",selections:[{concreteType:"PoeJob",kind:"LinkedField",name:"job",plural:!1,selections:[a,{concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[{kind:"ScalarField",name:"title"},{kind:"ScalarField",name:"isDeleted"}]}]}],type:"JobPointsHistoryNode"},{kind:"InlineFragment",selections:[{kind:"ScalarField",name:"canvasTitle"},{alias:"canvasJob",concreteType:"PoeJob",kind:"LinkedField",name:"job",plural:!1,selections:[a]}],type:"CanvasPointsHistoryNode"}]},{kind:"ScalarField",name:"cursor"}]},{concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{kind:"ScalarField",name:"endCursor"},{kind:"ScalarField",name:"hasNextPage"}]}]}],type:"Viewer"});t.hash="cb88bb1f7905e6eb3fad3e7bd1c42900",n.default=t},30224:function(e,n,i){"use strict";var o,a,t,s;i.r(n);let r=(o=[{kind:"Literal",name:"first",value:15}],s={kind:"LinkedField",name:"trigger",plural:!1,selections:[t={kind:"ScalarField",name:"__typename"},{kind:"InlineFragment",selections:[{concreteType:"Message",kind:"LinkedField",name:"message",plural:!1,selections:[{kind:"ScalarField",name:"messageCode"},a={kind:"ScalarField",name:"id"}]}],type:"MessageSendJobTrigger"}]},{fragment:{argumentDefinitions:[],kind:"Fragment",name:"pointsHistoryPageQuery",selections:[{concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{kind:"FragmentSpread",name:"PointsHistoryPageColumn_viewer"},{kind:"FragmentSpread",name:"MainNavbarLeftItem_viewer"}]}],type:"QueryRoot"},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"pointsHistoryPageQuery",selections:[{concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:"poeShowConversions",args:[{kind:"Literal",name:"gateName",value:"poe_show_conversions"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_show_conversions")'},{args:o,concreteType:"PointsHistoryConnection",kind:"LinkedField",name:"pointsHistoryConnection",plural:!1,selections:[{concreteType:"PointsHistoryEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{kind:"LinkedField",name:"node",plural:!1,selections:[a,t,{kind:"ScalarField",name:"pointCost"},{kind:"ScalarField",name:"creationTime"},{concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[{kind:"ScalarField",name:"displayName"},a]},{kind:"InlineFragment",selections:[{concreteType:"PoeJob",kind:"LinkedField",name:"job",plural:!1,selections:[s,{concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[{kind:"ScalarField",name:"title"},{kind:"ScalarField",name:"isDeleted"},a]},a]}],type:"JobPointsHistoryNode"},{kind:"InlineFragment",selections:[{kind:"ScalarField",name:"canvasTitle"},{alias:"canvasJob",concreteType:"PoeJob",kind:"LinkedField",name:"job",plural:!1,selections:[s,a]}],type:"CanvasPointsHistoryNode"}]},{kind:"ScalarField",name:"cursor"},a]},{concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{kind:"ScalarField",name:"endCursor"},{kind:"ScalarField",name:"hasNextPage"}]},a],storageKey:"pointsHistoryConnection(first:15)"},{args:o,handle:"connection",key:"PointsHistoryPageColumn_viewer_pointsHistoryConnection",kind:"LinkedHandle",name:"pointsHistoryConnection"},{concreteType:"BadgeInfo",kind:"LinkedField",name:"badgeInfo",plural:!1,selections:[{concreteType:"UnseenChatInfo",kind:"LinkedField",name:"unseenChatInfos",plural:!0,selections:[{kind:"ScalarField",name:"unseenMessageIds"}]}]},a]}]},params:{id:"65d590da22baee65849f6550c0cb9904d00870c8efa9e6166e8bc28a3a668f86",metadata:{},name:"pointsHistoryPageQuery",operationKind:"query",text:null}});r.hash="fa6db23b630cf3fcbdd9bd7320534338",n.default=r},91469:function(e,n,i){"use strict";var o=i(85893),a=i(13525),t=i(12251),s=i(23595),r=i(64516),l=i(11300),d=i.n(l);n.Z=e=>{let{header:n,startAtBottom:i,children:l,disallowScroll:c,noMaxWidth:m=!1,deviceType:u}=e,{elementProps:g,providerProps:p}=(0,a.GO)(),k=(0,r.F)(),y=!(0,s.k6)(k,u)&&d().scrollSectionOverflow;return(0,o.jsxs)(o.Fragment,{children:[n,(0,o.jsx)(a.yp,{...p,children:(0,o.jsx)("div",{className:(0,t.$)(d().scrollSection,i&&d().startAtBottom,y,c&&d().disallowScroll),...g,children:(0,o.jsx)("div",{className:(0,t.$)(d().column,m&&d().noMaxWidth),children:l})})})]})}},24581:function(e,n,i){"use strict";var o=i(85893),a=i(1250),t=i(36803);n.Z=e=>(0,o.jsx)(t.Z,{leftNavItem:(0,o.jsx)(a.Z,{viewer:e.viewer}),...e})},84080:function(e,n,i){"use strict";i.d(n,{C:function(){return usePagingTriggerRef}});var o=i(85893),a=i(67294),t=i(12251),s=i(56782),r=i.n(s),l=i(13525);let usePagingTriggerRef=e=>{let{loadMore:n,canLoadMore:i,rootMargin:o,scrollRootRef:t}=e,s=a.useRef(null),r=(0,l.Oi)(),d=void 0!==t?t:r;return(0,a.useEffect)(()=>{var e;if(!s.current||!i)return;let a=new IntersectionObserver(e=>{e[0].isIntersecting&&n()},{root:null!==(e=null==d?void 0:d.current)&&void 0!==e?e:null,threshold:0,rootMargin:o});return a.observe(s.current),()=>{a.disconnect()}},[n,i,o,d]),s},calcRootMargin=(e,n,i)=>"".concat(!n&&i?e:0,"px ").concat(n&&!i?e:0,"px ")+"".concat(n||i?0:e,"px ").concat(n&&i?e:0,"px"),d=a.forwardRef(function(e,n){let{children:i,className:a,loadMore:s,hasMore:l,isLoading:d,loadingState:c=null,error:m,errorState:u=null,threshold:g,horizontal:p=!1,reverse:k=!1,scrollRootRef:y,as:_="div"}=e,v=usePagingTriggerRef({loadMore:s,canLoadMore:l&&!d&&!m,rootMargin:calcRootMargin(g,p,k),scrollRootRef:y}),P=m?u:(0,o.jsx)("div",{ref:v,className:r().pagingTrigger,children:d&&c});return(0,o.jsxs)(_,{ref:n,className:(0,t.$)(r().container,p&&r().horizontal,a),children:[k&&P,i,!k&&P]})});n.Z=d},56206:function(e,n,i){"use strict";i.d(n,{X:function(){return convertPointsToUsd},z:function(){return formatUsdString}});var o=i(13012);function convertPointsToUsd(e){let n=new o.Z(e).div(1e6).mul(30);return formatBigJsToUsd(n)}function formatUsdString(e){try{let n=new o.Z(e);return formatBigJsToUsd(n)}catch(e){return""}}function formatBigJsToUsd(e){let n;if(e.eq(0)||e.gte(1))n=2;else{let i=e.toPrecision(2);n=i.includes(".")?i.split(".")[1].length:0}let i=navigator.language||"en-US";return new Intl.NumberFormat(i,{style:"currency",currency:"USD",currencyDisplay:"symbol",minimumFractionDigits:n,maximumFractionDigits:n}).format(e.toNumber())}},73155:function(e,n,i){"use strict";i.r(n),i.d(n,{default:function(){return b}});var o=i(85893),a=i(22120);i(44311);var t=i(91469),s=i(41664),r=i.n(s),l=i(67294),d=i(22578),c=i(84080),m=i(446),u=i(18453),g=i(56206),p=i(12251),k=i(39984),y=i(67512),_=i.n(y);let PointsHistoryRow=e=>{var n,i,t,s;let{node:r,showConversions:l}=e,{t:d}=(0,a.$G)(),c=new Date(r.creationTime/1e3);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:_().botInfo,children:[(0,o.jsx)("span",{className:_().botName,children:r.bot.displayName}),"CanvasPointsHistoryNode"===r.__typename&&r.canvasTitle&&(0,o.jsx)("span",{className:_().contextInfo,children:d("Canvas tab: {{title}}",{title:r.canvasTitle})}),"ApiPointsHistoryNode"===r.__typename&&(0,o.jsx)("span",{className:_().contextInfo,children:d("API usage")}),"JobPointsHistoryNode"===r.__typename&&(0,o.jsx)("span",{className:_().contextInfo,children:(null===(i=r.job)||void 0===i?void 0:null===(n=i.chat)||void 0===n?void 0:n.isDeleted)?d("Deleted chat"):d("Chat: {{title}}",{title:(null===(s=r.job)||void 0===s?void 0:null===(t=s.chat)||void 0===t?void 0:t.title)||d("New chat")})}),l&&(0,o.jsx)("span",{className:_().timestampText,children:d("{{val, datetime}}",{val:c,formatParams:{val:{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}}})})]}),(0,o.jsx)("div",{className:_().pointCost,children:(0,o.jsxs)("div",{className:_().pointCostInfo,children:[(0,o.jsxs)("div",{className:_().pointCostRow,children:[(0,o.jsx)("span",{className:_().pointCostText,children:r.pointCost.toLocaleString()}),(0,o.jsx)(u.Z,{className:_().computePointsIcon})]}),l&&(0,o.jsx)("span",{className:_().conversionText,children:(0,g.X)(r.pointCost)}),!l&&(0,o.jsx)("span",{className:_().timestampText,children:d("{{val, datetime}}",{val:c,formatParams:{val:{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"}}})})]})})]})},PointsHistoryRowWrapper=e=>{var n,i,a,t;let s,{node:l,showConversions:d}=e;return("JobPointsHistoryNode"===l.__typename?s=null===(i=l.job)||void 0===i?void 0:null===(n=i.trigger.message)||void 0===n?void 0:n.messageCode:"CanvasPointsHistoryNode"===l.__typename&&(s=null===(t=l.canvasJob)||void 0===t?void 0:null===(a=t.trigger.message)||void 0===a?void 0:a.messageCode),s)?(0,o.jsx)(r(),{href:"/message/".concat(s),children:(0,o.jsx)("div",{className:(0,p.$)(_().pointsHistoryRow,_().clickableRow),children:(0,o.jsx)(PointsHistoryRow,{node:l,showConversions:d},l.id)})}):(0,o.jsx)("div",{className:(0,p.$)(_().pointsHistoryRow,_().nonClickableRow),children:(0,o.jsx)(PointsHistoryRow,{node:l,showConversions:d},l.id)})};var messagePoints_PointsHistoryPageColumn=e=>{let{viewer:n}=e,{t}=(0,a.$G)(),{data:s,hasNext:u,loadNext:g,isLoadingNext:p}=(0,d.usePaginationFragment)(i(91693),n),[y,v]=(0,l.useState)(null),P=(0,l.useCallback)(()=>{g(20,{onComplete:e=>{e&&v(e)}})},[g,v]),f=new Date,C=f.toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"}),h=f.toLocaleDateString(void 0,{month:"long",day:"numeric"}),F=t("Data as of {{time}}, {{date}}.",{time:C,date:h});return(0,o.jsx)("div",{className:_().outerContainer,children:(0,o.jsxs)("div",{className:_().columnContainer,children:[(0,o.jsxs)("div",{className:_().dateTimeString,children:[F,s.poeShowConversions&&(0,o.jsxs)("div",{className:_().conversionInfo,children:[t("Points are used to send messages to bots or interact with apps.")," ",(0,o.jsx)(r(),{className:_().link,href:k.ig,target:"_blank",children:t("Learn more")})]})]}),(0,o.jsx)(c.Z,{loadMore:P,hasMore:u,isLoading:p,loadingState:(0,o.jsx)(m.ZP,{}),error:!!y,threshold:10,className:_().scrollContainer,children:s.pointsHistoryConnection.edges.map(e=>(0,o.jsx)(PointsHistoryRowWrapper,{node:e.node,showConversions:s.poeShowConversions},e.node.id))})]})})},v=i(24581),P=i(23595),f=i(64516),messagePoints_PointsHistoryPageNavbar=e=>{let n=(0,f.F)();return(0,P.pE)(n)?null:(0,o.jsx)(v.Z,{...e})},C=i(71258),h=i(30779);let F=(0,h.T)(e=>{let{viewer:n}=e,{t:i}=(0,a.$G)(),s=i("Points history");return n?(0,o.jsxs)(t.Z,{header:(0,o.jsx)(messagePoints_PointsHistoryPageNavbar,{title:s,viewer:n}),noMaxWidth:!0,children:[(0,o.jsx)(C.Z,{title:s}),(0,o.jsx)(messagePoints_PointsHistoryPageColumn,{viewer:n})]}):null},{query:i(30224),variables:{}},{loggedInOnly:!0});var b=F},11300:function(e){e.exports={scrollSection:"MainColumn_scrollSection__A9NHB",scrollSectionOverflow:"MainColumn_scrollSectionOverflow__FbPqw",column:"MainColumn_column__UEunw",noMaxWidth:"MainColumn_noMaxWidth__8pWAi",disallowScroll:"MainColumn_disallowScroll__zR9H2",startAtBottom:"MainColumn_startAtBottom__KeM8B"}},67512:function(e){e.exports={outerContainer:"PointsHistoryPageColumn_outerContainer__O8C_k",columnContainer:"PointsHistoryPageColumn_columnContainer__M1MbZ",pointsHistoryRow:"PointsHistoryPageColumn_pointsHistoryRow__p4OdZ",clickableRow:"PointsHistoryPageColumn_clickableRow__295vB",nonClickableRow:"PointsHistoryPageColumn_nonClickableRow__Nt4SH",botInfo:"PointsHistoryPageColumn_botInfo__yfsNy",botName:"PointsHistoryPageColumn_botName__emwIr",contextInfo:"PointsHistoryPageColumn_contextInfo__OLOFU",pointCost:"PointsHistoryPageColumn_pointCost__Bu8wl",pointCostInfo:"PointsHistoryPageColumn_pointCostInfo__ariN9",pointCostRow:"PointsHistoryPageColumn_pointCostRow__LGg8h",link:"PointsHistoryPageColumn_link__bvfYh",computePointsIcon:"PointsHistoryPageColumn_computePointsIcon__7BUaf",infoIcon:"PointsHistoryPageColumn_infoIcon__v6LG8",pointCostText:"PointsHistoryPageColumn_pointCostText__kjt77",timestampText:"PointsHistoryPageColumn_timestampText__cVr_K",conversionText:"PointsHistoryPageColumn_conversionText__ZeguV",scrollContainer:"PointsHistoryPageColumn_scrollContainer__i6U_V",dateTimeString:"PointsHistoryPageColumn_dateTimeString__jmZrj"}},56782:function(e){e.exports={container:"InfiniteScroll_container__PHsd4",horizontal:"InfiniteScroll_horizontal__i7SXE",pagingTrigger:"InfiniteScroll_pagingTrigger__cdz9I"}}},function(e){e.O(0,[6342,9692,1664,5675,1476,2492,1116,5556,9913,3012,8062,2071,2460,486,9142,2998,9774,2888,179],function(){return e(e.s=11726)}),_N_E=e.O()}]);