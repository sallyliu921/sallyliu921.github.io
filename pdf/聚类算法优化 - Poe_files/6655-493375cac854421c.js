(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6655],{53968:function(e,a,t){"use strict";var n,s=t(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}a.Z=function(e){return s.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.614 4.211a1 1 0 0 1 .175 1.403L10.607 18.691a1 1 0 0 1-1.496.093l-5.818-5.819a1 1 0 1 1 1.414-1.414l5.018 5.018L19.21 4.386a1 1 0 0 1 1.403-.175Z"})))}},41677:function(e,a,t){"use strict";var n,s,r=t(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}a.Z=function(e){return r.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=r.createElement("path",{d:"m21.205 7.556-5.291-5.265A.995.995 0 0 0 15.209 2h-6.5a1 1 0 0 0-1 1v2.235h2V4h4.503v4.265a1 1 0 0 0 1 1H19.5v5.5h-1.209v2H20.5a1 1 0 0 0 1-1v-7.5a.998.998 0 0 0-.295-.709Zm-4.993-2.147 1.865 1.856h-1.865V5.409Z"})),s||(s=r.createElement("path",{d:"m15.996 12.791-5.291-5.265a1 1 0 0 0-.705-.29H3.5a1 1 0 0 0-1 1V21a1 1 0 0 0 1 1h11.791a1 1 0 0 0 1-1v-7.5a1 1 0 0 0-.295-.709Zm-4.993-2.147 1.865 1.856h-1.865v-1.856ZM4.5 20V9.235h4.503V13.5a1 1 0 0 0 1 1h4.288V20H4.5Z"})))}},99240:function(e,a,t){"use strict";var n,s,r=t(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}a.Z=function(e){return r.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=r.createElement("path",{d:"M19.5 21h-15c-.55 0-1-.45-1-1v-3c0-.55.45-1 1-1s1 .45 1 1v2h13v-2c0-.55.45-1 1-1s1 .45 1 1v3c0 .55-.45 1-1 1Z"})),s||(s=r.createElement("path",{d:"M12 16.5c-.25 0-.48-.09-.65-.24-.01-.01-.02-.01-.02-.02l-6.05-5.5a.997.997 0 1 1 1.34-1.48L11 13.24V4c0-.55.45-1 1-1s1 .45 1 1v9.23l4.38-3.97a.997.997 0 1 1 1.34 1.48l-5.98 5.43c-.18.2-.44.33-.74.33Z"})))}},48824:function(e,a,t){"use strict";var n,s,r=t(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}a.Z=function(e){return r.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=r.createElement("path",{d:"M16.5 21H4c-.55 0-1-.45-1-1V7.5c0-.55.45-1 1-1h6.5c.55 0 1 .45 1 1s-.45 1-1 1H5V19h10.5v-5.5c0-.55.45-1 1-1s1 .45 1 1V20c0 .55-.45 1-1 1Z"})),s||(s=r.createElement("path",{d:"M12 13c-.26 0-.51-.1-.71-.29a.996.996 0 0 1 0-1.41l6.79-6.79H14.5c-.55 0-1-.45-1-1s.45-1 1-1h6c.13 0 .26.03.38.08.12.03.23.11.33.2.1.09.17.21.21.33.05.12.08.24.08.38v6c0 .55-.45 1-1 1s-1-.45-1-1V5.91l-6.79 6.79c-.2.2-.45.3-.71.3Z"})))}},97341:function(e,a,t){"use strict";var n,s=t(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}a.Z=function(e){return s.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2a1 1 0 0 1 1 1v4a1 1 0 1 1-2 0V3a1 1 0 0 1 1-1ZM12 16a1 1 0 0 1 1 1v4a1 1 0 1 1-2 0v-4a1 1 0 0 1 1-1ZM5.293 5.293a1 1 0 0 1 1.414 0l2 2a1 1 0 0 1-1.414 1.414l-2-2a1 1 0 0 1 0-1.414ZM15.293 15.293a1 1 0 0 1 1.414 0l2 2a1 1 0 0 1-1.414 1.414l-2-2a1 1 0 0 1 0-1.414ZM2 12a1 1 0 0 1 1-1h4a1 1 0 1 1 0 2H3a1 1 0 0 1-1-1ZM16 12a1 1 0 0 1 1-1h4a1 1 0 1 1 0 2h-4a1 1 0 0 1-1-1ZM8.707 15.293a1 1 0 0 1 0 1.414l-2 2a1 1 0 0 1-1.414-1.414l2-2a1 1 0 0 1 1.414 0ZM18.707 5.293a1 1 0 0 1 0 1.414l-2 2a1 1 0 1 1-1.414-1.414l2-2a1 1 0 0 1 1.414 0Z"})))}},36789:function(e,a,t){"use strict";var n,s=t(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}a.Z=function(e){return s.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=s.createElement("path",{d:"M19.537 11.156a1 1 0 0 1 0 1.688l-11 7A1 1 0 0 1 7 19V5a1 1 0 0 1 1.537-.844l11 7Z"})))}},95674:function(e,a,t){"use strict";var n,s=t(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}a.Z=function(e){return s.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),n||(n=s.createElement("path",{d:"m4.04 11.93 3.29-1.2c.52-.19.79-.76.6-1.28a.998.998 0 0 0-1.28-.6l-1.08.39A7 7 0 0 1 12 5c2.93 0 5.57 1.85 6.58 4.6.19.52.76.78 1.28.6.52-.19.79-.76.6-1.28C19.16 5.38 15.77 3 12 3 8.41 3 5.22 5.12 3.79 8.31l-.35-.96a.998.998 0 0 0-1.28-.6c-.52.19-.79.76-.6 1.28l1.2 3.29c.15.41.53.66.94.66.11.01.23-.01.34-.05ZM22.43 15.95l-1.2-3.29a.998.998 0 0 0-1.28-.6l-3.29 1.2c-.52.19-.79.76-.6 1.28.19.52.77.79 1.28.6l1.09-.4A6.982 6.982 0 0 1 12 19a7.01 7.01 0 0 1-6.58-4.61.998.998 0 0 0-1.28-.6c-.52.19-.79.76-.6 1.28A9.028 9.028 0 0 0 12 21c3.59 0 6.78-2.12 8.21-5.3l.34.93a.998.998 0 0 0 1.28.6c.52-.19.79-.76.6-1.28Z"})))}},43181:function(e,a,t){"use strict";t.r(a);let n={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"Attachments_attachment",selections:[{kind:"ScalarField",name:"id"},{kind:"ScalarField",name:"isInline"},{concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[{kind:"ScalarField",name:"mimeType"},{kind:"ScalarField",name:"width"},{kind:"ScalarField",name:"height"}]},{kind:"FragmentSpread",name:"FileInfo_attachment"},{kind:"FragmentSpread",name:"AudioPlayer_attachment"},{kind:"FragmentSpread",name:"VideoPlayer_attachment"},{kind:"FragmentSpread",name:"VideoPreview_attachment"}],type:"Attachment",abstractKey:"__isAttachment"};n.hash="3fb41b8ac921f8df63f1dad2a1924d34",a.default=n},25667:function(e,a,t){"use strict";t.r(a);let n={argumentDefinitions:[],kind:"Fragment",name:"Attachments_viewer",selections:[{kind:"FragmentSpread",name:"FileInfo_viewer"},{alias:"enableVideoAttachmentsForBots",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_video_player"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_video_player")'},{alias:"enableAudioAttachmentsForBots",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_audio_player"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_audio_player")'}],type:"Viewer"};n.hash="7235e8603905491f02052a44e3c99ce1",a.default=n},64528:function(e,a,t){"use strict";t.r(a);let n={argumentDefinitions:[{defaultValue:!0,kind:"LocalArgument",name:"allowLink"},{defaultValue:null,kind:"LocalArgument",name:"imageSize"},{defaultValue:!1,kind:"LocalArgument",name:"showDescription"}],kind:"Fragment",name:"BotHeader_bot",selections:[{kind:"ScalarField",name:"limitedAccessType"},{kind:"ScalarField",name:"shouldHideLimitedAccessTag"},{condition:"showDescription",kind:"Condition",passingValue:!0,selections:[{kind:"ScalarField",name:"description"}]},{kind:"ScalarField",name:"translatedBotTags"},{args:[{kind:"Variable",name:"size",variableName:"imageSize"}],kind:"FragmentSpread",name:"BotImage_bot"},{condition:"allowLink",kind:"Condition",passingValue:!0,selections:[{kind:"FragmentSpread",name:"BotLink_bot"}]},{kind:"FragmentSpread",name:"IdAnnotation_node"},{kind:"FragmentSpread",name:"botHelpers_useViewerCanAccessPrivateBot"},{kind:"FragmentSpread",name:"botHelpers_useDeletion_bot"},{kind:"FragmentSpread",name:"botHelpers_useBotDisplayName_bot"}],type:"Bot"};n.hash="5ab4521aa4d822b51aff8d08e0b2fe04",a.default=n},66562:function(e,a,t){"use strict";t.r(a);let n={argumentDefinitions:[],kind:"Fragment",name:"BotLink_bot",selections:[{kind:"ScalarField",name:"handle"}],type:"Bot"};n.hash="574ee5a4c6d9ba8ef15b0678164be116",a.default=n},32260:function(e,a,t){"use strict";t.r(a);let n={argumentDefinitions:[],kind:"Fragment",name:"BotMessageHeader_bot",selections:[{kind:"FragmentSpread",name:"BotHeader_bot"},{kind:"InlineDataFragmentSpread",name:"setBotDetailsSidebar_bot",selections:[{kind:"FragmentSpread",name:"ChatBotDetailsSidebar_bot"}],argumentDefinitions:[]},{kind:"FragmentSpread",name:"botHelpers_useDeletion_bot"}],type:"Bot"};n.hash="53ef889254e0e04b8978e6b708a19b07",a.default=n},60812:function(e,a,t){"use strict";t.r(a);let n={argumentDefinitions:[],kind:"Fragment",name:"ChatMessageReactionsContextWrapper_chat",selections:[{kind:"FragmentSpread",name:"useIsMultiUserChat_chat"}],type:"Chat"};n.hash="4042f5f59ec0aa89f74126424ffccf07",a.default=n},45692:function(e,a,t){"use strict";t.r(a);let n={argumentDefinitions:[],kind:"Fragment",name:"ChatMessageReactionsContextWrapper_message",selections:[{kind:"ScalarField",name:"messageId"},{concreteType:"MessageReactionCount",kind:"LinkedField",name:"reactionCounts",plural:!0,selections:[{kind:"ScalarField",name:"reaction"},{kind:"ScalarField",name:"count"}]},{kind:"ScalarField",name:"viewerReaction"}],type:"Message"};n.hash="6fb7ca98c86170c11a738872850ffff6",a.default=n},28791:function(e,a,t){"use strict";t.r(a);let n={argumentDefinitions:[],kind:"Fragment",name:"ChatMessageReactionsContextWrapper_viewer",selections:[{kind:"FragmentSpread",name:"useIsMultiUserChat_viewer"}],type:"Viewer"};n.hash="2c6337e3cd608f314948632e9d9cafdd",a.default=n},2395:function(e,a,t){"use strict";t.r(a);let n={argumentDefinitions:[],kind:"Fragment",name:"Message_bot",selections:[{kind:"ScalarField",name:"isApiBot"}],type:"Bot"};n.hash="7dfacd681672e42424101fb8d87e8f31",a.default=n},52224:function(e,a,t){"use strict";t.r(a);let n={argumentDefinitions:[],kind:"Fragment",name:"Message_viewer",selections:[{alias:"enableRawHtmlPreview",args:[{kind:"Literal",name:"gateName",value:"poe_web_raw_html_preview"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_raw_html_preview")'},{alias:"enablePreviewSaveAsFileButton",args:[{kind:"Literal",name:"gateName",value:"poe_web_preview_save_as_file_button"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_preview_save_as_file_button")'},{alias:"enablePreviewShareButton",args:[{kind:"Literal",name:"gateName",value:"poe_web_preview_sharing_ui"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_preview_sharing_ui")'},{alias:"enableMiniApps",args:[{kind:"Literal",name:"gateName",value:"poe_web_allow_message_triggered_by_preview"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_allow_message_triggered_by_preview")'},{alias:"enablePreviewCSPDisabling",args:[{kind:"Literal",name:"gateName",value:"poe_web_allow_preview_csp_disabling"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_allow_preview_csp_disabling")'},{alias:"markdownCharacterLimit",args:[{kind:"Literal",name:"gateName",value:"poe_web_markdown_character_limit"}],kind:"ScalarField",name:"integerGate",storageKey:'integerGate(gateName:"poe_web_markdown_character_limit")'},{alias:"enableMultiplayerChatPrototype",args:[{kind:"Literal",name:"gateName",value:"poe_enable_multiplayer_chat_prototype"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_enable_multiplayer_chat_prototype")'},{alias:"enablePreviewReact",args:[{kind:"Literal",name:"gateName",value:"poe_web_react_preview"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_react_preview")'},{alias:"enableExecutableCodeblock",args:[{kind:"Literal",name:"gateName",value:"poe_web_executable_codeblock"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_executable_codeblock")'},{alias:"poeEnableBotAgnosticLoader",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_bot_agnostic_loader"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_bot_agnostic_loader")'},{kind:"ScalarField",name:"promptBotImageDomainWhitelist"}],type:"Viewer"};n.hash="3e494d68b31aa0340daade5ceb1cae62",a.default=n},30933:function(e,a,t){"use strict";var n,s,r,i,o;t.r(a);let l={fragment:{argumentDefinitions:n=[{defaultValue:null,kind:"LocalArgument",name:"index"},{defaultValue:null,kind:"LocalArgument",name:"messageId"}],kind:"Fragment",name:"ShareButtonMutation",selections:[{args:s=[{kind:"Variable",name:"indexOfPreviewInMessage",variableName:"index"},{kind:"Variable",name:"messageId",variableName:"messageId"},{kind:"Literal",name:"previewType",value:"codeblock"}],concreteType:"SharePreviewFromMessage",kind:"LinkedField",name:"sharePreviewFromMessage",plural:!1,selections:[r={kind:"ScalarField",name:"status"},i={kind:"ScalarField",name:"statusMessage"},{concreteType:"SharedPreview",kind:"LinkedField",name:"sharedPreview",plural:!1,selections:[o={kind:"ScalarField",name:"shareUrl"}]}]}],type:"MutationRoot"},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ShareButtonMutation",selections:[{args:s,concreteType:"SharePreviewFromMessage",kind:"LinkedField",name:"sharePreviewFromMessage",plural:!1,selections:[r,i,{concreteType:"SharedPreview",kind:"LinkedField",name:"sharedPreview",plural:!1,selections:[o,{kind:"ScalarField",name:"id"}]}]}]},params:{id:"1ceee03a044f2ad8f5a392ee18247437b55820c97cebb8cec52afb1aca98e9bc",metadata:{},name:"ShareButtonMutation",operationKind:"mutation",text:null}};l.hash="c525bce9a9f79102f348bdbeaf701801",a.default=l},3765:function(e,a,t){"use strict";t.r(a);let n={argumentDefinitions:[],kind:"Fragment",name:"VideoPreview_attachment",selections:[{concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[{kind:"ScalarField",name:"thumbnailUrl"}]},{kind:"FragmentSpread",name:"FileInfo_GenericFileInfo_attachment"}],type:"Attachment",abstractKey:"__isAttachment"};n.hash="2fdec1ca51ecfccc837ea86099fdb0a8",a.default=n},48379:function(e,a,t){"use strict";var n;t.r(a);let s={argumentDefinitions:[],kind:"Fragment",name:"useChatMessageSeenState_chat",selections:[{kind:"FragmentSpread",name:"useIsMultiUserChat_chat"},{concreteType:"Message",kind:"LinkedField",name:"lastMessageSeenByAllOtherMembers",plural:!1,selections:n=[{kind:"ScalarField",name:"messageId"}]},{concreteType:"Message",kind:"LinkedField",name:"lastMessageSeenByAnyOtherMembers",plural:!1,selections:n}],type:"Chat"};s.hash="a3164752c91d1600a100b87e74bde39e",a.default=s},51457:function(e,a,t){"use strict";t.r(a);let n={argumentDefinitions:[],kind:"Fragment",name:"useChatMessageSeenState_message",selections:[{kind:"ScalarField",name:"messageId"},{kind:"ClientExtension",selections:[{kind:"ScalarField",name:"isOptimistic"}]}],type:"Message"};n.hash="d5ee7e7389aa7706ab07d7c6f6e382c9",a.default=n},17013:function(e,a,t){"use strict";t.r(a);let n={argumentDefinitions:[],kind:"Fragment",name:"useChatMessageSeenState_viewer",selections:[{kind:"FragmentSpread",name:"useIsMultiUserChat_viewer"}],type:"Viewer"};n.hash="b9f4f2e8bb66593a115bbcbe93f8c5bd",a.default=n},4118:function(e,a,t){"use strict";var n=t(85893),s=t(22120),r=t(22578),i=t(11803),o=t(77581),l=t(42093),c=t(12251),d=t(25917),u=t.n(d),m=t(52612),g=t(93581),p=t(24752);a.Z=e=>{let a,{bot:d,bold:h=!1,showLimitedAccess:v=!1,showTags:_=!1,linked:w=!1,botIconSize:b="md",onClick:f,className:x}=e,k=(0,r.useFragment)(t(64528),d),{t:C}=(0,s.$G)(),M=(0,l.nn)(k),{isDeleted:y}=(0,l.iZ)(k),j=v&&k.limitedAccessType!==m.Z.no_limit&&!k.shouldHideLimitedAccessTag;a=y?C("Deleted"):M?j?C("Subscriber access"):k.description:C("Private");let S=(0,l.dC)(k),I=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.Z,{bot:k,size:b}),(0,n.jsxs)("div",{className:u().textContainer,children:[(0,n.jsx)("p",{children:S}),a&&(0,n.jsx)("p",{className:u().subText,children:a}),_&&(0,n.jsx)(o.$,{className:u().tags,children:k.translatedBotTags.map((e,a)=>(0,n.jsx)(o.V,{label:e,className:u().tag},a))})]})]}),B=(0,c.$)(h?u().boldTitle:u().title,x);return(0,n.jsxs)(n.Fragment,{children:[w?(0,n.jsx)(p.Z,{className:B,bot:k,onClick:f,children:I}):(0,n.jsx)("div",{className:B,onClick:f,children:I}),(0,n.jsx)(i.Z,{node:k})]})}},24752:function(e,a,t){"use strict";var n=t(85893),s=t(22578),r=t(71935),i=t(23595),o=t(38357),l=t(64516);a.Z=e=>{let{bot:a,onClick:c,children:d,className:u,...m}=e,g=(0,s.useFragment)(t(66562),a),p=(0,l.F)();return(0,n.jsx)(r.QQ,{className:u,href:(0,i.au)(p)?(0,o.PW)({path:"/".concat(g.handle),fallbackToBrowser:!0}):"/".concat(g.handle),prefetch:!1,onClick:c,...m,children:d})}},64869:function(e,a,t){"use strict";var n=t(85893),s=t(67294),r=t(22578),i=t(4118),o=t(54344),l=t(42093),c=t(9914),d=t(9525),u=t.n(d);a.Z=e=>{let{bot:a,openSidebarOnClick:d}=e,m=(0,r.useFragment)(t(32260),a),{isLoggedInUser:g}=(0,o.b)(),{isHardDeleted:p}=(0,l.iZ)(m),h=(0,c.X)(),v=(0,s.useCallback)(()=>{h(m)},[h,m]),_=d&&g&&!p;return(0,n.jsxs)("div",{className:u().wrapper,children:[(0,n.jsx)(i.Z,{bot:m,botIconSize:"x-sm",onClick:_?v:void 0,linked:!g||!d,className:_?u().clickableHeader:void 0}),(0,n.jsx)("div",{className:u().badge,children:"Poe"})]})}},30741:function(e,a,t){"use strict";t.d(a,{bk:function(){return useCanvasItem},sc:function(){return useCanvasItemName},Dz:function(){return useOpenCanvasItem}});var n=t(85893),s=t(67294),r=t(75338),i=t(45597),o=t(30870),l=t(17221);let c=(0,s.lazy)(()=>t.e(2622).then(t.bind(t,12622)));function CanvasSideBarLoader(e){return(0,n.jsx)(s.Suspense,{fallback:(0,n.jsx)("div",{}),children:(0,n.jsx)(c,{...e})})}function useCanvasItemName(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=(0,l.j7)();return function(e,a,t){let n=null==t?void 0:t.items[e];return"number"==typeof(null==n?void 0:n.itemIndex)?"".concat(a," ").concat(n.itemIndex):"".concat(a)}(e||"",a||"html",t)}function useOpenCanvasItem(){let e=(0,l.j7)(),a=(0,l.rW)(),t=(0,s.useContext)(i.Z),{setIsCollapsed:o}=(0,r.p)();return(0,s.useCallback)(function(s,r){var i,l;let c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!a||!e)return;let d=null==e?void 0:e.items[s];if(d&&d.contentType===r.contentType&&d.content===r.content&&c)return;let u=Object.values((null==e?void 0:e.items)||{}).map(e=>e.itemIndex),m=null!==(l=null==e?void 0:null===(i=e.items[s])||void 0===i?void 0:i.itemIndex)&&void 0!==l?l:Math.max(0,...u)+1;null==e||e.setItem(s,{...r,itemIndex:m}),null==e||e.setCurrentItemId(s),o(!0),t((0,n.jsx)(CanvasSideBarLoader,{}),{shouldOpen:!0,extraWide:!0})},[a,e,o,t])}function useCanvasItem(e){let a=(0,l.j7)(),t=(0,l.rW)(),n=function(){let e=(0,l.j7)(),a=(0,l.rW)(),{setRightSidebar:t}=(0,o.Qp)();return(0,s.useCallback)(n=>{if(!a||!e)return;e.setItem(n,null);let s=Object.entries((null==e?void 0:e.items)||{}).filter(e=>{let[a]=e;return a!==n});0===s.length?(t(()=>o.PI.CLOSED),null==e||e.setCurrentItemId("")):(null==e?void 0:e.currentItemId)===n&&(null==e||e.setCurrentItemId(s[0][0]))},[a,e,t])}(),r=useOpenCanvasItem();return(0,s.useMemo)(()=>({item:(null==a?void 0:a.items[e])||null,itemIsInCanvas:!!(null==a?void 0:a.items[e]),itemIsRunningInCanvas:(null==a?void 0:a.currentItemId)===e,close:()=>{t&&n(e)},open:a=>{if(!t)return;let n={...a};r(e,n)}}),[a,e,t,n,r])}},81045:function(e,a,t){"use strict";t.d(a,{C:function(){return useChatMessageReactionsContext}});var n=t(85893),s=t(67294),r=t(22578),i=t(46796),o=t(22641);let importMessageReactionsModal=()=>t.e(3933).then(t.bind(t,33933)),l=(0,s.createContext)({openReactionsModal:()=>{},reactionCounts:[],viewerReaction:void 0}),useChatMessageReactionsContext=()=>{let{openReactionsModal:e,reactionCounts:a,viewerReaction:t}=(0,s.useContext)(l);return{openReactionsModal:e,reactionCounts:a,viewerReaction:t}};a.Z=e=>{let{message:a,viewer:c,chat:d,children:u}=e,m=(0,r.useFragment)(t(45692),a),g=(0,r.useFragment)(t(28791),c),p=(0,r.useFragment)(t(60812),d),[h,v]=(0,s.useState)(!1),_=(0,s.useCallback)(()=>{v(!0)},[]),w=(0,s.useCallback)(()=>{v(!1)},[]),b=(0,i.Z)(g,p),f=(0,s.useMemo)(()=>({messageId:m.messageId,closeModal:w}),[m,w]),x=(0,s.useMemo)(()=>({openReactionsModal:_,reactionCounts:b?m.reactionCounts:[],viewerReaction:b?m.viewerReaction:void 0}),[_,m,b]);return(0,n.jsxs)(l.Provider,{value:x,children:[u,b&&(0,n.jsx)(o.Z,{isOpen:h,onRequestClose:w,body:importMessageReactionsModal,bodyProps:f,modalHeight:270,useMinHeight:!0})]})}},88373:function(e,a,t){"use strict";var n=t(85893),s=t(41143),r=t.n(s),i=t(25890);a.Z=e=>{let{reaction:a}=e;return r()(Object.keys(i.i).includes(a),"The provided reaction (".concat(a,") should have a corresponding emoji")),(0,n.jsx)(n.Fragment,{children:i.i[a]})}},25098:function(e,a,t){"use strict";t.d(a,{w:function(){return s}});var n,s,r=t(22578),i=t(46796);(n=s||(s={}))[n.seenByAllOtherMembers=1]="seenByAllOtherMembers",n[n.seenByAnyOtherMembers=2]="seenByAnyOtherMembers",a.Z=e=>{var a,n,s,o;let{chat:l,message:c,viewer:d}=e,u=(0,r.useFragment)(t(17013),d),m=(0,r.useFragment)(t(48379),l),g=(0,r.useFragment)(t(51457),c),p=(0,i.Z)(u,m),h=p&&!g.isOptimistic,v=null!==(s=null===(a=m.lastMessageSeenByAllOtherMembers)||void 0===a?void 0:a.messageId)&&void 0!==s?s:0,_=null!==(o=null===(n=m.lastMessageSeenByAnyOtherMembers)||void 0===n?void 0:n.messageId)&&void 0!==o?o:0;if(h){if(g.messageId<=v)return 1;if(g.messageId<=_)return 2}}},4290:function(e,a,t){"use strict";t.d(a,{Z:function(){return message_Attachments}});var n=t(85893),s=t(5152),r=t.n(s),i=t(67294),o=t(22578),l=t(21054),c=t(48675),d=t(36789),u=t(12251),m=t(87953),g=t.n(m),p=t(24503),patterns_VideoPreview=e=>{let{attachment:a,className:s,messageIsComplete:r}=e,c=(0,o.useFragment)(t(3765),a),[m,h]=(0,i.useState)(!0),v=(0,i.useCallback)(()=>{h(!1)},[h]);return c.file.thumbnailUrl?(0,n.jsxs)("div",{className:g().videoContainer,children:[(0,n.jsx)("div",{className:g().buttonOverlay}),(0,n.jsx)(d.Z,{className:g().playIcon}),m&&(0,n.jsx)("img",{suppressHydrationWarning:!0,className:(0,u.$)(g().thumbnail,s),src:c.file.thumbnailUrl,onError:v})]}):r?(0,n.jsx)(l.S1,{file:c,className:s}):(0,n.jsx)("div",{className:g().thumbnailLoader,children:(0,n.jsx)(p.Z,{})})},h=t(37675),v=t.n(h);let _=r()(()=>Promise.all([t.e(4809),t.e(2785),t.e(8020),t.e(9861)]).then(t.bind(t,19861)),{loadableGenerated:{webpack:()=>[19861]}}),w=r()(()=>Promise.all([t.e(4809),t.e(2785),t.e(1856),t.e(6016)]).then(t.bind(t,73658)),{loadableGenerated:{webpack:()=>[73658]}}),isPlayableVideo=(e,a,t)=>{if(e.startsWith("video/")){let n=document.createElement("video").canPlayType(e);return""!==n&&a&&t&&a/t>=.5&&a/t<=2}return!1};var message_Attachments=e=>{let{attachments:a,viewer:s,showMedia:r,messageIsComplete:d}=e,u=(0,o.useFragment)(t(43181),a),m=(0,o.useFragment)(t(25667),s),g=(0,i.useMemo)(()=>u.filter(e=>!e.isInline),[u]),[p,h,b]=(0,i.useMemo)(()=>g.reduce((e,a)=>{let[t,n,s]=e;return m.enableVideoAttachmentsForBots&&(!r&&a.file.mimeType.startsWith("video/")||r&&isPlayableVideo(a.file.mimeType,a.file.width,a.file.height))?t.push(a):m.enableAudioAttachmentsForBots&&r&&a.file.mimeType.startsWith("audio/")?n.push(a):s.push(a),[t,n,s]},[[],[],[]]),[g,r,m.enableAudioAttachmentsForBots,m.enableVideoAttachmentsForBots]);return(0,n.jsxs)(n.Fragment,{children:[(b.length>0||!r&&p.length>0)&&(0,n.jsxs)(c.Z,{className:v().attachments,children:[!r&&p.map(e=>(0,n.jsx)(patterns_VideoPreview,{attachment:e,className:v().attachment,messageIsComplete:d},e.id)),b.map(e=>(0,n.jsx)(l.ZP,{className:v().attachment,viewer:m,file:e},e.id))]}),r&&h.length>0&&(0,n.jsx)(n.Fragment,{children:h.map(e=>(0,n.jsx)("div",{className:v().audioAttachment,children:(0,n.jsx)(w,{attachment:e,className:v().attachment})},e.id))}),r&&p.length>0&&(0,n.jsx)(n.Fragment,{children:p.map(e=>(0,n.jsx)("div",{className:v().videoAttachment,children:(0,n.jsx)(_,{attachment:e,className:v().attachment})},e.id))})]})}},22392:function(e,a,t){"use strict";let n;t.d(a,{Z:function(){return message_Message}});var s,r,i,o,l=t(85893),c=t(41143),d=t.n(c),u=t(67294),m=t(22120),g=t(22578);t(44311);var p=t(25098),h=t(53968);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var doubleCheckmark=function(e){return u.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),s||(s=u.createElement("path",{d:"m11.945 12.928 5.362-7.338a1 1 0 1 0-1.615-1.179l-5.002 6.844 1.255 1.673ZM6.204 18.605a.987.987 0 1 0 1.578-1.185l-4.506-6.027a.987.987 0 1 0-1.578 1.185l4.506 6.027Z"})),r||(r=u.createElement("path",{d:"M12 19a1 1 0 0 1-.8-.4l-4.5-6a.998.998 0 1 1 1.599-1.199l3.689 4.919 8.704-11.91a1 1 0 0 1 1.615 1.179l-9.5 13a1.001 1.001 0 0 1-.802.41L12 19Z"})))},v=t(16729),_=t.n(v);let MessageSeenStateIcon=e=>{let{messageSeenState:a}=e;return(0,l.jsx)(l.Fragment,{children:a===p.w.seenByAllOtherMembers?(0,l.jsx)(doubleCheckmark,{className:_().messageSeenStateIcon}):(0,l.jsx)(h.Z,{className:_().messageSeenStateIcon})})};var w=t(11070),b=t(69388),message_MessageMetadata=e=>{let{commandType:a,state:t,messageCreationTime:n,seenState:s}=e;return!a&&t!==b.Z.incomplete&&(n||s)?(0,l.jsxs)("div",{className:_().messageMetadataContainer,children:[s&&(0,l.jsx)(MessageSeenStateIcon,{messageSeenState:s}),n&&(0,l.jsx)(w.ZP,{utime:n,forceSameDayFormat:!0,className:_().messageTimestamp})]}):null};function nosign_extends(){return(nosign_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var nosign=function(e){return u.createElement("svg",nosign_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),i||(i=u.createElement("path",{d:"M18.364 5.636 5.636 18.364A8.972 8.972 0 0 1 3 12a9 9 0 0 1 9-9 8.972 8.972 0 0 1 6.364 2.636Zm0 0A8.972 8.972 0 0 1 21 12a9 9 0 0 1-9 9 8.972 8.972 0 0 1-6.364-2.636L18.364 5.636Z",className:"nosign_svg__icon_svg-stroke"})))},f=t(42093),x=t(4095),k=t(12251),C=t(35715),M=t(67280),y=t(86927);let getBotNameFromCompareCommandText=e=>e.split(" ")[0],CompareCommandMessage=e=>{let{botName:a,authorHandle:t,isSentByViewer:n}=e,s=(0,u.useMemo)(()=>({1:(0,l.jsx)("span",{className:_().commandBotName})}),[]),r=(0,u.useMemo)(()=>({botName:a,authorHandle:t}),[a,t]);return n?(0,l.jsx)(m.cC,{components:s,defaults:"You requested another response from <1>{{ botName }}</1>",values:r}):t?(0,l.jsx)(m.cC,{components:s,defaults:"{{ authorHandle }} requested another response from <1>{{ botName }}</1>",values:r}):(0,l.jsx)(m.cC,{components:s,defaults:"A user requested another response from <1>{{ botName }}</1>",values:r})};var message_CommandMessage=e=>{let{commandType:a,text:t,authorHandle:n,isSentByViewer:s}=e;return a===y.Z.compare?(0,l.jsx)(CompareCommandMessage,{botName:getBotNameFromCompareCommandText(t),authorHandle:n,isSentByViewer:s}):null};t(73150);var j=t(88787),S=t(94713),I=t(24087),B=t(1241),P=t(39257),N=t(61302),F=t.n(N),L=t(65604),Z=t(24503),T=t(20454),preview_useInlinePreviewProps=e=>{let{onLoad:a}=e,[t,n]=(0,u.useState)(void 0),s=(0,u.useCallback)(e=>{let{height:a}=e;n(a)},[]),r=(0,u.useCallback)(e=>{let{height:t}=e;null==a||a(),s({height:t})},[s,a]),i=(0,u.useMemo)(()=>t?{height:t}:void 0,[t]);return{style:i,onLoaded:r,onResize:s}},O=t(42148),A=t(58705),D=t(12001),R=t(58143),H=t(9729),preview_usePreviewTimer=e=>{let{language:a,contentType:t}=e,n=(0,u.useRef)(0),s=(0,R.E)();(0,u.useEffect)(()=>{n.current=new Date().getTime()},[]);let r=(0,u.useCallback)(()=>{let e=new Date().getTime()-n.current;(0,H.Z)("poe/preview_speed",{page_type:s,preview_language:a,preview_content_type:t,timing:e})},[a,t,s]);return{stopTimer:r}};let BarePreviewFrame=e=>{let{rawHTMLIdx:a,logData:t,htmlCode:n,showPreviewSafeModeBanner:s,enableMiniApps:r,previewApiContext:i,overlayClassName:o,className:c,containerClassName:d}=e,m=(0,u.useMemo)(()=>({...t,preview_language:L.Z.html,raw_html_index:a}),[t,a]),[g,p]=(0,O.Z)(),h=(0,A.Z)(n,"html",{inline:!0,miniApp:r}),{stopTimer:v}=preview_usePreviewTimer({language:L.Z.html,contentType:"html"}),_=preview_useInlinePreviewProps({onLoad:v}),{disableSafeMode:w,shouldShowSafeModeOverlay:b,onSafeModeOverlayDismiss:f,onSecurityPolicyViolation:x,safeMode:C}=(0,D.Z)();return(0,l.jsx)(T.Z,{overlayClassName:(0,k.$)(F().mainContainer,o),className:(0,k.$)(F().mainContainer,c),containerClassName:(0,k.$)(F().container,d),onReady:h,logData:m,safeMode:C,previewApiContext:i,shouldShowSafeModeOverlay:s&&b,onSafeModeOverlayConfirm:w,onSafeModeOverlayDismiss:f,onSecurityPolicyViolation:x,onMiniAppRequest:r&&i?g:void 0,previewRequestedMessage:p,..._})};function BarePreviewFrameWithIndicator(e){return e.showLoadingSpinner?(0,l.jsx)("div",{className:F().loadingContainer,children:(0,l.jsx)(Z.Z,{color:"accent",size:"sm"})}):(0,l.jsx)(BarePreviewFrame,{...e})}var E=t(45598),V=t(52683),G=t.n(V),W=t(90961);let z=new Set(["iframe","html"]),rawHTMLPlugin=e=>()=>a=>{let t=0;(0,W.Vn)(a,"raw",(a,n,s)=>{if(void 0!==n){if(e&&function(e){let a=e.trim();return 0===a.replace(/^\s*<!doctype\s+[^>]*>/i,"").length}(a.value)){s.children[n]={type:"element",tagName:"div",properties:{style:"display: none"},children:[]};return}if(e&&(null==s?void 0:s.type)==="root"&&function(e){let a=function(e){let a=e.match(/<([a-zA-Z][a-zA-Z0-9_-]*)/);return a?a[1]:null}(e);return!!a&&z.has(a.toLowerCase().trim())}(a.value)){var r,i;s.children[n]={type:"element",tagName:"iframe",properties:{positionEndOffset:null===(i=a.position)||void 0===i?void 0:null===(r=i.end)||void 0===r?void 0:r.offset,srcDoc:a.value,rawHTMLIdx:t++},children:[]};return}if((null==s?void 0:s.type)==="root"){s.children[n]={type:"element",tagName:"div",properties:{},children:a.value.split("\n").map(e=>({type:"element",tagName:"p",properties:{},children:[{type:"text",value:e}]}))};return}}})},codeblockPlugin=()=>e=>{let a=0;(0,W.Vn)(e,"element",(e,t)=>{if(void 0!==t&&"pre"===e.tagName){e.properties.codeblockIdx=a++;let t=e.children[0];if(t&&"element"===t.type&&"code"===t.tagName){let a=t.children[0];a&&"text"===a.type&&(e.properties.code=a.value)}}})};var $=t(5152),U=t.n($),q=t(8693),K=t(58281),Q=t(78410),X=t(34478),Y=t(30741),J=t(827),ee=t.n(J),ea=t(27460),et=t(56505),en=t.n(et),preview_PreviewConsole=e=>{let{log:a,isOpen:t,toggleConsole:n}=e,{t:s}=(0,m.$G)();return(0,l.jsxs)("div",{className:en().console,"aria-expanded":t,children:[(0,l.jsxs)("div",{className:en().consoleHeader,children:[(0,l.jsx)("p",{className:en().consoleHeaderText,children:s("Console")}),(0,l.jsx)(Q.Z,{iconLeft:(0,l.jsx)(ea.bM,{}),showIconOnly:"always",onClick:n,theme:"ghost",as:"button",size:"sm",children:s("Close console")})]}),(0,l.jsx)("div",{className:en().entries,children:a.map((e,a)=>(0,l.jsx)("div",{className:en()[e.type],children:"error"===e.type?(0,l.jsx)("span",{className:en().errorLabel,children:s("Error: {{message}}",{message:e.message})}):"warning"===e.type?(0,l.jsx)("span",{className:en().warningLabel,children:s("Warning: {{message}}",{message:e.message})}):e.message},a))})]})},es=t(17221),er=t(30965),ei=t(95674),eo=t(86363),el=t.n(eo),ec=t(85832),ed=t(48539),eu=t(34389);function CollapseButton(e){let{isCollapsed:a,isInCanvas:t,setIsCollapsed:n}=e;(0,u.useEffect)(()=>{t&&n(t)},[t,n]);let s=(0,u.useCallback)(()=>{n(!a)},[a,n]);return(0,l.jsx)(Q.Z,{as:"button",theme:"ghost",size:"sm","aria-label":a?"Expand preview":"Collapse preview",showIconOnly:"always",iconLeft:a?(0,l.jsx)(ea.ed,{className:el().rotate270}):(0,l.jsx)(ea.ed,{className:el().rotate90}),onClick:s})}var em=t(30870);function OpenInCanvasButton(e){let{itemId:a,contentType:t,content:n,previewApiContext:s,messageNodeId:r,codeblockIdx:i}=e,{open:o}=(0,Y.bk)(a),{setRightSidebar:c}=(0,em.Qp)(),d=(0,eu.C)(),m=(0,u.useCallback)(()=>{c(()=>(o({contentType:t,content:n,previewApiContext:s,shareParams:null!==i?{messageNodeId:r,codeblockIdx:i}:null}),em.PI.OPEN))},[t,c,n,o,s,r,i]);return(0,l.jsx)(Q.Z,{as:"button",size:"sm",theme:"ghost",onClick:m,showIconOnly:d?"always":"compact-below","aria-label":"Open on canvas",iconLeft:(0,l.jsx)(ea.K1,{}),children:"Open on canvas"})}var eg=t(86023),ep=t(48824),eh=t(30038),ev=t(77338),e_=t(60919);let PopoutButton=e=>{let{content:a,contentType:t,codeblockIdx:n,actionLogData:s,messageNodeId:r,allowShare:i}=e,{t:o}=(0,m.$G)(),c=(0,eu.C)(),d=(0,u.useCallback)(()=>{(0,eg.E)({contentType:t,rawPreviewContent:a,shareInformation:i&&"number"==typeof n?{nodeId:r,codeblockIndex:n}:void 0}),(0,e_.Z)({...s,entry_type:ev.Z.open_in_new_tab}),(0,e_.T)({...s,action_type:eh.Z.open_preview_in_new_tab})},[s,n,r,a,t,i]);return(0,l.jsx)(Q.Z,{as:"button",theme:"ghost",size:"sm",iconLeft:(0,l.jsx)(ep.Z,{}),showIconOnly:c?"always":"compact-below",onClick:d,children:o("New tab")})};var ew=t(83169),eb=t(70751);function SaveAsFileDropdownMenuItem(e){let{getFileDownloadInfo:a,actionLogData:t}=e,{t:n}=(0,m.$G)(),s=(0,u.useCallback)(()=>{let e=a();if(!e){console.error("Preview not ready...");return}setTimeout(()=>{!function(e){let a=new Blob([e.fileContents],{type:e.mimeType}),t=URL.createObjectURL(a),n=document.createElement("a");n.href=t,n.download=e.fileNameWithExtension,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}(e),(0,e_.Z)({...t,entry_type:ev.Z.save_as_file}),(0,e_.T)({...t,action_type:eh.Z.save_preview})})},[a,t]);return(0,l.jsxs)(ew.Z,{onClick:s,shrink:!0,children:[(0,l.jsx)(ea.Dj,{className:(0,k.$)(el().icon,(0,eb.MQ)("md"))}),(0,l.jsx)("p",{children:n("Save as file")})]})}var ef=t(8583),ex=t(27382);function ShareButton(e){let{actionLogData:a,disabled:n,messageId:s,codeblockIdx:r}=e,{t:i}=(0,m.$G)(),[o,c]=(0,g.useMutation)(t(30933)),d=(0,ef.ZP)(),p=(0,u.useCallback)(async()=>{let e=new Promise((e,t)=>{o({variables:{messageId:s,index:r},onCompleted:n=>{var s;let r=null===(s=n.sharePreviewFromMessage.sharedPreview)||void 0===s?void 0:s.shareUrl;if(!r){t(),d({type:ef.pC.warning,content:i("Something went wrong.")});return}e(r),(0,e_.Z)({...a,entry_type:ev.Z.share}),(0,e_.T)({...a,action_type:eh.Z.save_preview})}})});await (0,ex.v)(e)&&d({type:ef.pC.success,content:i("Copied link to clipboard.")})},[d,o,i,a,s,r]),h=(0,eu.C)();return(0,l.jsx)(Q.Z,{as:"button",theme:"ghost",size:"sm",iconLeft:(0,l.jsx)(ea.MS,{}),showIconOnly:h?"always":"compact-below","aria-label":i("Share"),isDisabled:c||n,onClick:p,children:i("Share")})}function ToggleConsoleDropdownMenuItem(e){let{isConsoleOpen:a,toggleConsole:t}=e,{t:n}=(0,m.$G)();return(0,l.jsxs)(ew.Z,{onClick:t,shrink:!0,children:[(0,l.jsx)(ea.tq,{size:"md",className:(0,k.$)(el().icon)}),(0,l.jsx)("p",{children:n(a?"Hide console":"Show console")})]})}function PreviewHeaderOverflowButton(e){let{getFileDownloadInfo:a,toggleConsole:t,isConsoleOpen:n,actionLogData:s,showSaveAsFile:r}=e,{t:i}=(0,m.$G)(),[o,c]=(0,u.useState)(!1),d=i("More options");return(0,l.jsx)(ed.Z,{tooltipLabel:d,setMenuOpen:c,menuOpen:o,alignMenuLeft:!0,menuBody:(0,l.jsxs)(ec.Z,{children:[(0,l.jsx)(ToggleConsoleDropdownMenuItem,{isConsoleOpen:n,toggleConsole:t}),r&&(0,l.jsx)(SaveAsFileDropdownMenuItem,{actionLogData:s,getFileDownloadInfo:a})]})})}let CanvasEnabledPreviewHeader=e=>{var a,t;let{showPreviewShareButton:n,codeblockIdx:s,disableShareButton:r,actionLogData:i}=e,o=null===(a=(0,u.useContext)(er.Z))||void 0===a?void 0:a.messageId,{itemIsRunningInCanvas:c}=(0,Y.bk)(e.canvasItemId),d=(0,Y.sc)(e.canvasItemId,e.contentType);return(0,l.jsxs)("div",{className:el().header,children:[(0,l.jsxs)("div",{className:el().headerLeft,children:[(0,l.jsx)("p",{className:el().headerLeftTitle,children:d}),c&&(0,l.jsx)("p",{"aria-label":"Running in canvas",className:el().runningInCanvas})]}),(0,l.jsxs)("div",{className:el().headerRight,children:[!e.isInCanvas&&!e.isCollapsed&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(PreviewHeaderOverflowButton,{showSaveAsFile:e.showSaveAsFile,getFileDownloadInfo:e.getFileDownloadInfo,isConsoleOpen:e.isConsoleOpen,toggleConsole:e.toggleConsole,actionLogData:e.actionLogData}),n&&"number"==typeof s&&"number"==typeof o&&(0,l.jsx)(ShareButton,{codeblockIdx:s,messageId:o,disabled:r,actionLogData:i})]}),(0,l.jsx)(OpenInCanvasButton,{itemId:e.canvasItemId,contentType:e.contentType,content:e.content,previewApiContext:e.previewApiContext,messageNodeId:e.messageNodeId,codeblockIdx:null!==(t=e.codeblockIdx)&&void 0!==t?t:null}),(0,l.jsx)(CollapseButton,{isCollapsed:e.isCollapsed,isInCanvas:e.isInCanvas,setIsCollapsed:e.setIsCollapsed})]})]})},PreviewHeaderNoCanvas=e=>{var a;let{isInCanvas:t,refresh:n,isConsoleOpen:s,toggleConsole:r,content:i,contentType:o,showSaveAsFile:c,showPreviewShareButton:d,getFileDownloadInfo:g,messageNodeId:p,actionLogData:h,codeblockIdx:v,disableShareButton:_}=e,{t:w}=(0,m.$G)(),b=null===(a=(0,u.useContext)(er.Z))||void 0===a?void 0:a.messageId,f=(0,eu.C)();return(0,l.jsxs)("div",{className:el().header,children:[(0,l.jsxs)("div",{className:el().headerLeft,children:[(0,l.jsx)(Q.Z,{as:"button",theme:"ghost",size:"sm",isDisabled:t,iconLeft:(0,l.jsx)(ei.Z,{}),showIconOnly:f?"always":"compact-below",onClick:n,children:w("Refresh")}),(0,l.jsx)(PopoutButton,{content:i,contentType:o,codeblockIdx:v,messageNodeId:p,allowShare:d,actionLogData:h}),(0,l.jsx)(PreviewHeaderOverflowButton,{showSaveAsFile:c,getFileDownloadInfo:g,isConsoleOpen:s,toggleConsole:r,actionLogData:h})]}),(0,l.jsx)("div",{className:el().headerRight,children:d&&"number"==typeof v&&"number"==typeof b&&(0,l.jsx)(ShareButton,{codeblockIdx:v,messageId:b,disabled:_,actionLogData:h})})]})};var preview_PreviewHeader=function(e){let a=(0,es.rW)();return a?(0,l.jsx)(CanvasEnabledPreviewHeader,{...e}):(0,l.jsx)(PreviewHeaderNoCanvas,{...e})},ek=t(98077),preview_PreviewOpenHereInsteadConfirmation=e=>{let{className:a,canvasItemId:t}=e,{t:n}=(0,m.$G)(),{close:s}=(0,Y.bk)(t);return(0,l.jsx)(ek.Z,{className:a,icon:(0,l.jsx)(ea.K1,{size:"x-lg"}),text:(0,l.jsx)("p",{children:n("This content is already running on one of the canvas tabs. Opening it here may cause loss of unsaved progress.")}),actions:(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(Q.Z,{as:"button",theme:"outline",onClick:s,children:n("Open here instead")})})})},useDownloadFileInfo=()=>{let e=(0,u.useRef)(null),a=(0,u.useCallback)(a=>{let{fileContents:t,fileExtension:n}=a;e.current={fileContents:t,fileNameWithExtension:"poe-preview."+n,mimeType:"text/html"}},[]),t=(0,u.useCallback)(()=>e.current,[]);return{onFileContentsForDownload:a,getFileDownloadInfo:t}},preview_usePreviewConsole=()=>{let[e,a]=(0,u.useState)([]),t=(0,u.useCallback)(()=>{a([])},[]),n=(0,u.useCallback)(e=>{let{args:t}=e;a(e=>[...e,{type:"info",message:t.join(" ")}])},[]),s=(0,u.useCallback)(e=>{let{args:t}=e;a(e=>[...e,{type:"warning",message:t.join(" ")}])},[]),r=(0,u.useCallback)(e=>{let{args:t}=e;a(e=>[...e,{type:"error",message:t.join(" ")}])},[]),i=(0,u.useCallback)(e=>{let{message:t}=e;a(e=>[...e,{type:"error",message:t}])},[]);return{log:e,clearLog:t,onLog:n,onWarn:s,onError:r,onUncaughtError:i}};let useConsoleToggle=e=>{let[a,t]=(0,u.useState)(void 0),n=void 0===a?e.some(e=>{let{type:a}=e;return"error"===a}):a,s=(0,u.useCallback)(()=>{t(!n)},[n]);return{isConsoleOpen:n,toggleConsole:s}};var preview_PreviewFrame=e=>{let{content:a,contentType:t,language:n,showSaveAsFile:s,actionLogData:r,disableShareButton:i,codeblockIdx:o,messageNodeId:c,enableMiniApps:d,previewApiContext:m,showPreviewShareButton:g,showPreviewSafeModeBanner:p}=e,{stopTimer:h}=preview_usePreviewTimer({contentType:t,language:n}),v=preview_useInlinePreviewProps({onLoad:h}),{log:_,clearLog:w,...b}=preview_usePreviewConsole(),{getFileDownloadInfo:f,...x}=useDownloadFileInfo(),k=(0,A.Z)(a,t,{inline:!0,miniApp:d}),[C,M]=(0,O.Z)(),[y,j]=(0,u.useState)(0),S=(0,u.useCallback)(()=>{w(),j(e=>e+1)},[w]),{isConsoleOpen:I,toggleConsole:B}=useConsoleToggle(_),P=(0,R.E)(),N=(0,u.useMemo)(()=>({preview_language:n,page_type:P,...r}),[r,P,n]),{disableSafeMode:F,shouldShowSafeModeOverlay:L,onSafeModeOverlayDismiss:Z,onSecurityPolicyViolation:H,safeMode:E}=(0,D.Z)(y,N),V="".concat(c,"-").concat(o),{itemIsInCanvas:G}=(0,Y.bk)(V),[W,z]=(0,u.useState)(!1);return(0,l.jsxs)("div",{className:ee().container,children:[(0,l.jsx)(preview_PreviewHeader,{isCollapsed:W,setIsCollapsed:z,isInCanvas:G,actionLogData:N,refresh:S,messageNodeId:c,isConsoleOpen:I,canvasItemId:V,toggleConsole:B,previewApiContext:m,content:a,contentType:t,getFileDownloadInfo:f,showSaveAsFile:s,codeblockIdx:o,showPreviewShareButton:g,disableShareButton:i}),!W&&G&&(0,l.jsx)(preview_PreviewOpenHereInsteadConfirmation,{canvasItemId:V}),!W&&!G&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(T.Z,{logData:N,safeMode:E,previewApiContext:m,previewRequestedMessage:M,shouldShowSafeModeOverlay:p&&L,onSafeModeOverlayConfirm:F,onSafeModeOverlayDismiss:Z,onReady:k,onSecurityPolicyViolation:H,onMiniAppRequest:d?C:void 0,...v,...b,...x},y),(0,l.jsx)(preview_PreviewConsole,{log:_,isOpen:I,toggleConsole:B})]})]})},eC=t(41677);function expand_extends(){return(expand_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var icons_expand=function(e){return u.createElement("svg",expand_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),o||(o=u.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 5a1 1 0 1 1 0-2H20a1 1 0 0 1 1 1v5.5a1 1 0 1 1-2 0V6.414l-4.293 4.293a1 1 0 0 1-1.414-1.414L17.586 5H14.5Zm-3.793 8.293a1 1 0 0 1 0 1.414L6.414 19H9.5a1 1 0 1 1 0 2H4a1 1 0 0 1-1-1v-5.5a1 1 0 1 1 2 0v3.086l4.293-4.293a1 1 0 0 1 1.414 0Z"})))},eM=t(36789),ey=t(49231),ej=t.n(ey),eS=t(96384);let RunButtonPlaceholder=()=>{let{t:e}=(0,m.$G)(),a=(0,eu.C)();return(0,l.jsx)(Q.Z,{className:ej().codeActionButton,as:"button",theme:"ghost",size:"sm",iconLeft:(0,l.jsx)(eM.Z,{}),isDisabled:!0,showIconOnly:a?"always":"compact-below",children:e("Run")})},eI=U()(()=>t.e(7090).then(t.bind(t,47090)),{loadableGenerated:{webpack:()=>[47090]},ssr:!1,loading:()=>(0,l.jsx)(RunButtonPlaceholder,{})}),eB=/language-(\w+(?:-\w+)*)/,useLowlight=()=>{let[e,a]=(0,u.useState)(n),s=(0,u.useMemo)(()=>Promise.all([t.e(5957),t.e(125),t.e(7764),t.e(6965),t.e(1708),t.e(6563),t.e(295),t.e(4360),t.e(8967),t.e(3180),t.e(9651)]).then(t.t.bind(t,26912,23)),[]);return(0,u.useEffect)(()=>{e||s.then(e=>{a(n=e)})},[s,e]),e},useDetectLanguage=(e,a)=>{let t=useLowlight(),n=e.substring(0,1e3),s=(0,u.useMemo)(()=>{let e=null==a?void 0:a.match(eB);if(e)return{language:e[1].toLowerCase(),showLanguageName:!0};if((0,X.X_)(n))return{language:"svg",showLanguageName:!0};if((0,X.vB)(n))return{language:"html",showLanguageName:!0};if(!t)return;let s=t.highlightAuto(n);return{language:s.language,showLanguageName:s.relevance>=10}},[t,n,a]);return s},useCodeblockCollapse=e=>{let[a,t]=(0,u.useState)(null),n=(0,u.useCallback)(()=>t(!1),[]),s=(0,u.useRef)(null),r=(0,u.useRef)(null);return(0,u.useEffect)(()=>{if(e&&null===a&&s.current&&r.current){let e=s.current,n=r.current;if(e.scrollHeight>n.clientHeight)t(!0);else{let s=new ResizeObserver(()=>{null===a&&e.scrollHeight>n.clientHeight&&(t(e=>null===e||e),s.unobserve(e),s.disconnect())});return s.observe(e),()=>{s.unobserve(e),s.disconnect()}}}},[e,a]),{collapsed:a,expand:n,preElementRef:s,codeSectionRef:r}},PreBlock=e=>{let{languageMatch:a,getCode:t,actionLogData:n,collapsible:s=!1,executable:r,isPartial:i,codeblockIdx:o,...c}=e,{t:d}=(0,m.$G)(),g=(0,ef.ZP)(),p=(0,u.useCallback)(()=>{navigator.clipboard.writeText(t().trim()),g({content:d("Copied to clipboard"),type:ef.pC.success}),(0,H.Z)("poe/action_log",{action_type:(0,eS.E)(eh.Z.copy_code),...n})},[t,n,g,d]),{collapsed:h,expand:v,preElementRef:_,codeSectionRef:w}=useCodeblockCollapse(s),b=(0,eu.C)();return(0,l.jsxs)("div",{className:ej().codeBlock,children:[(0,l.jsxs)("div",{className:ej().codeHeader,children:[(0,l.jsx)("div",{className:ej().languageName,children:(null==a?void 0:a.showLanguageName)&&a.language}),(0,l.jsxs)("div",{className:ej().codeActions,children:[r&&a&&(0,l.jsx)(u.Suspense,{fallback:(0,l.jsx)(RunButtonPlaceholder,{}),children:(0,l.jsx)(eI,{className:ej().codeActionButton,language:a.language,code:t(),disabled:i,codeblockIdx:o})}),(0,l.jsx)(Q.Z,{className:ej().codeActionButton,as:"button",theme:"ghost",size:"sm",onClick:p,iconLeft:(0,l.jsx)(eC.Z,{}),showIconOnly:b?"always":"compact-below",children:d("Copy")})]})]}),(0,l.jsxs)("div",{ref:w,className:(0,k.$)(ej().codeSection,s&&ej().collapsible),"data-collapsed":null===h?"unknown":h,onClick:h?v:void 0,children:[h&&(0,l.jsx)("div",{className:ej().expandButtonContainer,children:(0,l.jsx)(Q.Z,{as:"button",theme:"secondary",size:"sm",onClick:v,iconLeft:(0,l.jsx)(icons_expand,{}),className:ej().expandButton,children:d("View all")})}),(0,l.jsx)("pre",{...c,ref:_,className:ej().preTag})]})]})},CodeBlock=e=>(0,l.jsx)("code",{...e,className:ej().codeTag}),getSyntaxHighlighterLanguage=e=>"html"===e.language?"xml":e.language,checkCanShowPreview=e=>{let{supportedPreviewsContentTypes:a,contentType:t,enablePreviewReact:n}=e;return!!t&&!!a.includes(t)&&("react"!==t||n)},checkCanExecute=e=>{let{supportedExecutableLanguages:a,language:t,enableExecutableCodeblock:n}=e;return n&&!!t&&!!a&&a.map(e=>e.language).includes(t)};var message_MarkdownCodeBlock=e=>{let{className:a,showPreview:t,collapsible:n,code:s,metadata:r,messageNodeId:i,showPreviewSaveAsFileButton:o,showPreviewShareButton:c,showPreviewSafeModeBanner:d,previewApiContext:m,enableMiniApps:g,enablePreviewReact:p,enableExecutableCodeblock:h,actionLogData:v,codeblockIdx:_,disablePreviewShareButton:w,supportedPreviewsContentTypes:b,supportedExecutableLanguages:f,isPartial:x}=e,k=(0,u.useRef)(s);k.current=s;let C=(0,u.useCallback)(()=>k.current,[]),M=useDetectLanguage(s,a),y=(0,u.useRef)(M);y.current=M;let j=(0,X.lX)({language:null==M?void 0:M.language,metadata:r,code:s,supportedPreviewsContentTypes:b}),S=checkCanShowPreview({supportedPreviewsContentTypes:b,contentType:j,enablePreviewReact:p}),I=n&&S,B=checkCanExecute({supportedExecutableLanguages:f,language:null==M?void 0:M.language,enableExecutableCodeblock:h}),P=(0,u.useMemo)(()=>({...v,codeblock_index:_}),[v,_]),N=(0,u.useCallback)(e=>(0,l.jsx)(PreBlock,{...e,actionLogData:P,languageMatch:y.current,getCode:C,collapsible:I,executable:B,isPartial:x,codeblockIdx:_}),[C,I,B,x,_,P]),[F]=(0,u.useState)(t),Z=(null==M?void 0:M.language)?null==M?void 0:M.language:"html"===j?L.Z.html:"react"===j?L.Z.jsx:null,T=(0,es.rW)(),O=(0,u.useRef)((0,Y.Dz)()),A=(0,u.useRef)(s);A.current=s;let D=(0,u.useRef)(m);return D.current=m,(0,u.useEffect)(()=>{if(!T||F)return;let e="".concat(i,"-").concat(_);j&&Z&&O.current(e,{content:t?A.current:null,contentType:j,previewApiContext:D.current,shareParams:{messageNodeId:i,codeblockIdx:_}},!0)},[F,T,j,Z,O,t,i,D,_]),(0,l.jsxs)("div",{className:ej().container,children:[(0,l.jsx)(q.Z,{style:K.Z,className:a,PreTag:N,CodeTag:CodeBlock,...M?{language:getSyntaxHighlighterLanguage(M)}:{},children:s}),t&&S&&j&&Z?(0,l.jsx)(preview_PreviewFrame,{actionLogData:P,content:s,contentType:j,language:Z,messageNodeId:i,previewApiContext:m,showPreviewShareButton:c,disableShareButton:w,showSaveAsFile:o||!1,showPreviewSafeModeBanner:d,codeblockIdx:_,enableMiniApps:g}):null]})},eP=t(31657),eN=t(4909),eF=t(53679),eL=t(98521),eZ=t(99240),eT=t(97341),eO=t(3687),eA=t(6103),eD=t.n(eA);let getSrcSize=e=>{try{if(!e)return null;let a=new URL(e),t=parseInt(a.searchParams.get("w")||""),n=parseInt(a.searchParams.get("h")||"");if(Number.isNaN(t)||Number.isNaN(n))return null;return{width:t,height:n}}catch(e){return null}};var message_MarkdownImage=e=>{let{alt:a,src:t,...n}=e,{t:s}=(0,m.$G)(),r=(0,u.useRef)(null),[i,o]=(0,eO.O6)(),c=(0,u.useContext)(eP.Z),d=(0,u.useContext)(er.Z),g=(0,u.useCallback)(()=>{t&&(0,eO.km)(t,eO.Jg.image,{botId:null==d?void 0:d.botId,messageId:null==d?void 0:d.messageId,chatId:(null==c?void 0:c.chatId)||null})},[c,d,t]),p=(0,u.useCallback)(async()=>{t&&await i(t,eO.Jg.image,a,g)},[t,a,i,g]),[h,v]=(0,u.useState)(!1),_=(0,u.useCallback)(()=>{v(!0)},[v]);(0,u.useEffect)(()=>{var e;(null===(e=r.current)||void 0===e?void 0:e.complete)&&_()},[_]);let w=getSrcSize(t),{openImageViewer:b}=(0,eF.z)(),f=(0,u.useCallback)(()=>{t&&b({src:t,alt:a},()=>g)},[t,a,b,g]),[x,C]=(0,u.useState)(null),M=s("Download image");return(0,l.jsxs)("span",{className:eD().imageContainer,children:[w?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("img",{className:(0,k.$)(eD().image,eD().withPlaceholder),ref:r,src:t,alt:a,...n,onLoad:_,onClick:f}),(0,l.jsx)("canvas",{height:w.height,width:w.width,className:eD().placeholder})]}):(0,l.jsx)("img",{className:eD().image,ref:r,src:t,alt:a,...n,onLoad:_,onClick:f}),h&&t&&"server_inject_icon"!=a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eN.Xd,{ref:C,className:eD().downloadImageButton,"data-downloading":o,disabled:o,onClick:o?void 0:p,icon:o?(0,l.jsx)(eT.Z,{}):(0,l.jsx)(eZ.Z,{})}),(0,l.jsx)(eL.Z,{anchorRef:x,label:M,placement:"top"})]})]})},eR=t(16593),eH=t(8044),eE=t.n(eH),eV=t(39609);let parseInlineCitationInfo=e=>{let a="poe.com"===e.hostname,t=(0,eR.Zw)(e.pathname),n=1===t.length&&"citation"===t[0],s=e.searchParams.get("message_id"),r=e.searchParams.get("citation"),i=parseInt(s||""),o=parseInt(r||""),l=a&&n&&Number.isInteger(i)&&Number.isInteger(o);return l?{messageId:i,citationIndex:o}:null},MarkdownLinkCitationInner=e=>{let{messageId:a,citationIndex:t,className:n,...s}=e,{modal:r,openModal:i}=(0,eV.Z)({messageId:a,citationIndex:t});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("a",{...s,className:(0,k.$)(n,eE().linkifiedLink),onClick:i,href:void 0}),r]})};var message_MarkdownLink=e=>{let{...a}=e,t=(0,u.useContext)(eP.Z),n=(0,u.useContext)(er.Z);try{let e=a.href;if(e){let s=new URL(e),r=parseInlineCitationInfo(s);if("poe:"===s.protocol)return(0,l.jsx)(l.Fragment,{children:a.children});if(r){let e=(null==n?void 0:n.messageId)===r.messageId;if(!t||!e)return(0,l.jsx)(l.Fragment,{children:a.children});return(0,l.jsx)(MarkdownLinkCitationInner,{...a,messageId:r.messageId,citationIndex:r.citationIndex})}}return(0,l.jsx)("a",{...a,target:"_blank"})}catch(e){return(0,l.jsx)(l.Fragment,{children:a.children})}};let getImageSrc=(e,a)=>{if(!e)return"";try{let t=new URL(e);if(["qph.fs.quoracdn.net","qph.cf2.quoracdn.net","qph.cf2.poecdn.net"].includes(t.hostname))return e;if(void 0!==a&&!a.includes(t.hostname))return"";return e}catch(e){return""}},eG=[I.Z,B.Z],eW=u.createContext(null),useMarkdownProps=()=>{let e=(0,u.useContext)(eW);if(!e)throw Error("useMarkdownProps must be called inside ComponentsMapContext");return e},ez={a:e=>{let{node:a,...t}=e;return(0,l.jsx)(message_MarkdownLink,{className:G().link,...t})},img:e=>{let{node:a,...t}=e;return(0,l.jsx)(message_MarkdownImage,{...t})},pre:e=>{var a,t,n,s,r,i;let{node:o,code:c,codeblockIdx:d,className:u}=e,{showCodePreview:m,isPartial:g,text:p,messageNodeId:h,actionLogData:v,enableMiniApps:_,enablePreviewReact:w,enableExecutableCodeblock:b,showPreviewShareButton:f,previewApiContext:x,showCodePreviewSaveAsFileButton:C,showPreviewSafeModeBanner:M,supportedPreviewsContentTypes:y,supportedExecutableLanguages:j}=useMarkdownProps(),S=m&&(!g||!!(null===(a=o.position)||void 0===a?void 0:a.end.offset)&&o.position.end.offset<p.trimEnd().length),I=null===(t=o.children)||void 0===t?void 0:t[0],B=null!==(r=null===(n=I.properties)||void 0===n?void 0:n.className)&&void 0!==r?r:"",P=null!==(i=null===(s=I.data)||void 0===s?void 0:s.meta)&&void 0!==i?i:void 0;return(0,l.jsx)(message_MarkdownCodeBlock,{className:(0,k.$)(u,B),code:c||"",codeblockIdx:d||0,metadata:P,messageNodeId:h,actionLogData:v,previewApiContext:x,showPreview:S,enableMiniApps:_,enablePreviewReact:w,enableExecutableCodeblock:b,disablePreviewShareButton:g,showPreviewShareButton:f,showPreviewSaveAsFileButton:C,showPreviewSafeModeBanner:M,collapsible:m,supportedPreviewsContentTypes:y,supportedExecutableLanguages:j,isPartial:g})},iframe:e=>{let{srcDoc:a,rawHTMLIdx:t,positionEndOffset:n}=e,{showRawHtmlPreview:s,text:r,isPartial:i,actionLogData:o,previewApiContext:c,enableMiniApps:d,showPreviewSafeModeBanner:u}=useMarkdownProps(),m=null==a?void 0:a.trim();if(!m||!s)return null;let g=!i||(0,E.h)(n)&&n<r.trimEnd().length;return void 0!==t?(0,l.jsx)(BarePreviewFrameWithIndicator,{htmlCode:m,rawHTMLIdx:t,previewApiContext:c,logData:o,enableMiniApps:d,showLoadingSpinner:!g,showPreviewSafeModeBanner:u}):null}},e$=(0,u.memo)(function(e){let{text:a,enableMath:t=!1,showCodePreview:n=!1,showRawHtmlPreview:s=!1,promptBotImageDomainWhiteList:r,isPartial:i=!1}=e,o=(0,u.useCallback)(e=>getImageSrc(e,r),[r]),c=a.replace("\n\nHuman","").trim(),d=(0,u.useMemo)(()=>({...e,text:c}),[e,c]),m=(0,u.useMemo)(()=>[...eG,...t?[[P.Z,{singleDollarTextMath:!1}]]:[]],[t]),g=(0,u.useMemo)(()=>[...t?[S.Z]:[],...n?[codeblockPlugin]:[],rawHTMLPlugin(s)],[t,s,n]);return(0,l.jsx)("div",{className:(0,k.$)(G().markdownContainer,i&&"notranslate"),...i?{translate:"no"}:{},children:(0,l.jsx)(eW.Provider,{value:d,children:(0,l.jsx)(j.D,{components:ez,remarkPlugins:m,rehypePlugins:g,transformImageUri:o,children:c})})})});var eU=t(81045),eq=t(88373),eK=t(56199),eQ=t.n(eK);let MessageReactionCount=e=>{let{reactionCount:a,onClickReaction:t,viewerReaction:n}=e,{reaction:s,count:r}=a;return(0,l.jsxs)("div",{onClick:t,className:(0,k.$)(eQ().reactionCount,n===s&&eQ().viewerReaction),children:[(0,l.jsx)(eq.Z,{reaction:s}),r>1&&(0,l.jsx)("div",{children:r})]})};var message_MessageReactionCounts=e=>{let{hidden:a}=e,{reactionCounts:t,openReactionsModal:n,viewerReaction:s}=(0,eU.C)();if(!(null==t?void 0:t.length))return null;let r=t.map(e=>(0,l.jsx)(MessageReactionCount,{reactionCount:e,onClickReaction:n,viewerReaction:s},e.reaction));return a?(0,l.jsx)("div",{className:eQ().hiddenReactionCounts,children:r}):(0,l.jsx)("div",{className:eQ().reactionCounts,children:(0,l.jsx)("div",{className:eQ().reactionCountsInner,children:r})})};let MessageBubble=e=>{let{text:a,actionLogData:t,isSentByViewer:n,messageTimeoutSecs:s=15,botDisplayName:r,isBot:i,isHuman:o,isCancelled:c=!1,isOptimistic:u,timeoutLevel:g,overflowButton:p,state:h,contentType:v=M.Z.text_markdown,promptBotImageDomainWhiteList:w,enableMath:f=!1,enableMiniApps:x,enableCodePreview:C=!1,enableRawHtmlPreview:y=!1,enablePreviewSaveAsFileButton:j=!1,enablePreviewCSPDisabling:S=!1,enablePreviewReact:I=!1,enableExecutableCodeblock:B=!1,footer:P,errorMessage:N,hasAttachments:F,commandType:L,enablePreviewShareButton:Z,messageStateText:T,markdownCharacterLimit:O=2e4,previewApiContext:A,authorHandle:D,messageNodeId:R,messageCreationTime:H,messageSeenState:E,supportedPreviewsContentTypes:V,supportedExecutableLanguages:G,enableBotAgnosticLoader:W}=e,{t:z}=(0,m.$G)(),$=null,U=Math.floor(s/5);T?$=T:h===b.Z.error?$=i?z("Unable to reach Poe."):N||z(g<3?"Message failed to send.":"Unable to reach Poe."):c||(u&&!i?$=z(g?F?"Still uploading...":"Still sending...":F?"Uploading...":"Sending..."):W||1!==g?!W&&g>1&&g<U?$=z("Still waiting..."):g===U&&(d()(r,"botDisplayName is ".concat(r)),$=z("{{botName}} did not respond.",{botName:r})):$=z("Waiting..."));let q=(0,k.$)(_().row,n&&_().rightSideMessageRow,L&&_().commandRow,L&&(n?_().rightSideCommandRow:_().leftSideCommandRow)),K=h.startsWith("error"),Q=K||g===U,X=L?"":(0,k.$)(n?_().rightSideMessageBubble:_().leftSideMessageBubble,Q&&_().errorBubble),Y=h==b.Z.output_truncated,J=L&&Q?_().commandErrorFooter:n?_().rightSideOptimisticFooter:_().leftSideOptimisticFooter;return(0,l.jsxs)("div",{className:_().rowWithFooter,children:[(0,l.jsxs)("div",{className:q,children:[n?p:null,(0,l.jsxs)("div",{className:_().messageBubbleWrapper,children:[(0,l.jsxs)("div",{className:X,children:[!i||a||F?L?(0,l.jsx)(message_CommandMessage,{commandType:L,text:a,isSentByViewer:n,authorHandle:D}):v===M.Z.text_markdown&&a.length<O?(0,l.jsx)(e$,{text:getText(a,o),actionLogData:t,enableMath:f,enableMiniApps:x,enablePreviewReact:I,enableExecutableCodeblock:B,previewApiContext:A,messageNodeId:R,showCodePreview:C,showRawHtmlPreview:!o&&y,showCodePreviewSaveAsFileButton:j,promptBotImageDomainWhiteList:w,isPartial:h===b.Z.incomplete,showPreviewShareButton:Z,showPreviewSafeModeBanner:S,supportedPreviewsContentTypes:V,supportedExecutableLanguages:G}):(0,l.jsx)("p",{className:_().plaintext,children:a}):h===b.Z.incomplete?(0,l.jsx)("p",{className:_().plaintext,children:"..."}):(0,l.jsx)(nosign,{className:_().noSignIcon}),P,(0,l.jsx)(message_MessageMetadata,{state:h,messageCreationTime:H,seenState:E}),(0,l.jsx)(message_MessageReactionCounts,{hidden:!0})]}),(0,l.jsx)(message_MessageReactionCounts,{})]})]}),(0,l.jsx)("div",{"data-visible":u||g>=(W?U:1)||K||Y||void 0,"data-error":Q||void 0,"data-warning":Y||void 0,className:J,children:$})]})},getText=(e,a)=>{if(!a)return e;let t=(0,f.Rj)(e),n=(0,f.bi)(e,!0);return(t?"**@".concat(t,"**"):"")+n},BreakLine=()=>(0,l.jsx)("div",{className:_().breakLine}),ChatBreak=e=>{let a,{enableMultiplayerChatPrototype:t,isSentByViewer:n,authorHandle:s,overflowButton:r}=e,{t:i}=(0,m.$G)(),o=(0,u.useMemo)(()=>({authorHandle:s}),[s]);return a=t?n?i("You cleared the context"):s?(0,l.jsx)(m.cC,{defaults:"@{{ authorHandle }} cleared the context",values:o}):i("Context cleared"):i("Context cleared"),(0,l.jsxs)("div",{className:_().chatBreak,children:[(0,l.jsx)(BreakLine,{}),(0,l.jsx)("span",{className:(0,k.$)(_().chatBreakLabel,!!r&&_().chatBreakLabelWithOverflowButton),children:a}),r,(0,l.jsx)(BreakLine,{})]})};var message_Message=e=>{let{text:a,actionLogData:n,author:s,isSentByViewer:r,messageTimeoutSecs:i,botDisplayName:o,viewer:c,bot:d,isCancelled:m=!1,isOptimistic:p=!1,timeoutLevel:h=0,state:v=b.Z.complete,contentType:_=M.Z.text_markdown,footer:w,errorMessage:f,hasAttachments:k=!1,commandType:y,overflowButton:j,previewApiContext:S,messageNodeId:I,messageStateText:B,messageCreationTime:P,messageSeenState:N,authorHandle:F,supportedPreviewsContentTypes:L,supportedExecutableLanguages:Z}=e,T=(0,u.useDeferredValue)(a),{enableRawHtmlPreview:O,enablePreviewSaveAsFileButton:A,markdownCharacterLimit:D,enableMiniApps:R,promptBotImageDomainWhitelist:H,enablePreviewShareButton:E,enablePreviewCSPDisabling:V,enableMultiplayerChatPrototype:G,enablePreviewReact:W,enableExecutableCodeblock:z,poeEnableBotAgnosticLoader:$}=(0,g.useFragment)(t(52224),c),{isApiBot:U}=(0,g.useFragment)(t(2395),d);return s===C.Z.chat_break?(0,l.jsx)(ChatBreak,{enableMultiplayerChatPrototype:!!G,isSentByViewer:r,authorHandle:F,overflowButton:j}):(0,l.jsx)(MessageBubble,{actionLogData:n,isSentByViewer:r,text:T,messageNodeId:I,overflowButton:j,messageTimeoutSecs:i,botDisplayName:o,isBot:(0,x.y8)(s),isHuman:(0,x.SX)(s),isCancelled:m,isOptimistic:p,timeoutLevel:h,previewApiContext:S,markdownCharacterLimit:null!=D?D:5e4,state:v,contentType:_,promptBotImageDomainWhiteList:U?void 0:H,enableMath:!0,enableMiniApps:!!R,enablePreviewShareButton:!p&&!!E,enableCodePreview:!0,enableRawHtmlPreview:!!O,enablePreviewSaveAsFileButton:!!A,enablePreviewCSPDisabling:!!V,enablePreviewReact:!!W,enableExecutableCodeblock:!!z,footer:w,errorMessage:f,hasAttachments:k,commandType:y,messageStateText:B,authorHandle:F,messageCreationTime:P,messageSeenState:N,supportedPreviewsContentTypes:L,supportedExecutableLanguages:Z,enableBotAgnosticLoader:!!$})}},39609:function(e,a,t){"use strict";var n=t(85893),s=t(67294),r=t(22641);let importMessageCitationSourceModal=()=>t.e(1372).then(t.bind(t,21372));a.Z=e=>{let{messageId:a,citationIndex:t}=e,[i,o]=(0,s.useState)(!1),l=(0,s.useCallback)(()=>{o(!0)},[]),c=(0,s.useCallback)(()=>{o(!1)},[]),d=(0,s.useMemo)(()=>({messageId:a,citationIndex:t}),[t,a]),u=(0,n.jsx)(r.Z,{isOpen:i,onRequestClose:c,body:importMessageCitationSourceModal,bodyProps:d,modalHeight:400,useMinHeight:!0,useIncreasedHeightInCompactScreen:!0});return{modal:u,openModal:l}}},77581:function(e,a,t){"use strict";t.d(a,{$:function(){return Tags},V:function(){return Tag}});var n=t(85893),s=t(67294),r=t(12251),i=t(7687),o=t.n(i);let Tag=e=>{let{label:a,className:t,...s}=e,i=(0,r.$)(o().tag,t);return(0,n.jsx)("div",{className:i,...s,children:a})},Tags=e=>{let{className:a,children:t,...i}=e,l=(0,r.$)(o().tags,a);return(0,n.jsx)("ol",{className:l,...i,children:s.Children.map(t,e=>(0,n.jsx)("li",{children:e}))})}},86023:function(e,a,t){"use strict";t.d(a,{E:function(){return openPreviewInNewTab},d:function(){return useNewTabPreviewInfo}});var n=t(11163),s=t(67294),r=t(4694);let i=function(){try{return new BroadcastChannel("preview_new_tab_communication")}catch(e){return console.error("Failed to create broadcast channel",e),null}}(),o=new Map,l=new Map,c=new Map;function openPreviewInNewTab(e){let a=Math.floor(1e3*Math.random())+"";o.set(a,e),window.open("/preview/new_tab?local=".concat(a),"_blank")}function useNewTabPreviewInfo(){let[e,a]=(0,s.useState)("loading"),{query:t}=(0,n.useRouter)(),o=t.local;if(!o)throw new r.NotFound;return(0,s.useEffect)(()=>{let e=c.get(o);if(e){a(e);return}let t=setTimeout(()=>{a("does_not_exist")},3e3);if(l.set(o,e=>{clearTimeout(t),a(e)}),!i)throw Error("Broadcast channel should be defined in browser environment");return i.postMessage({type:"ready",fromTabId:o}),()=>{l.delete(o),clearTimeout(t)}},[o]),e}i&&(i.onmessage=e=>{if("ready"===e.data.type){let a=e.data,t=o.get(a.fromTabId);if(!t)return;let n={type:"preview_data",previewData:t,forTabId:a.fromTabId};i.postMessage(n)}else if("preview_data"===e.data.type){var a;let t=e.data;null===(a=l.get(t.forTabId))||void 0===a||a(e.data.previewData),c.set(t.forTabId,t.previewData)}})},25890:function(e,a,t){"use strict";t.d(a,{i:function(){return i}}),(n=s||(s={})).like="like",n.dislike="dislike",n.heart="heart",n.laughing="laughing",n.surprised="surprised",n.sad="sad";var n,s,r=s;let i={[r.like]:"\uD83D\uDC4D",[r.dislike]:"\uD83D\uDC4E",[r.heart]:"❤️",[r.laughing]:"\uD83D\uDE02",[r.surprised]:"\uD83D\uDE2E",[r.sad]:"\uD83D\uDE22"}},86927:function(e,a){"use strict";var t;(t||(t={})).compare="compare",a.Z=t},52612:function(e,a){"use strict";var t,n;(n=t||(t={})).no_limit="no_limit",n.soft_limit="soft_limit",n.hard_limit="hard_limit",n.subscriber_access="subscriber_access",a.Z=t},7687:function(e){e.exports={tag:"tag_tag__SaZZp",tags:"tag_tags__Zn5SU"}},25917:function(e){e.exports={title:"BotHeader_title__cURS_",boldTitle:"BotHeader_boldTitle__KgfYh",textContainer:"BotHeader_textContainer__kVf_I",tags:"BotHeader_tags___EL30",tag:"BotHeader_tag__SXTr9",subText:"BotHeader_subText__0Nkxq"}},9525:function(e){e.exports={wrapper:"BotMessageHeader_wrapper__gvvdw",clickableHeader:"BotMessageHeader_clickableHeader__PX8o7",badge:"BotMessageHeader_badge__UVuz4"}},37675:function(e){e.exports={attachments:"Attachments_attachments__x_H2Q",attachment:"Attachments_attachment___L7ZA",audioAttachment:"Attachments_audioAttachment__ulliK",videoAttachment:"Attachments_videoAttachment__Oy67V"}},52683:function(e){e.exports={markdownContainer:"Markdown_markdownContainer__Tz3HQ",downloadImageButton:"Markdown_downloadImageButton__RCbDB"}},49231:function(e){e.exports={container:"MarkdownCodeBlock_container__nRn2j",codeBlock:"MarkdownCodeBlock_codeBlock__rvLec force-dark",codeHeader:"MarkdownCodeBlock_codeHeader__zWt_V",preTag:"MarkdownCodeBlock_preTag__QMZEO",codeTag:"MarkdownCodeBlock_codeTag__5BV0Z",languageName:"MarkdownCodeBlock_languageName__4_BF8",collapsible:"MarkdownCodeBlock_collapsible__n09uc",expandButtonContainer:"MarkdownCodeBlock_expandButtonContainer__kdI0J",expandButton:"MarkdownCodeBlock_expandButton__dE4iV",codeActions:"MarkdownCodeBlock_codeActions__wvgwQ",codeActionButton:"MarkdownCodeBlock_codeActionButton__xJBAg"}},6103:function(e){e.exports={imageContainer:"MarkdownImage_imageContainer__rAeth",image:"MarkdownImage_image__3dBzJ",withPlaceholder:"MarkdownImage_withPlaceholder__SCN0A",placeholder:"MarkdownImage_placeholder__ZmySQ",downloadImageButton:"MarkdownImage_downloadImageButton__G4i1S",spin:"MarkdownImage_spin__izCcd"}},8044:function(e){e.exports={linkifiedLink:"MarkdownLink_linkifiedLink__BepcK"}},16729:function(e){e.exports={rightSideMessageBubble:"Message_rightSideMessageBubble__ioa_i",leftSideMessageBubble:"Message_leftSideMessageBubble__VPdk6",errorBubble:"Message_errorBubble__Bl92G",breakLine:"Message_breakLine__Szhtx",chatBreak:"Message_chatBreak__WMd1Y",chatBreakLabel:"Message_chatBreakLabel___Nxrm",chatBreakLabelWithOverflowButton:"Message_chatBreakLabelWithOverflowButton__vLDgM",rightSideOptimisticFooter:"Message_rightSideOptimisticFooter__PMqPL",leftSideOptimisticFooter:"Message_leftSideOptimisticFooter__3sP0D",row:"Message_row__ug_UU",rightSideMessageRow:"Message_rightSideMessageRow__23wdY",expander:"Message_expander__5gU_H",noSignIcon:"Message_noSignIcon__11Dy5",plaintext:"Message_plaintext__sTseT",rowWithFooter:"Message_rowWithFooter__FShU6",commandRow:"Message_commandRow__iyHMF",rightSideCommandRow:"Message_rightSideCommandRow__bh3dY",leftSideCommandRow:"Message_leftSideCommandRow__5ukfM",commandBotName:"Message_commandBotName__Va_LG",commandErrorFooter:"Message_commandErrorFooter__rXh54",messageMetadataContainer:"Message_messageMetadataContainer__nBPq7",messageTimestamp:"Message_messageTimestamp__LPb9b",messageSeenStateIcon:"Message_messageSeenStateIcon__Cl_ov",messageBubbleWrapper:"Message_messageBubbleWrapper__sEq8z"}},56199:function(e){e.exports={hiddenReactionCounts:"MessageReactionCounts_hiddenReactionCounts__YsZmk",reactionCounts:"MessageReactionCounts_reactionCounts__qjnjp",reactionCountsInner:"MessageReactionCounts_reactionCountsInner__VklXL",reactionCount:"MessageReactionCounts_reactionCount__e53fG",viewerReaction:"MessageReactionCounts_viewerReaction__NxG_w"}},87953:function(e){e.exports={videoContainer:"VideoPreview_videoContainer__9XliL",thumbnail:"VideoPreview_thumbnail__aZ9WZ",thumbnailLoader:"VideoPreview_thumbnailLoader__77vRv",buttonOverlay:"VideoPreview_buttonOverlay___Y5_f",playIcon:"VideoPreview_playIcon__16kYP"}},61302:function(e){e.exports={loadingContainer:"BarePreviewFrame_loadingContainer__QhIba"}},56505:function(e){e.exports={console:"PreviewConsole_console__uxLBu force-dark",consoleHeader:"PreviewConsole_consoleHeader__XWZnp",consoleHeaderText:"PreviewConsole_consoleHeaderText__aJAZ_",errorLabel:"PreviewConsole_errorLabel__VM27j",warningLabel:"PreviewConsole_warningLabel__mWehX",entries:"PreviewConsole_entries__mVMkb"}},827:function(e){e.exports={container:"PreviewFrame_container__D7x1a"}},86363:function(e){e.exports={icon:"PreviewHeader_icon__T1QdC",header:"PreviewHeader_header__uch2J force-dark",headerLeftTitle:"PreviewHeader_headerLeftTitle__BoCF1",runningInCanvas:"PreviewHeader_runningInCanvas__tPiaB",headerLeft:"PreviewHeader_headerLeft__aU8Mz",headerRight:"PreviewHeader_headerRight__GSGUL",openedInCanvasText:"PreviewHeader_openedInCanvasText__zceTx force-dark",rotate90:"PreviewHeader_rotate90__xpEGM",rotate270:"PreviewHeader_rotate270__n4LkD"}}}]);