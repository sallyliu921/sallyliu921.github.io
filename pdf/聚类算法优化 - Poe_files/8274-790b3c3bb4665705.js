"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8274],{45482:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"getChatContentType_chat"};t.hash="2291a2b3c3c16aec13efd467f4adefba",a.default=t},43328:function(e,a,n){var t,i,l,s,o,d,r,c,m,u,g,p,k,_,h,b,F,S,y,f,C,M,L,T,I,v,w,P,x,A,D,E,N,U;n.r(a);let V=(t=[{defaultValue:null,kind:"LocalArgument",name:"messageId"}],i=[{kind:"Variable",name:"messageId",variableName:"messageId"}],l={kind:"ScalarField",name:"clientNonce"},o={kind:"ScalarField",name:"uid"},d={kind:"ScalarField",name:"handle"},r={kind:"TypeDiscriminator",abstractKey:"__isNode"},c={kind:"ScalarField",name:"sourceType"},m={kind:"ScalarField",name:"attachmentId"},u={kind:"ScalarField",name:"name"},g={kind:"ScalarField",name:"url"},k={concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[p={kind:"ScalarField",name:"mimeType"},s={kind:"ScalarField",name:"id"},{kind:"ScalarField",name:"size"}]},_={kind:"ScalarField",name:"thumbnailUrl"},F={kind:"InlineFragment",selections:[b={kind:"ClientExtension",selections:[h={kind:"ScalarField",name:"isOptimistic"}]}],type:"MessageAttachment"},S={kind:"ClientExtension",selections:[{kind:"ScalarField",name:"localUrl"}]},y={kind:"ScalarField",name:"botId"},f={kind:"ScalarField",name:"nickname"},C={kind:"ScalarField",name:"displayName"},M={kind:"ScalarField",name:"deletionState"},T={kind:"LinkedField",name:"picture",plural:!1,selections:[L={kind:"ScalarField",name:"__typename"},{kind:"TypeDiscriminator",abstractKey:"__isBotPicture"},{kind:"InlineFragment",selections:[{kind:"ScalarField",name:"localName"}],type:"LocalBotImage"},{kind:"InlineFragment",selections:[g],type:"URLBotImage"}]},I={kind:"ScalarField",name:"numRemainingMessages"},v={kind:"ScalarField",name:"displayMessagePointPrice"},w={kind:"ScalarField",name:"shouldConfirmBeforeAddingAsMember"},P={kind:"ScalarField",name:"commandType"},x={alias:"titleText",kind:"ScalarField",name:"title"},A={alias:"bodyText",kind:"ScalarField",name:"body"},E={kind:"LinkedField",name:"primaryImageSources",plural:!0,selections:D=[L,{kind:"TypeDiscriminator",abstractKey:"__isMessageFollowupActionImageSource"},{kind:"InlineFragment",selections:[s,u,g,{concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[p,_,s]}],type:"MessageAttachment"},{kind:"InlineFragment",selections:[s,d,M,C,T],type:"Bot"},{kind:"InlineFragment",selections:[s],type:"Node",abstractKey:"__isNode"}]},U={kind:"ScalarField",name:"isInChat"},{fragment:{argumentDefinitions:t,kind:"Fragment",name:"localMessageQuery",selections:[{args:i,concreteType:"Message",kind:"LinkedField",name:"message",plural:!1,selections:[l,{kind:"InlineDataFragmentSpread",name:"messagesConnection_message",selections:[s,{kind:"FragmentSpread",name:"ChatMessagesView_useMessagePairs_messages"},{kind:"FragmentSpread",name:"ChatHistoryListItem_message"}],argumentDefinitions:[]},{kind:"FragmentSpread",name:"ChatLastMessageArea_lastMessage"},{kind:"FragmentSpread",name:"ChatPageMain_lastMessage"}]}],type:"QueryRoot"},kind:"Request",operation:{argumentDefinitions:t,kind:"Operation",name:"localMessageQuery",selections:[{args:i,concreteType:"Message",kind:"LinkedField",name:"message",plural:!1,selections:[l,s,{concreteType:"PoeUser",kind:"LinkedField",name:"authorUser",plural:!1,selections:[o,s,d,{kind:"ScalarField",name:"profilePhotoUrl"},{kind:"ScalarField",name:"fullName"},r]},{kind:"ScalarField",name:"messageId"},{kind:"ScalarField",name:"creationTime"},{kind:"ScalarField",name:"text"},{kind:"ScalarField",name:"state"},{kind:"ScalarField",name:"author"},{kind:"ScalarField",name:"contentType"},c,{kind:"ScalarField",name:"messageStateText"},{concreteType:"MessageAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[s,m,u,g,k,{kind:"InlineFragment",selections:[{kind:"ScalarField",name:"isInline"},{concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[{kind:"ScalarField",name:"width"},{kind:"ScalarField",name:"height"},g,_]},F,S],type:"Attachment",abstractKey:"__isAttachment"},b]},{concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[y,{kind:"ScalarField",name:"messageTimeoutSecs"},{kind:"ScalarField",name:"allowsImageAttachments"},{kind:"ScalarField",name:"isApiBot"},f,C,M,{kind:"ScalarField",name:"limitedAccessType"},{kind:"ScalarField",name:"shouldHideLimitedAccessTag"},{kind:"ScalarField",name:"translatedBotTags"},T,d,{kind:"ScalarField",name:"canUserAccessBot"},s,{kind:"ScalarField",name:"introduction"},{kind:"ScalarField",name:"isPrivateBot"},{concreteType:"MessagePointLimit",kind:"LinkedField",name:"messagePointLimit",plural:!1,selections:[I,s,v,{kind:"ScalarField",name:"remainingMessagesLimitReason"},{kind:"ScalarField",name:"shouldShowReminderBanner"},{kind:"ScalarField",name:"balanceTooltipText"},{kind:"ScalarField",name:"balanceTooltipType"}]},{kind:"ScalarField",name:"supportsRemix"},w,{kind:"ScalarField",name:"isServerBot"},{kind:"ScalarField",name:"uploadFileSizeLimit"},{kind:"ScalarField",name:"supportsFileUpload"},r]},{concreteType:"CommandInfo",kind:"LinkedField",name:"command",plural:!1,selections:[P]},{concreteType:"MessageReactionCount",kind:"LinkedField",name:"reactionCounts",plural:!0,selections:[{kind:"ScalarField",name:"reaction"},{kind:"ScalarField",name:"count"},s]},{kind:"ScalarField",name:"viewerReaction"},{kind:"ScalarField",name:"vote"},{kind:"ScalarField",name:"messageCode"},{kind:"ScalarField",name:"hasCitations"},{kind:"ScalarField",name:"textLengthOnCancellation"},o,{kind:"LinkedField",name:"followupActions",plural:!0,selections:[L,{kind:"TypeDiscriminator",abstractKey:"__isMessageFollowupActionBase"},{kind:"InlineFragment",selections:[x,A,{kind:"ScalarField",name:"sendText"},{concreteType:"MessageAttachment",kind:"LinkedField",name:"sendAttachments",plural:!0,selections:[m,s,{kind:"InlineFragment",selections:[k,u,g,F,S],type:"Attachment",abstractKey:"__isAttachment"}]},E,N={kind:"LinkedField",name:"secondaryImageSources",plural:!0,selections:D},{concreteType:"MessageFollowUpTargetBotInfo",kind:"LinkedField",name:"targetBotInfo",plural:!1,selections:[U,{concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[d,w,s,{concreteType:"MessagePointLimit",kind:"LinkedField",name:"messagePointLimit",plural:!1,selections:[v,s,I]},y,f,C]}]},{concreteType:"SendMessageFollowupActionMessageSource",kind:"LinkedField",name:"messageSource",plural:!1,selections:[c,{kind:"ScalarField",name:"metadata"}]}],type:"SendMessageFollowupAction"},{kind:"InlineFragment",selections:[x,A,{kind:"ScalarField",name:"prefillText"},{concreteType:"MessageAttachment",kind:"LinkedField",name:"prefillAttachments",plural:!0,selections:[m,s,g,u,{kind:"InlineFragment",selections:[k,F,S],type:"Attachment",abstractKey:"__isAttachment"}]},E,N],type:"PrefillMessageFollowupAction"},{kind:"InlineFragment",selections:[x,A,E,P,{concreteType:"MessageFollowUpTargetBotInfo",kind:"LinkedField",name:"targetBotInfo",plural:!1,selections:[U,{concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[y,d,w,s,f,C,{concreteType:"MessagePointLimit",kind:"LinkedField",name:"messagePointLimit",plural:!1,selections:[I,s]}]}]}],type:"CommandMessageFollowupAction"}]},{kind:"ClientExtension",selections:[h,{kind:"ScalarField",name:"timeoutLevel"},{kind:"ScalarField",name:"heartbeatTimeoutLevel"},{kind:"ScalarField",name:"lastUpdatedText"},{kind:"ScalarField",name:"errorMessage"}]},r]}]},params:{id:"0d312f03b23a032457044e1834f67fa7c22de72bb8d8ffec7c75134614e4eaee",metadata:{},name:"localMessageQuery",operationKind:"query",text:null}});V.hash="34bae80b0f86e101706671faaba24bc1",a.default=V},42074:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"localMessage_createLocalChatMessage_bot"};t.hash="56ea691be54c0931a67823a3e0f77b74",a.default=t},67203:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"optimisticChat_createOptimisticChat_bot"};t.hash="8a5f6fa386ed45339f328d023b51a418",a.default=t},10145:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"optimisticMessage_createOptimisticBotMessage_bot"};t.hash="c40562515293ee0a349dcd825f615c78",a.default=t},89340:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"resendMessage_bot"};t.hash="dd2b0610e4bd5a8280817ddcdd093f52",a.default=t},21049:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"resendMessage_chat"};t.hash="18d6b5bb8062a445ad9f0eb2fd4f5f1d",a.default=t},40273:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"resendMessage_message"};t.hash="e56e3fa2233e8ab03a48556a6fc0f1ec",a.default=t},57868:function(e,a,n){var t,i,l,s,o,d,r,c,m,u,g,p,k,_,h,b,F,S,y,f,C,M,L,T,I,v,w,P,x,A,D,E,N,U,V,B,O,R,G,K,z,Z,H,q,j,J,W,Q,X,$,Y,ee,ea,en,et,ei,el,es,eo,ed,er,ec,em,eu,eg,ep,ek,e_,eh,eb,eF,eS,ey,ef,eC,eM,eL,eT,eI,ev,ew,eP,ex,eA,eD,eE,eN,eU,eV,eB,eO,eR,eG,eK,ez,eZ,eH,eq,ej;n.r(a);let eJ=(t={defaultValue:null,kind:"LocalArgument",name:"attachments"},i={defaultValue:null,kind:"LocalArgument",name:"bot"},l={defaultValue:null,kind:"LocalArgument",name:"chatId"},s={defaultValue:null,kind:"LocalArgument",name:"clientNonce"},o={defaultValue:null,kind:"LocalArgument",name:"existingMessageAttachmentsIds"},d={defaultValue:null,kind:"LocalArgument",name:"messagePointsDisplayPrice"},r={defaultValue:null,kind:"LocalArgument",name:"query"},c={defaultValue:null,kind:"LocalArgument",name:"sdid"},m={defaultValue:null,kind:"LocalArgument",name:"shouldFetchChat"},u={defaultValue:null,kind:"LocalArgument",name:"source"},g=[{kind:"Variable",name:"attachments",variableName:"attachments"},{kind:"Variable",name:"bot",variableName:"bot"},{kind:"Variable",name:"chatId",variableName:"chatId"},{kind:"Variable",name:"clientNonce",variableName:"clientNonce"},{kind:"Variable",name:"existingMessageAttachmentsIds",variableName:"existingMessageAttachmentsIds"},{kind:"Variable",name:"messagePointsDisplayPrice",variableName:"messagePointsDisplayPrice"},{kind:"Variable",name:"query",variableName:"query"},{kind:"Variable",name:"sdid",variableName:"sdid"},{kind:"Variable",name:"source",variableName:"source"}],k={kind:"ScalarField",name:"messageId"},_={kind:"ScalarField",name:"creationTime"},h={kind:"FragmentSpread",name:"ChatHistoryListItem_message"},b=[p={kind:"ScalarField",name:"id"}],F={concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[k,_,{kind:"InlineDataFragmentSpread",name:"messagesConnection_message",selections:[p,{kind:"FragmentSpread",name:"ChatMessagesView_useMessagePairs_messages"},h],argumentDefinitions:[]},h,{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[{kind:"InlineDataFragmentSpread",name:"sendMessage_newChatUpdater_message",selections:b,argumentDefinitions:[]}]}]},S={kind:"ScalarField",name:"status"},y={kind:"ScalarField",name:"statusMessage"},C={concreteType:"MessageCreateFailedUrl",kind:"LinkedField",name:"failedUrls",plural:!0,selections:[f={kind:"ScalarField",name:"url"},{kind:"ScalarField",name:"reason"}]},L={concreteType:"PoeJob",kind:"LinkedField",name:"job",plural:!1,selections:[p,M={kind:"ScalarField",name:"jobId"}]},T={kind:"ScalarField",name:"chatId"},I={kind:"ScalarField",name:"chatCode"},v={kind:"ScalarField",name:"title"},P={kind:"ScalarField",name:"botId"},x={kind:"ScalarField",name:"viewerCanCancel"},A={kind:"ScalarField",name:"hasMarkdownRendering"},D={kind:"InlineDataFragmentSpread",name:"optimisticMessage_createOptimisticBotMessage_bot",selections:[w={kind:"ScalarField",name:"nickname"},{kind:"InlineDataFragmentSpread",name:"localMessage_createLocalChatMessage_bot",selections:[p,{kind:"FragmentSpread",name:"ChatMessage_bot"},{kind:"FragmentSpread",name:"ChatLastMessageArea_bot"},{kind:"FragmentSpread",name:"ChatPageMain_targetedBot"}],argumentDefinitions:[]}],argumentDefinitions:[]},O={concreteType:"PoeUser",kind:"LinkedField",name:"authorUser",plural:!1,selections:[E={kind:"ScalarField",name:"uid"},p,N={kind:"ScalarField",name:"handle"},U={kind:"ScalarField",name:"profilePhotoUrl"},V={kind:"ScalarField",name:"fullName"},B={kind:"TypeDiscriminator",abstractKey:"__isNode"}]},R={kind:"ScalarField",name:"text"},G={kind:"ScalarField",name:"state"},K={kind:"ScalarField",name:"clientNonce"},z={kind:"ScalarField",name:"author"},Z={kind:"ScalarField",name:"contentType"},H={kind:"ScalarField",name:"sourceType"},q={kind:"ScalarField",name:"messageStateText"},W={concreteType:"MessageAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[p,{kind:"ScalarField",name:"attachmentId"},{kind:"ScalarField",name:"name"},f,{concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[{kind:"ScalarField",name:"mimeType"},p,{kind:"ScalarField",name:"size"}]},{kind:"InlineFragment",selections:[{kind:"ScalarField",name:"isInline"},{concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[{kind:"ScalarField",name:"width"},{kind:"ScalarField",name:"height"},f,{kind:"ScalarField",name:"thumbnailUrl"}]},{kind:"InlineFragment",selections:[J={kind:"ClientExtension",selections:[j={kind:"ScalarField",name:"isOptimistic"}]}],type:"MessageAttachment"},{kind:"ClientExtension",selections:[{kind:"ScalarField",name:"localUrl"}]}],type:"Attachment",abstractKey:"__isAttachment"},J]},ed={concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[P,Q={kind:"ScalarField",name:"messageTimeoutSecs"},X={kind:"ScalarField",name:"allowsImageAttachments"},$={kind:"ScalarField",name:"isApiBot"},w,Y={kind:"ScalarField",name:"displayName"},ee={kind:"ScalarField",name:"deletionState"},ea={kind:"ScalarField",name:"limitedAccessType"},en={kind:"ScalarField",name:"shouldHideLimitedAccessTag"},et={kind:"ScalarField",name:"translatedBotTags"},es={kind:"LinkedField",name:"picture",plural:!1,selections:el=[ei={kind:"ScalarField",name:"__typename"},{kind:"TypeDiscriminator",abstractKey:"__isBotPicture"},{kind:"InlineFragment",selections:[{kind:"ScalarField",name:"localName"}],type:"LocalBotImage"},{kind:"InlineFragment",selections:[f],type:"URLBotImage"}]},N,eo={kind:"ScalarField",name:"canUserAccessBot"},p,B]},er={concreteType:"CommandInfo",kind:"LinkedField",name:"command",plural:!1,selections:[{kind:"ScalarField",name:"commandType"}]},ec={concreteType:"MessageReactionCount",kind:"LinkedField",name:"reactionCounts",plural:!0,selections:[{kind:"ScalarField",name:"reaction"},{kind:"ScalarField",name:"count"},p]},eb={concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[k,_,p,O,R,G,K,z,Z,H,q,W,ed,er,ec,em={kind:"ScalarField",name:"viewerReaction"},eu={kind:"ScalarField",name:"vote"},eg={kind:"ScalarField",name:"messageCode"},ep={kind:"ScalarField",name:"hasCitations"},ek={kind:"ScalarField",name:"textLengthOnCancellation"},E,eh={kind:"ClientExtension",selections:[j,e_={kind:"ScalarField",name:"timeoutLevel"},{kind:"ScalarField",name:"heartbeatTimeoutLevel"},{kind:"ScalarField",name:"lastUpdatedText"},{kind:"ScalarField",name:"errorMessage"}]},B]},eF={kind:"ScalarField",name:"cursor"},eS={kind:"ScalarField",name:"introduction"},ey={kind:"ScalarField",name:"isPrivateBot"},ev={concreteType:"MessagePointLimit",kind:"LinkedField",name:"messagePointLimit",plural:!1,selections:[ef={kind:"ScalarField",name:"numRemainingMessages"},p,eC={kind:"ScalarField",name:"displayMessagePointPrice"},eM={kind:"ScalarField",name:"remainingMessagesLimitReason"},eL={kind:"ScalarField",name:"shouldShowReminderBanner"},eT={kind:"ScalarField",name:"balanceTooltipText"},eI={kind:"ScalarField",name:"balanceTooltipType"}]},ew={kind:"ScalarField",name:"supportsRemix"},eP={kind:"ScalarField",name:"shouldConfirmBeforeAddingAsMember"},ex={kind:"ScalarField",name:"isServerBot"},eA={kind:"ScalarField",name:"uploadFileSizeLimit"},eD={kind:"ScalarField",name:"supportsFileUpload"},eE=[{kind:"Literal",name:"size",value:"small"}],eN={kind:"ScalarField",name:"isDeleted"},eU={concreteType:"BotPricing",kind:"LinkedField",name:"botPricing",plural:!1,selections:[{kind:"ScalarField",name:"botPricingType"},{kind:"ScalarField",name:"standardMessagePrice"}]},eV={kind:"ScalarField",name:"supportsPayByContext"},eB={kind:"ScalarField",name:"poweredBy"},eO=[k,p],eR=[{kind:"Literal",name:"last",value:5}],eG={concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[N,ee,Y,es,p]},eK={kind:"ScalarField",name:"isActive"},ez={kind:"ScalarField",name:"costBreakdown"},eZ={concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[P,w,Y,{concreteType:"MessagePointLimit",kind:"LinkedField",name:"messagePointLimit",plural:!1,selections:[ef,p]},p,N,ee,es]},{fragment:{argumentDefinitions:[t,i,l,s,o,d,r,c,m,u],kind:"Fragment",name:"sendMessageMutation",selections:[{args:g,concreteType:"MessageEdgeCreate",kind:"LinkedField",name:"messageEdgeCreate",plural:!1,selections:[{concreteType:"MessageEdge",kind:"LinkedField",name:"message",plural:!1,selections:[p,F,{kind:"FragmentSpread",name:"sendMessageMutation_messageEdge"}]},S,y,C,{concreteType:"MessageEdge",kind:"LinkedField",name:"botMessage",plural:!1,selections:[p,F]},L,{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[{concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[p,T,I,v,{concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[p,w,P]},{concreteType:"PoeJob",kind:"LinkedField",name:"activeJobs",plural:!0,selections:[x]},{kind:"InlineDataFragmentSpread",name:"sendMessage_newChatUpdater_chat",selections:[p,T,I,{kind:"InlineDataFragmentSpread",name:"getChatContentType_chat",selections:[{concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[A]}],argumentDefinitions:[]}],argumentDefinitions:[]},{kind:"FragmentSpread",name:"ChatHistoryListItem_chat"},{kind:"FragmentSpread",name:"ChatPageColumn_chat"}]},{concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{kind:"FragmentSpread",name:"ChatPageColumn_viewer"}]}]},{concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[{kind:"InlineDataFragmentSpread",name:"sendMessage_newChatUpdater_bot",selections:[D],argumentDefinitions:[]}]},{kind:"InlineDataFragmentSpread",name:"sendMessage_onSuccessUpdater_bot",selections:[P,D],argumentDefinitions:[]},{kind:"InlineDataFragmentSpread",name:"setBotDetailsSidebar_bot",selections:[{kind:"FragmentSpread",name:"ChatBotDetailsSidebar_bot"}],argumentDefinitions:[]},{kind:"FragmentSpread",name:"ChatMessageLimitTooltip_bot"}]}]}],type:"MutationRoot"},kind:"Request",operation:{argumentDefinitions:[l,i,r,u,s,c,t,o,m,d],kind:"Operation",name:"sendMessageMutation",selections:[{args:g,concreteType:"MessageEdgeCreate",kind:"LinkedField",name:"messageEdgeCreate",plural:!1,selections:[{concreteType:"MessageEdge",kind:"LinkedField",name:"message",plural:!1,selections:[p,eb,eF]},S,y,C,{concreteType:"MessageEdge",kind:"LinkedField",name:"botMessage",plural:!1,selections:[p,eb]},L,{concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[P,w,p,Q,X,$,Y,ee,ea,en,et,es,N,eo,eS,ey,ev,ew,eP,ex,eA,eD,{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[B]},B]},{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[{concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[p,T,I,v,{concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[p,w,P,A,ee,Y,es,{alias:"smallPicture",args:eE,kind:"LinkedField",name:"picture",plural:!1,selections:el,storageKey:'picture(size:"small")'},{kind:"ScalarField",name:"viewerIsCreator"},{kind:"ScalarField",name:"isCreatedByPoeUserAccount"},ey,{kind:"ScalarField",name:"viewerIsFollower"},{kind:"ScalarField",name:"followerCount"},{kind:"ScalarField",name:"shareLink"},N,{kind:"ScalarField",name:"isDown"},{kind:"ScalarField",name:"model"},eA,X,{kind:"ScalarField",name:"noAccessMessage"},{kind:"ScalarField",name:"allowsClearContext"},ev,eS,{kind:"ScalarField",name:"conversationStarters"},{kind:"ScalarField",name:"monthlyActiveUsers"},{concreteType:"PoeUser",kind:"LinkedField",name:"creator",plural:!1,selections:[eN,{args:eE,kind:"ScalarField",name:"profilePhotoUrl",storageKey:'profilePhotoUrl(size:"small")'},V,{alias:"nullableHandle",kind:"ScalarField",name:"handle"},p,B]},eo,{kind:"ScalarField",name:"description"},et,eU,eV,eB,{kind:"ScalarField",name:"isPromptPublic"},{kind:"ScalarField",name:"promptPlaintext"},{kind:"ScalarField",name:"shouldHide"},Q,$,ea,en,{kind:"ScalarField",name:"isTrustedBot"},ew,eP,ex,eD,B]},{concreteType:"PoeJob",kind:"LinkedField",name:"activeJobs",plural:!0,selections:[x,p,M]},{kind:"ScalarField",name:"viewerIsOwner"},{kind:"ScalarField",name:"lastInteractionTime"},{concreteType:"Message",kind:"LinkedField",name:"viewerLastSeenMessage",plural:!1,selections:eO},{kind:"ScalarField",name:"hasMultipleUsers"},{concreteType:"Message",kind:"LinkedField",name:"lastMessage",plural:!1,selections:[k,p,R,{concreteType:"PoeUser",kind:"LinkedField",name:"authorUser",plural:!1,selections:[E,N,p]},{concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[Y,ee,p,ew,N,eP,ex,eA,X,eD,{concreteType:"MessagePointLimit",kind:"LinkedField",name:"messagePointLimit",plural:!1,selections:[eT,ef,eI,p,eC,eM,eL]},P,w,eS,Q]},z,G,ek,{kind:"ClientExtension",selections:[j,e_]}]},{concreteType:"PoeUser",kind:"LinkedField",name:"userMemberToHighlight",plural:!1,selections:[ei,{alias:"smallProfilePhotoUrl",args:eE,kind:"ScalarField",name:"profilePhotoUrl",storageKey:'profilePhotoUrl(size:"small")'},U,V,p,N]},{kind:"ScalarField",name:"membersCount"},eN,{concreteType:"Message",kind:"LinkedField",name:"lastMessageSeenByAllOtherMembers",plural:!1,selections:eO},{concreteType:"Message",kind:"LinkedField",name:"lastMessageSeenByAnyOtherMembers",plural:!1,selections:eO},{kind:"ScalarField",name:"chatInviteCode"},{args:eR,concreteType:"MessagesConnection",kind:"LinkedField",name:"messagesConnection",plural:!1,selections:[{concreteType:"MessageEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[z,p,O,k,_,R,G,K,Z,H,q,W,ed,er,ec,em,eu,eg,ep,ek,E,ei,eh,B]},p,eF]},{concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{kind:"ScalarField",name:"hasPreviousPage"},{kind:"ScalarField",name:"startCursor"}]},p],storageKey:"messagesConnection(last:5)"},{args:eR,handle:"connection",key:"ChatMessagesView_chat_messagesConnection",kind:"LinkedHandle",name:"messagesConnection"},{kind:"LinkedField",name:"displayedChatModal",plural:!1,selections:[ei,{kind:"InlineFragment",selections:[k,T,eG,{kind:"ScalarField",name:"applicablePointPriceThreshold"},{concreteType:"Subscription",kind:"LinkedField",name:"subscription",plural:!1,selections:[eK,p]},{kind:"ScalarField",name:"totalRequestAmount"},ez,{concreteType:"MessagePointInfo",kind:"LinkedField",name:"messagePointInfo",plural:!1,selections:[{kind:"ScalarField",name:"messagePointBalance"},p]}],type:"CostThresholdUpdateChatModal"},{kind:"InlineFragment",selections:[T,eZ],type:"PaywallChatModal"},{kind:"InlineFragment",selections:[T,eZ,eH={kind:"ScalarField",name:"messageCostAmount"},ez],type:"PointLimitPaywallChatModal"},{kind:"InlineFragment",selections:[T,eG,eH,ez],type:"SubscriberPointLimitChatModal"},{kind:"InlineFragment",selections:[T,{concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[T,p]},{concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[eB,P,ee,Y,es,N,{concreteType:"MessagePointLimit",kind:"LinkedField",name:"messagePointLimit",plural:!1,selections:[eC,p]},eU,eV,p]},{kind:"ScalarField",name:"isPrivateDeletedBotsChangesEnabled"},{kind:"ScalarField",name:"showBotPrices"}],type:"AddBotChatModal"}]},{kind:"ScalarField",name:"isContextOptimizationOn"},{kind:"ScalarField",name:"membersIncludeUntrustedBot"},J,B]},{concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[E,{alias:"poeEnableMultiplayerChatPrototype",args:eq=[{kind:"Literal",name:"gateName",value:"poe_enable_multiplayer_chat_prototype"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_enable_multiplayer_chat_prototype")'},{alias:"enableRawHtmlPreview",args:[{kind:"Literal",name:"gateName",value:"poe_web_raw_html_preview"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_raw_html_preview")'},{alias:"enablePreviewSaveAsFileButton",args:[{kind:"Literal",name:"gateName",value:"poe_web_preview_save_as_file_button"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_preview_save_as_file_button")'},{alias:"enablePreviewShareButton",args:[{kind:"Literal",name:"gateName",value:"poe_web_preview_sharing_ui"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_preview_sharing_ui")'},{alias:"enableMiniApps",args:[{kind:"Literal",name:"gateName",value:"poe_web_allow_message_triggered_by_preview"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_allow_message_triggered_by_preview")'},{alias:"enablePreviewCSPDisabling",args:[{kind:"Literal",name:"gateName",value:"poe_web_allow_preview_csp_disabling"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_allow_preview_csp_disabling")'},{alias:"markdownCharacterLimit",args:[{kind:"Literal",name:"gateName",value:"poe_web_markdown_character_limit"}],kind:"ScalarField",name:"integerGate",storageKey:'integerGate(gateName:"poe_web_markdown_character_limit")'},{alias:"enableMultiplayerChatPrototype",args:eq,kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_enable_multiplayer_chat_prototype")'},{alias:"enablePreviewReact",args:[{kind:"Literal",name:"gateName",value:"poe_web_react_preview"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_react_preview")'},{alias:"enableExecutableCodeblock",args:[{kind:"Literal",name:"gateName",value:"poe_web_executable_codeblock"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_executable_codeblock")'},{alias:"poeEnableBotAgnosticLoader",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_bot_agnostic_loader"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_bot_agnostic_loader")'},{kind:"ScalarField",name:"promptBotImageDomainWhitelist"},{alias:"showMessageInfo",args:[{kind:"Literal",name:"gateName",value:"poe_show_message_info_page"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_show_message_info_page")'},{alias:"enableImageAttachmentsForBots",args:[{kind:"Literal",name:"gateName",value:"poe_enable_image_attachments_for_bots"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_enable_image_attachments_for_bots")'},{alias:"enableVideoAttachmentsForBots",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_video_player"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_video_player")'},{alias:"enableAudioAttachmentsForBots",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_audio_player"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_audio_player")'},{alias:"isPrivateDeletedBotsChangesEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_web_private_deleted_bots_changes"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_private_deleted_bots_changes")'},{kind:"ScalarField",name:"isEligibleForWebSubscriptions"},{concreteType:"Subscription",kind:"LinkedField",name:"subscription",plural:!1,selections:[eK,p,{kind:"ScalarField",name:"expiresTime"},{kind:"ScalarField",name:"willCancelAtPeriodEnd"},{kind:"ScalarField",name:"purchaseRevocationReason"},{kind:"ScalarField",name:"planType"},{alias:"yearlyOptions",args:[{kind:"Literal",name:"paidSubscriptionPeriod",value:"yearly"}],concreteType:"SubscriptionProduct",kind:"LinkedField",name:"subscriptionOptions",plural:!0,selections:b,storageKey:'subscriptionOptions(paidSubscriptionPeriod:"yearly")'}]},{alias:"useChatModalPaywalls",args:[{kind:"Literal",name:"gateName",value:"poe_pay_by_context_chat_modal_paywalls"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_pay_by_context_chat_modal_paywalls")'},{kind:"ScalarField",name:"isEligibleToPurchaseOnAnyPlatform"},{kind:"ScalarField",name:"viewerCountryCode"},{concreteType:"MessagePointInfo",kind:"LinkedField",name:"messagePointInfo",plural:!1,selections:[{kind:"ScalarField",name:"messagePointResetTime"},{kind:"ScalarField",name:"subscriberBonusGrantResetTime"},p]},{alias:"poeUseResolversForMonetizationModals",args:ej=[{kind:"Literal",name:"gateName",value:"poe_use_resolvers_for_monetization_modals"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_use_resolvers_for_monetization_modals")'},{alias:"enableAttachmentTruncationToast",args:[{kind:"Literal",name:"gateName",value:"poe_enable_attachment_truncation_toast"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_enable_attachment_truncation_toast")'},{alias:"canvasIsEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_web_canvas"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_canvas")'},{concreteType:"PoeUser",kind:"LinkedField",name:"poeUser",plural:!1,selections:[p,ei,_]},{alias:"showBotPrices",args:[{kind:"Literal",name:"gateName",value:"poe_enable_users_see_bot_prices"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_enable_users_see_bot_prices")'},p,{kind:"ScalarField",name:"shouldSeeWebSubscriptionAnnouncement"},{kind:"ScalarField",name:"shouldSeeAndroidSubscriptionAnnouncement"},{alias:"subscribeEnhancedConversionProperties",args:[{kind:"Literal",name:"poePaidAcqEvent",value:"Subscribe"}],kind:"ScalarField",name:"googleTagManagerEnhancedConversionProperties",storageKey:'googleTagManagerEnhancedConversionProperties(poePaidAcqEvent:"Subscribe")'},{alias:"monthlySubscribeEnhancedConversionProperties",args:[{kind:"Literal",name:"poePaidAcqEvent",value:"MonthlySubscribe"}],kind:"ScalarField",name:"googleTagManagerEnhancedConversionProperties",storageKey:'googleTagManagerEnhancedConversionProperties(poePaidAcqEvent:"MonthlySubscribe")'},{alias:"yearlySubscribeEnhancedConversionProperties",args:[{kind:"Literal",name:"poePaidAcqEvent",value:"YearlySubscribe"}],kind:"ScalarField",name:"googleTagManagerEnhancedConversionProperties",storageKey:'googleTagManagerEnhancedConversionProperties(poePaidAcqEvent:"YearlySubscribe")'},{alias:"enableGTMEventSending",args:[{kind:"Literal",name:"gateName",value:"poe_enable_event_sending_through_google_tag_manager"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_enable_event_sending_through_google_tag_manager")'},{alias:"showPointsWarningBanner",args:[{kind:"Literal",name:"gateName",value:"poe_enable_out_of_points_warnings"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_enable_out_of_points_warnings")'},{kind:"ScalarField",name:"fileUploadSizeLimits"},{alias:"enableFileSizeLimitsByFileType",args:[{kind:"Literal",name:"gateName",value:"poe_enable_file_size_limits_by_file_type"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_enable_file_size_limits_by_file_type")'},{alias:"poeWebEnableJobStopButton",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_job_stop_button"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_job_stop_button")'},{alias:"isChatModalEnabled",args:ej,kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_use_resolvers_for_monetization_modals")'},{alias:"subscriptionTiersEnabledFeatures",args:[{kind:"Literal",name:"gateName",value:"poe_subscription_tiers_enabled_features"}],kind:"ScalarField",name:"stringArrayGate",storageKey:'stringArrayGate(gateName:"poe_subscription_tiers_enabled_features")'},{kind:"ScalarField",name:"hasUnreadMessage"},{alias:"showContextTruncationIcon",args:[{kind:"Literal",name:"gateName",value:"poe_show_context_truncation_icon_chat_header"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_show_context_truncation_icon_chat_header")'}]}]}]}]},params:{id:"bfa352b52a6acbb09c0e1a006a9dc7a4111594cd1a48dd7c69d61d07f1908b02",metadata:{},name:"sendMessageMutation",operationKind:"mutation",text:null}});eJ.hash="51708f7f4b83283ec0ad33c4525ab515",a.default=eJ},9104:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_bot"};t.hash="03d2ef9817ced391e4447fc3a36e2dc3",a.default=t},59966:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_chat"};t.hash="41e13c12a815d056441458d26ccd44e2",a.default=t},7971:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_messageAttachment"};t.hash="3516a5654ecab43280472adcd8637c86",a.default=t},81767:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_newChatUpdater_bot"};t.hash="1b13c18488f888b9a8e194c764eb6af8",a.default=t},94927:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_newChatUpdater_chat"};t.hash="fe289b3648e440d6462f634cd9902a26",a.default=t},28710:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_newChatUpdater_message"};t.hash="a3edfe280a68f7340ebe0be36940756a",a.default=t},5282:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_onMessageSendChatUpdate_chat"};t.hash="3f09cda2a6e7d19e423600d1197a875f",a.default=t},66937:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_onMessageSendChatUpdate_messageAttachment"};t.hash="8bcdc0fdf98f584608cee7a0839e5efd",a.default=t},55651:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_onSuccessUpdater_bot"};t.hash="ee4aaef889ad9dfcd7386da3d64786c3",a.default=t},37339:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"sendMessage_onSuccessUpdater_chat"};t.hash="4b3cb414dd516497247c2268b7a4fd6a",a.default=t},11161:function(e,a,n){n.r(a);let t={kind:"InlineDataFragment",name:"setBotDetailsSidebar_bot"};t.hash="d4ae840ff801ee1cc626fd4be3b03b18",a.default=t},72210:function(e,a,n){n.d(a,{R8:function(){return createLocalMessageAttachment},f3:function(){return setMessageState},mH:function(){return createLocalChatMessage}});var t=n(41143),i=n.n(t),l=n(44311);n(43328);let createLocalFile=(e,a)=>{let n=e.get(a.id)||e.create(a.id,"File");return i()("File"===n.getType(),"Expected ".concat(a.id," to be a File, not ").concat(n.getType())),n.setValue(a.id,"id"),n.setValue(a.mimeType,"mimeType"),n.setValue(a.size,"size"),n.setValue(a.height,"height"),n.setValue(a.width,"width"),n.setValue(a.thumbnailUrl,"thumbnailUrl"),n.setValue(a.url,"url"),n},createLocalMessageAttachment=(e,a)=>{let n=e.get(a.id)||e.create(a.id,"MessageAttachment");return i()("MessageAttachment"===n.getType(),"Expected ".concat(a.id," to be an Attachment, not ").concat(n.getType())),n.setValue(a.id,"id"),n.setValue(a.attachmentId,"attachmentId"),n.setValue(a.name,"name"),n.setValue(a.url,"url"),n.setValue(a.localUrl,"localUrl"),n.setValue(a.isInline,"isInline"),n.setValue(!0,"isOptimistic"),n.setLinkedRecord(createLocalFile(e,a.file),"file"),n},createLocalChatMessage=(e,a)=>{let t=e.get(a.id)||e.create(a.id,"Message");return i()("Message"===t.getType(),"Expected ".concat(a.id," to be a Message, not ").concat(t.getType())),t.setValue(a.id,"id"),t.setValue(a.messageId,"messageId"),t.setValue(a.author,"author"),t.setValue(a.uid,"uid"),t.setValue(null,"authorUser"),t.setValue(a.clientNonce,"clientNonce"),t.setValue(a.contentType,"contentType"),t.setValue(a.creationTime,"creationTime"),t.setValue(a.isOptimistic,"isOptimistic"),t.setValue(a.sourceType,"sourceType"),t.setValue(a.state,"state"),t.setValue(a.text,"text"),t.setValue(a.textLengthOnCancellation,"textLengthOnCancellation"),t.setValue(a.timeoutLevel,"timeoutLevel"),t.setValue(a.heartbeatTimeoutLevel,"heartbeatTimeoutLevel"),t.setValue(a.lastUpdatedText,"lastUpdatedText"),t.setValue(a.vote,"vote"),t.setLinkedRecords([],"followupActions"),(()=>{if(!a.bot)return t.setValue(null,"bot");{let{id:s}=(0,l.readInlineData)(n(42074),a.bot),o=e.get(s);return i()(o,"Expected bot record ".concat(s," to exist")),t.setLinkedRecord(o,"bot")}})(),t.setValue(a.hasCitations,"hasCitations"),t.setValue(a.errorMessage,"errorMessage"),t.setValue(a.messageStateText,"messageStateText"),t.setLinkedRecords(a.attachmentIds.map(a=>e.get(a)).filter(e=>null!=e),"attachments"),(()=>{if(!a.commandType)return t.setValue(null,"command");{let n=e.create(a.id+":command","Command");return n.setValue(a.commandType,"commandType"),t.setLinkedRecord(n,"command")}})(),t.setValue(a.messageCode,""),t.setLinkedRecords([],"reactionCounts"),t.setValue(a.viewerReaction,"viewerReaction"),t.setLinkedRecords([],"recommendedBots"),t},setMessageState=(e,a)=>{i()("Message"===e.getType(),"Cannot set status of record of type ".concat(e.getType())),e.setValue(a,"state")}},89188:function(e,a,n){n.d(a,{Gx:function(){return createOptimisticHumanMessage},Xw:function(){return createOptimisticCommandMessage},dS:function(){return createOptimisticBotMessage},jH:function(){return createOptimisticMessageAttachment},sC:function(){return createOptimisticChatBreak}});var t=n(41143),i=n.n(t),l=n(44311),s=n(35715),o=n(67280),d=n(5247),r=n(69388),c=n(45598),m=n(72210);let generateRandomNumber=()=>Math.floor(1e9*Math.random()),generateOptimisticId=(e,a)=>{let n,t;do n=generateRandomNumber(),t="Optimistic-".concat(a,"-").concat(n);while(e.get(t));return[t,n]},createOptimisticMessageAttachment=async(e,a)=>{let n;let t=URL.createObjectURL(a);return(0,l.commitLocalUpdate)(e,e=>{let[i,l]=generateOptimisticId(e,"MessageAttachment"),[s]=generateOptimisticId(e,"File"),o=(0,m.R8)(e,{id:i,attachmentId:l,name:a.name,url:t,localUrl:t,isInline:!1,isOptimistic:!0,file:{id:s,size:a.size,mimeType:a.type,height:null,thumbnailUrl:null,url:t,width:null}});n=o.getDataID()}),i()((0,c.H)(n),"attachmentId should be a string"),n},createOptimisticHumanMessage=(e,a)=>{let{prompt:n,attachmentIds:t=[],source:i,clientNonce:l,contentType:o}=a,[d,c]=generateOptimisticId(e,"HumanMessage");return(0,m.mH)(e,{id:d,messageId:c,commandType:null,errorMessage:null,attachmentIds:t,author:s.Z.human,clientNonce:l,contentType:o,creationTime:1e3*Date.now(),hasCitations:!1,isOptimistic:!0,sourceType:i.sourceType,state:r.Z.complete,followupActions:[],text:n,textLengthOnCancellation:null,timeoutLevel:0,heartbeatTimeoutLevel:0,lastUpdatedText:n,vote:null,bot:null,messageStateText:null,uid:null,authorUser:null,messageCode:"",reactionCounts:[],viewerReaction:null})},createOptimisticBotMessage=(e,a)=>{let{bot:t,contentType:i,text:s="",state:o=r.Z.incomplete}=a,{nickname:c,...u}=(0,l.readInlineData)(n(10145),t),[g,p]=generateOptimisticId(e,"BotMessage");return(0,m.mH)(e,{id:g,messageId:p,attachmentIds:[],commandType:null,errorMessage:null,author:c,clientNonce:null,contentType:i,creationTime:1e3*Date.now(),hasCitations:!1,isOptimistic:!0,sourceType:d.Z.chat_input,state:o,followupActions:[],text:s,textLengthOnCancellation:null,timeoutLevel:0,heartbeatTimeoutLevel:0,lastUpdatedText:s,vote:null,bot:u,messageStateText:null,uid:null,authorUser:null,messageCode:"",reactionCounts:[],viewerReaction:null})},createOptimisticChatBreak=(e,a)=>{let{clientNonce:n}=a,[t,i]=generateOptimisticId(e,"ChatBreakMessage");return(0,m.mH)(e,{id:t,messageId:i,attachmentIds:[],author:s.Z.chat_break,clientNonce:n,contentType:o.Z.text_plain,creationTime:1e3*Date.now(),hasCitations:!1,commandType:null,errorMessage:null,isOptimistic:!0,sourceType:d.Z.chat_input,state:r.Z.complete,followupActions:[],text:"",textLengthOnCancellation:null,timeoutLevel:0,heartbeatTimeoutLevel:0,lastUpdatedText:"",vote:null,bot:null,messageStateText:null,uid:null,authorUser:null,messageCode:"",reactionCounts:[],viewerReaction:null})},createOptimisticCommandMessage=(e,a)=>{let{clientNonce:n,text:t,commandType:i}=a,[l,c]=generateOptimisticId(e,"CommandMessage");return(0,m.mH)(e,{id:l,messageId:c,attachmentIds:[],author:s.Z.command,clientNonce:n,contentType:o.Z.text_plain,creationTime:1e3*Date.now(),hasCitations:!1,isOptimistic:!0,sourceType:d.Z.chat_input,state:r.Z.complete,followupActions:[],errorMessage:null,text:t,textLengthOnCancellation:null,heartbeatTimeoutLevel:0,timeoutLevel:0,lastUpdatedText:t,vote:null,bot:null,commandType:i,messageStateText:null,uid:null,authorUser:null,messageCode:"",reactionCounts:[],viewerReaction:null})}},81759:function(e,a,n){n.d(a,{Mo:function(){return clearNonce},Us:function(){return useResendMessage},gc:function(){return setNonceArgs}});var t=n(41143),i=n.n(t),l=n(67294),s=n(22120),o=n(22578),d=n(44311),r=n(8583),c=n(9914),m=n(27664),u=n(28871);let g=new Map,getArgs=e=>{let a=g.get(e);if(!a)throw Error("No args for nonce ".concat(e));return a},setNonceArgs=(e,a)=>g.set(e,a),clearNonce=e=>g.delete(e),resendMessage=e=>{let{environment:a,message:t,bot:l,chat:s,setToast:o,setBotDetailsSidebar:r,onSuccessfulMessageSend:c,t:g}=e,{id:p,isOptimistic:k,clientNonce:_}=(0,d.readInlineData)(n(40273),t),h=(0,d.readInlineData)(n(21049),s),b=(0,d.readInlineData)(n(89340),l);i()(k&&_,"Message must be optimistic to resend");let{optimisticUpdate:F,...S}=getArgs(_);(0,d.commitLocalUpdate)(a,e=>{let a=e.get(h.id);i()(a,"Expected chat record ".concat(h.id," to exist")),(0,m.T5)(a,p)}),a.revertUpdate(F),(0,u.b)({environment:a,chat:h,bot:b,setToast:o,setBotDetailsSidebar:r,onSuccessfulMessageSend:c,t:g,...S})},useResendMessage=e=>{let{message:a,chat:n,bot:t}=e,i=(0,o.useRelayEnvironment)(),d=(0,r.ZP)(),m=(0,c.X)(),{t:u}=(0,s.$G)();return(0,l.useCallback)(function(){let{onSuccessfulMessageSend:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};resendMessage({environment:i,message:a,bot:t,chat:n,setToast:d,setBotDetailsSidebar:m,onSuccessfulMessageSend:a=>{null==e||e(a)},t:u})},[i,d,m,a,t,n,u])}},28871:function(e,a,n){n.d(a,{b:function(){return sendMessage},$:function(){return useSendMessage}});var t=n(41143),i=n.n(t),l=n(67294),s=n(22120),o=n(22578),d=n(17221),r=n(8583),c=n(42093),m=n(52069),u=n(9914),g=n(74285),p=n(95634),k=n(99391),_=n(45598),h=n(83193),b=n(69388),F=n(20761),S=n(29915),y=n(57403),f=n(53236),C=n(44311),M=n(67280),chat_getChatContentType=e=>{let{defaultBotObject:a}=(0,C.readInlineData)(n(45482),e);return a.hasMarkdownRendering?M.Z.text_markdown:M.Z.text_plain},L=n(24487),T=n(60911),I=n(72210),v=n(27664),w=n(89188),P=n(81759);let prepareUploadables=e=>{if(!e)return[null,null];let a=Array.from(e).reduce((e,a,n)=>({...e,["file".concat(n)]:a}),{});return[a,Array.from(Object.keys(a))]},x=n(57868),sendMessage=async e=>{let{environment:a,bot:t,chat:l,prompt:s,source:d,files:r=[],existingAttachments:u=[],setToast:p,setBotDetailsSidebar:b,onSuccessfulMessageSend:S=()=>{},onFailedMessageSend:y=()=>{},clientNonce:C,updateChatHistory:M=!0,t:I}=e;(0,k.Si)();let v=(0,g.h0)(),{id:w,chatId:A,isOptimistic:D,defaultBotObject:E,...N}=(0,o.readInlineData)(n(59966),l);D&&(0,F.WK)();let U=(0,o.readInlineData)(n(9104),t),V=u.map(e=>(0,o.readInlineData)(n(7971),e)),B=C||(0,f.C)(),O={storeUpdater:e=>{!D&&M&&(0,T.x6)(e,w),(0,c.A7)(e,U.id)}};(0,P.gc)(B,{prompt:s,files:r,source:d,optimisticUpdate:O}),(0,L.Gy)(B);let{optimisticHumanMessageId:R,optimisticHumanMessageEdgeId:G}=await onMessageSendChatUpdate({environment:a,chat:N,existingAttachments:V,prompt:s,files:r,source:d,clientNonce:B}),[K,z]=prepareUploadables(r),Z=await v;a.applyUpdate(O),(0,o.commitMutation)(a,{mutation:x,variables:{chatId:D?null:A,shouldFetchChat:!!D,bot:E.nickname,query:s,messagePointsDisplayPrice:U.messagePointLimit.displayMessagePointPrice,source:d,clientNonce:B,attachments:z,existingMessageAttachmentsIds:V.map(e=>e.attachmentId),sdid:Z},uploadables:K,updater:(e,n)=>{var t,i,l,s;if((null===(t=n.messageEdgeCreate)||void 0===t?void 0:t.status)===h.Z.success&&(null===(i=n.messageEdgeCreate)||void 0===i?void 0:i.message)){onSendSuccessUpdater(e,a,{bot:n.messageEdgeCreate.bot,chat:N,optimisticHumanMessageEdgeId:G,messageData:n.messageEdgeCreate.message.node,botMessageData:null===(l=n.messageEdgeCreate.botMessage)||void 0===l?void 0:l.node,jobData:n.messageEdgeCreate.job});let t=n.messageEdgeCreate.chat,i=n.messageEdgeCreate.bot;D&&t&&i&&newChatUpdater(e,{bot:i,chat:t,message:n.messageEdgeCreate.message.node,optimisticChatId:w}),n.messageEdgeCreate.chat&&M?((0,T.eM)(e,w),(0,T.x6)(e,n.messageEdgeCreate.chat.id)):M&&(0,T.x6)(e,w),(0,c.A7)(e,U.id)}else(0,L.V8)(B),onSendFailureUpdater(e,{chatNodeId:w,optimisticHumanMessageEdgeId:G,errorMessage:null===(s=n.messageEdgeCreate)||void 0===s?void 0:s.statusMessage})},onCompleted:e=>{a.revertUpdate(O);let n=onSendMessageCompleted(e,p,b,R,B);n?S(e):y(e),(0,F.zV)()},onError:()=>{(0,L.V8)(B),(0,o.commitLocalUpdate)(a,e=>{onSendFailureUpdater(e,{chatNodeId:w,optimisticHumanMessageEdgeId:G,errorMessage:window.navigator.onLine?I("Message failed to send."):I("Unable to send this message. Check your internet connection.")})}),(0,F.zV)()}}),i()((0,_.h)(R),"Expected optimistic human message id to be a number"),(0,m.CE)(R,A)},onMessageSendChatUpdate=async e=>{let a,t,{environment:l,chat:s,prompt:d,files:r,existingAttachments:c,source:m,clientNonce:u}=e,{id:g,...p}=(0,o.readInlineData)(n(5282),s),k=c.map(e=>(0,o.readInlineData)(n(66937),e).id),h=await Promise.all(r.map(e=>(0,w.jH)(l,e))),b=chat_getChatContentType(p);return(0,o.commitLocalUpdate)(l,e=>{let n=e.get(g);i()(n,"Expected Chat record with id ".concat(g," to exist when sending a message"));let l=(0,w.Gx)(e,{prompt:d,attachmentIds:[...k,...h],source:m,clientNonce:u,contentType:b}),s=(0,v.n3)(e,n,l);a=s.getDataID(),t=l.getValue("messageId")}),i()((0,_.h)(t),"Expected optimistic human message id to be a number"),i()(a,"Expected optimistic human message edge id to exist"),{optimisticHumanMessageId:t,optimisticHumanMessageEdgeId:a}},onSendMessageCompleted=(e,a,n,t,l)=>{let s=e.messageEdgeCreate.status;if(s!==h.Z.success)return!1;let o=getErrorMessageFromFailedUrls(e.messageEdgeCreate.failedUrls);return o&&a({type:r.pC.error,content:o}),n(e.messageEdgeCreate.bot,!1),i()(e.messageEdgeCreate.message,"No message on a successful send message mutation"),(0,m.Ot)(t,e.messageEdgeCreate.message.node.messageId),(0,P.Mo)(l),!0},getErrorMessageFromFailedUrls=e=>{if(0===e.length)return null;let a=e[0].reason;if(1===e.length)switch(a){case"fetch_error":return"Failed to fetch ".concat(e[0].url," because of a problem crawling the URL.");case"over_budget":return"Failed to fetch ".concat(e[0].url," because it was too large. Please keep crawled web pages to <100 MB total.");case"unsupported_content_type":return"Failed to fetch ".concat(e[0].url," because it was not a supported content type.");default:return"Failed to fetch ".concat(e[0].url,".")}switch(a){case"fetch_error":return"Failed to fetch ".concat(e.length," urls because of problems crawling them.");case"over_budget":return"Failed to fetch ".concat(e.length," urls because they were too large. Please keep crawled web pages to <100 MB total.");case"unsupported_content_type":return"Failed to fetch ".concat(e.length," urls because of unsupported content types.");default:return"Failed to fetch ".concat(e.length," urls.")}},onSendSuccessUpdater=(e,a,t)=>{let{bot:l,chat:s,optimisticHumanMessageEdgeId:d,messageData:r,botMessageData:c,jobData:m}=t,{id:u}=(0,o.readInlineData)(n(37339),s),g=(0,o.readInlineData)(n(55651),l),p=e.get(u),k=e.get(d);i()(p,"Expected Chat record with id ".concat(u," to exist when sending a message"));let _=(0,v.kz)(e,p,k,r),h=(0,v.Ey)(p);if((null==h?void 0:h.getDataID())===(null==_?void 0:_.getDataID())&&c&&((0,L.OE)(c.messageId.toString(),{source:"sendMessage",botId:g.botId}),(0,v.OJ)(e,p,c)),m){let handleJobTimeout=(e,n)=>{(0,o.commitLocalUpdate)(a,a=>{(0,y.Z)(a,e,n)})};(0,L.QX)(m.jobId.toString(),{source:"regenerateMessage"},()=>handleJobTimeout(m.id,u)),(0,S.Z)(e,m.id,u)}},newChatUpdater=(e,a)=>{let{bot:t,chat:l,message:s,optimisticChatId:d}=a,r=(0,o.readInlineData)(n(94927),l),{id:c}=(0,o.readInlineData)(n(28710),s),m=(0,o.readInlineData)(n(81767),t);(0,p.mK)(r.chatId,d);let u=e.get(r.id);i()(u,"Cannot find chat record with id ".concat(r.id)),e.getRoot().setLinkedRecord(u,"chatOfCode",{chatCode:r.chatCode});let g=(0,v.Ey)(u);if((null==g?void 0:g.getDataID())===c){let a=chat_getChatContentType(r),n=(0,w.dS)(e,{contentType:a,bot:m});(0,v.n3)(e,u,n)}},onSendFailureUpdater=(e,a)=>{var n;let{chatNodeId:t,optimisticHumanMessageEdgeId:l,errorMessage:s}=a,o=e.get(t),d=null===(n=e.get(l))||void 0===n?void 0:n.getLinkedRecord("node");i()(o,"Expected Chat record with id ".concat(t," to exist when sending a message")),i()(d,"Expected optimistic human message to exist after sending a message"),(0,I.f3)(d,b.Z.error),d.setValue(s,"errorMessage")},useSendMessage=e=>{let{source:a,bot:n,chat:t}=e,i=(0,o.useRelayEnvironment)(),c=(0,r.ZP)(),m=(0,d.rW)(),g=(0,u.X)(),{t:p}=(0,s.$G)(),k=(0,l.useCallback)(async e=>{let{prompt:l,files:s,existingAttachments:o,source:d,onSuccessfulMessageSend:r,clientNonce:u}=e;return await sendMessage({environment:i,bot:n,chat:t,prompt:l,files:s,existingAttachments:o,source:d||a,setToast:c,setBotDetailsSidebar:m?()=>{}:g,onSuccessfulMessageSend:e=>{null==r||r(e)},clientNonce:u,t:p})},[n,t,i,c,g,a,p,m]);return k}},71953:function(e,a,n){n.d(a,{F5:function(){return useCreateOptimisticChat},t3:function(){return useOptimisticChat},tR:function(){return createOptimisticChat}});var t=n(41143),i=n.n(t),l=n(67294),s=n(22578),o=n(44311),d=n(67280),r=n(69388),c=n(89188);let gen_random_number=()=>Math.floor(1e9*Math.random()),getOptimisticChatId=e=>"OPTIMISTIC_CHAT_".concat(e),getOptimisticMessagesConnectionId=e=>o.ConnectionHandler.getConnectionID(e,"ChatMessagesView_chat_messagesConnection"),getOptimisticMessagePageInfoId=e=>"".concat(e,"_MESSAGE_PAGE_INFO"),getOptimisticMemberPageInfoId=e=>"".concat(e,"_MEMBER_PAGE_INFO"),getOptimisticIntroMessageEdgeId=e=>"".concat(e,"_INTRO_MESSAGE_EDGE"),getOptimisticMembersConnectionId=e=>"".concat(e,"_MEMBERS_CONNECTION"),getOptimisticBotMemberEdgeId=e=>"".concat(e,"_BOT_MEMBER_EDGE"),useOptimisticChat=(e,a)=>{let n=useCreateOptimisticChat(e),[t]=(0,l.useState)(()=>a||n());return t},useCreateOptimisticChat=e=>{let a=(0,s.useRelayEnvironment)();return(0,l.useCallback)(()=>createOptimisticChat({environment:a,bot:e}),[a,e])},createOptimisticChat=e=>{let a,t,{environment:l,bot:s}=e;return(0,o.commitLocalUpdate)(l,e=>{let{id:l,nickname:m,introduction:u,isTrustedBot:g,...p}=(0,o.readInlineData)(n(67203),s),k=e.get(l);for(i()(k,"botRecord is ".concat(k));!a||e.get(a);)a=getOptimisticChatId(t=gen_random_number());let _=e.create(a,"Chat");_.setValue(a,"id"),_.setValue(a,"chatId"),_.setValue("","chatCode"),_.setValue(!0,"isOptimistic"),_.setValue(m,"defaultBotNickname"),_.setValue(1e3*Date.now(),"creationTime"),_.setValue(1e3*Date.now(),"lastInteractionTime"),_.setValue(null,"title"),_.setLinkedRecords([],"activeJobs"),_.setValue(!0,"shouldShowDisclaimer"),_.setValue(1e3*Date.now(),"creationTime"),_.setValue(!k.getValue("isTrustedBot"),"membersIncludeUntrustedBot"),_.setValue(!g,"membersIncludeUntrustedBot"),_.setLinkedRecord(k,"defaultBotObject"),_.setValue(null,"displayedChatModal");let h=u?(0,c.dS)(e,{text:u,state:r.Z.complete,bot:p,contentType:d.Z.text_markdown}):null,b=u?[h]:[],F=b.map(n=>{i()(a,"chatId is ".concat(a));let t=e.create(getOptimisticIntroMessageEdgeId(a),"MessageEdge");return t.setLinkedRecord(n,"node"),t}),S=e.create(getOptimisticMessagePageInfoId(a),"PageInfo");S.setValue(!1,"hasPreviousPage"),S.setValue(h?h.getDataID():null,"startCursor");let y=e.create(getOptimisticMessagesConnectionId(a),"MessagesConnection");y.setLinkedRecords(F,"edges"),y.setLinkedRecord(S,"pageInfo"),_.setLinkedRecord(y,"messagesConnection",{last:5}),_.setLinkedRecord(y,"__ChatMessagesView_chat_messagesConnection_connection");let f=[e.create(getOptimisticBotMemberEdgeId(a),"ChatMemberEdge")];f[0].setLinkedRecord(k,"node");let C=e.create(getOptimisticMemberPageInfoId(a),"PageInfo");C.setValue(!1,"hasNextPage"),C.setValue(f[0].getDataID(),"endCursor");let M=e.create(getOptimisticMembersConnectionId(a),"ChatMemberConnection");M.setLinkedRecords(f,"edges"),M.setLinkedRecord(C,"pageInfo"),_.setLinkedRecord(M,"membersConnection"),e.getRoot().setLinkedRecord(_,"optimisticChat",{optimisticChatId:a})}),i()(a,"chatId is ".concat(a)),i()(t,"chatIdNumber is ".concat(t)),a}},9914:function(e,a,n){n.d(a,{X:function(){return useSetBotDetailsSidebar}});var t=n(85893),i=n(67294),l=n(22578),s=n(45597);let o=(0,i.lazy)(()=>Promise.all([n.e(1554),n.e(90),n.e(1206),n.e(6843)]).then(n.bind(n,96662))),useSetBotDetailsSidebar=()=>{let e=(0,i.useContext)(s.Z);return(0,i.useCallback)((a,i)=>{let s=(0,l.readInlineData)(n(11161),a);e((0,t.jsx)(o,{bot:s}),{shouldOpen:i,extraWide:!1})},[e])}},67280:function(e,a){var n,t;(t=n||(n={})).text_markdown="text_markdown",t.text_plain="text_plain",a.Z=n},83193:function(e,a){var n,t;(t=n||(n={})).success="success",t.no_access="no_access",t.too_many_tokens="too_many_tokens",t.reached_limit="reached_limit",t.bot_is_down="bot_is_down",t.exception="exception",t.rate_limit_exceeded="rate_limit_exceeded",t.unsupported_file_type="unsupported_file_type",t.file_too_large="file_too_large",t.file_not_accessible="file_not_accessible",t.input_empty="input_empty",t.multiple_files_unsupported="multiple_files_unsupported",t.invalid_file_type_combination="invalid_file_type_combination",t.multiple_video_files="multiple_video_files",t.message_points_display_price_mismatch="message_points_display_price_mismatch",t.mentioned_bot_does_not_exist="mentioned_bot_does_not_exist",t.multiple_image_files_unsupported="multiple_image_files_unsupported",t.image_attachment_number_exceeeded="image_attachment_number_exceeeded",t.unprocessable_file="unprocessable_file",t.concurrent_messages="concurrent_messages",t.bot_does_not_support_file_upload="bot_does_not_support_file_upload",t.total_file_size_limit_exceeded="total_file_size_limit_exceeded",t.bot_requests_per_message_limit_exceeded="bot_requests_per_message_limit_exceeded",a.Z=n},5247:function(e,a){var n,t;(t=n||(n={})).welcome_topic="welcome_topic",t.linked_phrase="linked_phrase",t.suggested_reply="suggested_reply",t.chat_input="chat_input",t.continue_conversation="continue_conversation",t.quora_machine_answer_interaction="quora_machine_answer_interaction",t.quora_ask_new_question_interaction="quora_ask_new_question_interaction",t.conversation_starter="conversation_starter",t.resend_followup="resend_followup",t.home_page_conversation_starter="home_page_conversation_starter",t.cross_bot_chat_input="cross_bot_chat_input",t.in_chat_bot_recommendation="in_chat_bot_recommendation",t.animate="animate",t.upscale="upscale",t.preview_triggered="preview_triggered",t.executable_codeblock="executable_codeblock",a.Z=n}}]);