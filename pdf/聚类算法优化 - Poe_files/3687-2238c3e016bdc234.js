"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3687],{3687:function(e,_,t){t.d(_,{Jg:function(){return a},O6:function(){return useDownloadFile},km:function(){return logDownload}});var o,a,r=t(41143),s=t.n(r),n=t(67294),i=t(22120),Z=t(8583),d=t(9729),m=t(30038),c=t(96384),l=t(73331),p=t(23595),u=t(64516);let generateRandomString=e=>[...Array(e)].map(()=>(26*Math.random()|0).toString(36)).join("");(o=a||(a={})).image="image",o.video="video",o.audio="audio";let v={mpeg:"mp3","x-ms-wma":"wma","x-m4a":"m4a","x-ms-asf":"asf"},g={"x-msvideo":"avi","x-mastroka":"mkv",ogg:"ogv",quicktime:"mov","x-flv":"flv","x-ms-wmv":"wmv","x-sgi-movie":"movie","x-mpeg":"mpeg"},h={"svg+xml":"svg","x-icon":"ico"};let DownloadError=class DownloadError extends Error{};let getObjectUrl=async(e,_)=>{if(e.startsWith("blob:"))return[e,""];let t=await fetch(e);if(200!==t.status)throw new DownloadError("Failed to download ".concat(_," (").concat(e,"). Status code: ").concat(t.status,"."));let o=await t.blob(),a=null==o?void 0:o.type.split("/");if(!o||a[0].toLowerCase()!==_)throw new DownloadError("Failed to download ".concat(_," (").concat(e,"). Invalid ").concat(_," type: ").concat(null==o?void 0:o.type,"."));return[URL.createObjectURL(o),a[1],!0]},logDownload=(e,_,t)=>{let o;let a={};switch(_){case"image":o=m.Z.save_image,a={image_src:e};break;case"video":o=m.Z.save_video;break;case"audio":o=m.Z.save_audio;break;default:s()(o,"Unsupported fileType: ".concat(_))}o&&("image"===_?(0,d.Z)("poe/action_log",{action_type:(0,c.E)(o),bot_id:t.botId,chat_id:t.chatId,message_id:t.messageId,action_metadata:a}):(0,d.Z)("poe/attachment_action_log",{action_type:(0,c.E)(o),attachment_id:t.attachmentId}))},useDownloadFile=()=>{let[e,_]=(0,n.useState)(!1),{t}=(0,i.$G)(),o=(0,Z.ZP)(),a=(0,n.useCallback)(e=>{let _="";switch(e){case"image":_=t("Failed to download image.");break;case"video":_=t("Failed to download video.");break;case"audio":_=t("Failed to download audio.")}o({type:Z.pC.error,content:_})},[o,t]),r=(0,u.F)(),s=(0,p.au)(r),d="";return[async(e,t,o,r)=>{if(e){r&&r();try{_(!0);let[a,r,n]=await getObjectUrl(e,t);d=a;let i=r;"audio"===t?r in v&&(i=v[r]):"video"===t?r in g&&(i=g[r]):"image"===t&&r in h&&(i=h[r]);let Z=document.createElement("a");if(Z.href=d,o&&i&&o.endsWith("."+i)){let e=o.indexOf("."+i);o=o.substring(0,e)}o=(o=null==o?void 0:o.replaceAll(/[^a-zA-Z0-9]+/g,"_").substring(0,250))+"."+i;let m=o||"poe_"+generateRandomString(6)+"."+i;Z.download=m,Z.target="_blank",Z.rel="noopener noreferrer",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z);let c="audio"===t&&s;n&&!c&&URL.revokeObjectURL(d)}catch(e){e instanceof Error&&(0,l.H)(e),a(t)}finally{_(!1)}}},e]}},96384:function(e,_,t){t.d(_,{E:function(){return valueOfActionType}});var o=t(30038);let a=new Map([[o.Z.user_message_create,1],[o.Z.bot_message_create,2],[o.Z.clear_chat_context,3],[o.Z.stale_chat_message_break,4],[o.Z.bot_message_cancel,5],[o.Z.start_new_chat,6],[o.Z.open_old_chat,7],[o.Z.delete_chat,8],[o.Z.update_chat_title,9],[o.Z.upvote,10],[o.Z.downvote,20],[o.Z.downvote_inaccurate,21],[o.Z.downvote_unhelpful,22],[o.Z.downvote_offensive,23],[o.Z.downvote_other,29],[o.Z.delete_message,30],[o.Z.share_message,31],[o.Z.copy_message,32],[o.Z.copy_code,33],[o.Z.switch_bot,34],[o.Z.continue_chat_from_external_share,35],[o.Z.continue_chat_from_post,36],[o.Z.start_voice_record,40],[o.Z.finish_voice_record,41],[o.Z.cancel_voice_record,42],[o.Z.send_voice_record_directly,43],[o.Z.use_voice_record,44],[o.Z.edit_voice_recorded_input,45],[o.Z.send_voice_record_from_speech_lock_mode,46],[o.Z.attach_file_in_chat_input,50],[o.Z.see_all_chat_history_button_click,60],[o.Z.clear_chat_history_page_filter,61],[o.Z.add_new_chat_button_click,62],[o.Z.new_chat_open,63],[o.Z.share_button_click,70],[o.Z.save_image,80],[o.Z.copy_image,81],[o.Z.copy_image_link,82],[o.Z.open_image_in_new_tab,83],[o.Z.copy_video_link,84],[o.Z.open_video_in_new_tab,85],[o.Z.save_video,86],[o.Z.start_video_auto,87],[o.Z.start_video_manual,88],[o.Z.stop_video_auto,89],[o.Z.stop_video_manual,90],[o.Z.seek_video,91],[o.Z.save_audio,92],[o.Z.copy_audio_link,93],[o.Z.start_audio_manual,94],[o.Z.stop_audio_manual,95],[o.Z.stop_audio_auto,96],[o.Z.seek_audio,97],[o.Z.delete_all_messages,99],[o.Z.signup,100],[o.Z.login,101],[o.Z.logout,102],[o.Z.mark_account_for_deletion,103],[o.Z.email_unsubscribe,104],[o.Z.logout_purge,105],[o.Z.login_failure,106],[o.Z.add_confirmed_email,110],[o.Z.remove_email,111],[o.Z.set_primary_email,112],[o.Z.add_primary_phone_number,113],[o.Z.update_primary_phone_number,114],[o.Z.signup_email_verify,115],[o.Z.signup_phone_number_verify,116],[o.Z.set_handle,117],[o.Z.set_bio,118],[o.Z.set_profile_photo,119],[o.Z.set_name,120],[o.Z.multiplayer_nux_completed,121],[o.Z.remove_phone_number,122],[o.Z.rating_pre_prompt_seen,123],[o.Z.rating_pre_prompt_dismissed,124],[o.Z.rating_pre_prompt_accepted,125],[o.Z.take_screenshot,126],[o.Z.add_primary_email_for_missing_email_user,127],[o.Z.set_email_subscription_setting,128],[o.Z.create_invite,200],[o.Z.redeem_invite,201],[o.Z.post_create,300],[o.Z.post_delete,301],[o.Z.user_follow,302],[o.Z.user_unfollow,303],[o.Z.add_post_to_exploration_stream,400],[o.Z.remove_post_from_exploration_stream,401],[o.Z.add_post_to_top_content_stream,402],[o.Z.remove_post_from_top_content_stream,403],[o.Z.add_post_to_exploration_stream_hk,404],[o.Z.remove_post_from_exploration_stream_hk,405],[o.Z.add_post_to_top_content_stream_hk,406],[o.Z.remove_post_from_top_content_stream_hk,407],[o.Z.add_post_to_exploration_stream_tw,408],[o.Z.remove_post_from_exploration_stream_tw,409],[o.Z.add_post_to_top_content_stream_tw,410],[o.Z.remove_post_from_top_content_stream_tw,411],[o.Z.add_post_to_exploration_stream_cn,412],[o.Z.remove_post_from_exploration_stream_cn,413],[o.Z.add_post_to_top_content_stream_cn,414],[o.Z.remove_post_from_top_content_stream_cn,415],[o.Z.add_post_to_exploration_stream_ar,416],[o.Z.remove_post_from_exploration_stream_ar,417],[o.Z.add_post_to_top_content_stream_ar,418],[o.Z.remove_post_from_top_content_stream_ar,419],[o.Z.add_post_to_bot_stream,420],[o.Z.remove_post_from_bot_stream,421],[o.Z.add_bot_to_exploration_stream,422],[o.Z.remove_bot_from_exploration_stream,423],[o.Z.ban_user,450],[o.Z.unban_user,451],[o.Z.bot_follow,500],[o.Z.bot_unfollow,501],[o.Z.bot_create,502],[o.Z.bot_delete,503],[o.Z.bot_edit,504],[o.Z.bot_share,505],[o.Z.bot_remove_from_sidebar,506],[o.Z.bot_undo_remove_from_sidebar,507],[o.Z.set_default_bot,508],[o.Z.edit_theme_preference,600],[o.Z.edit_language_preference,601],[o.Z.revshare_enroll,700],[o.Z.revshare_disable,701],[o.Z.message_revshare_enroll,702],[o.Z.message_revshare_disable,703],[o.Z.message_revshare_price_edit,704],[o.Z.save_preview,705],[o.Z.share_preview,706],[o.Z.open_preview_in_new_tab,707],[o.Z.confirm_preview_triggered_message,708],[o.Z.reject_preview_triggered_message,709],[o.Z.dismiss_discoverability_card,725],[o.Z.execute_codeblock,726]]);function valueOfActionType(e){return a.get(o.Z[e])}o.Z.user_message_create,o.Z.bot_message_create,o.Z.clear_chat_context,o.Z.stale_chat_message_break,o.Z.bot_message_cancel,o.Z.start_new_chat,o.Z.open_old_chat,o.Z.delete_chat,o.Z.update_chat_title,o.Z.upvote,o.Z.downvote,o.Z.downvote_inaccurate,o.Z.downvote_unhelpful,o.Z.downvote_offensive,o.Z.downvote_other,o.Z.delete_message,o.Z.share_message,o.Z.copy_message,o.Z.copy_code,o.Z.switch_bot,o.Z.continue_chat_from_external_share,o.Z.continue_chat_from_post,o.Z.start_voice_record,o.Z.finish_voice_record,o.Z.cancel_voice_record,o.Z.send_voice_record_directly,o.Z.use_voice_record,o.Z.edit_voice_recorded_input,o.Z.send_voice_record_from_speech_lock_mode,o.Z.attach_file_in_chat_input,o.Z.see_all_chat_history_button_click,o.Z.clear_chat_history_page_filter,o.Z.add_new_chat_button_click,o.Z.new_chat_open,o.Z.share_button_click,o.Z.save_image,o.Z.copy_image,o.Z.copy_image_link,o.Z.open_image_in_new_tab,o.Z.copy_video_link,o.Z.open_video_in_new_tab,o.Z.save_video,o.Z.start_video_auto,o.Z.start_video_manual,o.Z.stop_video_auto,o.Z.stop_video_manual,o.Z.seek_video,o.Z.save_audio,o.Z.copy_audio_link,o.Z.start_audio_manual,o.Z.stop_audio_manual,o.Z.stop_audio_auto,o.Z.seek_audio,o.Z.delete_all_messages,o.Z.signup,o.Z.login,o.Z.logout,o.Z.mark_account_for_deletion,o.Z.email_unsubscribe,o.Z.logout_purge,o.Z.login_failure,o.Z.add_confirmed_email,o.Z.remove_email,o.Z.set_primary_email,o.Z.add_primary_phone_number,o.Z.update_primary_phone_number,o.Z.signup_email_verify,o.Z.signup_phone_number_verify,o.Z.set_handle,o.Z.set_bio,o.Z.set_profile_photo,o.Z.set_name,o.Z.multiplayer_nux_completed,o.Z.remove_phone_number,o.Z.rating_pre_prompt_seen,o.Z.rating_pre_prompt_dismissed,o.Z.rating_pre_prompt_accepted,o.Z.take_screenshot,o.Z.add_primary_email_for_missing_email_user,o.Z.set_email_subscription_setting,o.Z.create_invite,o.Z.redeem_invite,o.Z.post_create,o.Z.post_delete,o.Z.user_follow,o.Z.user_unfollow,o.Z.add_post_to_exploration_stream,o.Z.remove_post_from_exploration_stream,o.Z.add_post_to_top_content_stream,o.Z.remove_post_from_top_content_stream,o.Z.add_post_to_exploration_stream_hk,o.Z.remove_post_from_exploration_stream_hk,o.Z.add_post_to_top_content_stream_hk,o.Z.remove_post_from_top_content_stream_hk,o.Z.add_post_to_exploration_stream_tw,o.Z.remove_post_from_exploration_stream_tw,o.Z.add_post_to_top_content_stream_tw,o.Z.remove_post_from_top_content_stream_tw,o.Z.add_post_to_exploration_stream_cn,o.Z.remove_post_from_exploration_stream_cn,o.Z.add_post_to_top_content_stream_cn,o.Z.remove_post_from_top_content_stream_cn,o.Z.add_post_to_exploration_stream_ar,o.Z.remove_post_from_exploration_stream_ar,o.Z.add_post_to_top_content_stream_ar,o.Z.remove_post_from_top_content_stream_ar,o.Z.add_post_to_bot_stream,o.Z.remove_post_from_bot_stream,o.Z.add_bot_to_exploration_stream,o.Z.remove_bot_from_exploration_stream,o.Z.ban_user,o.Z.unban_user,o.Z.bot_follow,o.Z.bot_unfollow,o.Z.bot_create,o.Z.bot_delete,o.Z.bot_edit,o.Z.bot_share,o.Z.bot_remove_from_sidebar,o.Z.bot_undo_remove_from_sidebar,o.Z.set_default_bot,o.Z.edit_theme_preference,o.Z.edit_language_preference,o.Z.revshare_enroll,o.Z.revshare_disable,o.Z.message_revshare_enroll,o.Z.message_revshare_disable,o.Z.message_revshare_price_edit,o.Z.save_preview,o.Z.share_preview,o.Z.open_preview_in_new_tab,o.Z.confirm_preview_triggered_message,o.Z.reject_preview_triggered_message,o.Z.dismiss_discoverability_card,o.Z.execute_codeblock}}]);